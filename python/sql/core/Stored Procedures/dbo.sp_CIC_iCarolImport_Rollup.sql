SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE PROCEDURE [dbo].[sp_CIC_iCarolImport_Rollup]
WITH EXECUTE AS CALLER
AS
SET NOCOUNT ON

DECLARE	@Error		INT
SET @Error = 0

MERGE INTO dbo.CIC_iCarolImportRollup dst
USING dbo.CIC_iCarolImport AS src
ON src.ResourceAgencyNum=dst.ResourceAgencyNum AND src.LangID=dst.LangID AND src.TaxonomyLevelName = 'Agency'
WHEN MATCHED AND src.SYNC_DATE > dst.DATE_MODIFIED THEN 
	UPDATE SET 
		[PublicName]=src.[PublicName],
		[AlternateName]=src.[AlternateName],
		[OfficialName]=src.[OfficialName],
		[TaxonomyLevelName]=src.[TaxonomyLevelName],
		[ParentAgency]=src.[ParentAgency],
		[ParentAgencyNum]=src.[ParentAgencyNum],
		[RECORD_OWNER]=src.[Custom_Record Owner (controlled)],
		[UniqueIDPriorSystem]=src.[UniqueIDPriorSystem],
		[MailingAttentionName]=src.[MailingAttentionName],
		[MailingAddress1]=src.[MailingAddress1],
		[MailingAddress2]=src.[MailingAddress2],
		[MailingCity]=src.[MailingCity],
		[MailingStateProvince]=src.[MailingStateProvince],
		[MailingPostalCode]=src.[MailingPostalCode],
		[MailingCountry]=src.[MailingCountry],
		[MailingAddressIsPrivate]=src.[MailingAddressIsPrivate],
		[PhysicalAddress1]=src.[PhysicalAddress1],
		[PhysicalAddress2]=src.[PhysicalAddress2],
		[PhysicalCity]=src.[PhysicalCity],
		[PhysicalCounty]=src.[PhysicalCounty],
		[PhysicalStateProvince]=src.[PhysicalStateProvince],
		[PhysicalPostalCode]=src.[PhysicalPostalCode],
		[PhysicalCountry]=src.[PhysicalCountry],
		[PhysicalAddressIsPrivate]=src.[PhysicalAddressIsPrivate],
		[OtherAddress1]=src.[OtherAddress1],
		[OtherAddress2]=src.[OtherAddress2],
		[OtherCity]=src.[OtherCity],
		[OtherCounty]=src.[OtherCounty],
		[OtherStateProvince]=src.[OtherStateProvince],
		[OtherPostalCode]=src.[OtherPostalCode],
		[OtherCountry]=src.[OtherCountry],
		[Latitude]=NULLIF(src.[Latitude],'0'),
		[Longitude]=NULLIF(src.[Longitude], '0'),
		[HoursOfOperation]=src.[HoursOfOperation],
		[Phone1Number]=src.[Phone1Number],
		[Phone1Name]=src.[Phone1Name],
		[Phone1Description]=src.[Phone1Description],
		[Phone1IsPrivate]=src.[Phone1IsPrivate],
		[Phone1Type]=src.[Phone1Type],
		[Phone2Number]=src.[Phone2Number],
		[Phone2Name]=src.[Phone2Name],
		[Phone2Description]=src.[Phone2Description],
		[Phone2IsPrivate]=src.[Phone2IsPrivate],
		[Phone2Type]=src.[Phone2Type],
		[Phone3Number]=src.[Phone3Number],
		[Phone3Name]=src.[Phone3Name],
		[Phone3Description]=src.[Phone3Description],
		[Phone3IsPrivate]=src.[Phone3IsPrivate],
		[Phone3Type]=src.[Phone3Type],
		[Phone4Number]=src.[Phone4Number],
		[Phone4Name]=src.[Phone4Name],
		[Phone4Description]=src.[Phone4Description],
		[Phone4IsPrivate]=src.[Phone4IsPrivate],
		[Phone4Type]=src.[Phone4Type],
		[Phone5Number]=src.[Phone5Number],
		[Phone5name]=src.[Phone5name],
		[Phone5Description]=src.[Phone5Description],
		[Phone5IsPrivate]=src.[Phone5IsPrivate],
		[Phone5Type]=src.[Phone5Type],
		[PhoneFax]=src.[PhoneFax],
		[PhoneFaxDescription]=src.[PhoneFaxDescription],
		[PhoneFaxIsPrivate]=src.[PhoneFaxIsPrivate],
		[PhoneTTY]=src.[PhoneTTY],
		[PhoneTTYDescription]=src.[PhoneTTYDescription],
		[PhoneTTYIsPrivate]=src.[PhoneTTYIsPrivate],
		[PhoneTollFree]=src.[PhoneTollFree],
		[PhoneTollFreeDescription]=src.[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate]=src.[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline]=src.[PhoneNumberHotline],
		[PhoneNumberHotlineDescription]=src.[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate]=src.[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine]=src.[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription]=src.[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate]=src.[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea]=src.[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription]=src.[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate]=src.[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours]=src.[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription]=src.[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate]=src.[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain]=src.[EmailAddressMain],
		[WebsiteAddress]=src.[WebsiteAddress],
		[AgencyStatus]=src.[AgencyStatus],
		[AgencyClassification]=src.[AgencyClassification],
		[CoverageArea]=src.[CoverageArea],
		[CoverageAreaText]=src.[CoverageAreaText],
		[Eligibility]=src.[Eligibility],
		[EligibilityAdult]=src.[EligibilityAdult],
		[EligibilityChild]=src.[EligibilityChild],
		[EligibilityFamily]=src.[EligibilityFamily],
		[EligibilityFemale]=src.[EligibilityFemale],
		[EligibilityMale]=src.[EligibilityMale],
		[EligibilityTeen]=src.[EligibilityTeen],
		[SeniorWorkerName]=src.[SeniorWorkerName],
		[SeniorWorkerTitle]=src.[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress]=src.[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber]=src.[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate]=src.[SeniorWorkerIsPrivate],
		[MainContactName]=src.[MainContactName],
		[MainContactTitle]=src.[MainContactTitle],
		[MainContactEmailAddress]=src.[MainContactEmailAddress],
		[MainContactPhoneNumber]=src.[MainContactPhoneNumber],
		[MainContactType]=src.[MainContactType],
		[MainContactIsPrivate]=src.[MainContactIsPrivate],
		[LicenseAccreditation]=src.[LicenseAccreditation],
		[YearIncorporated]=src.[YearIncorporated],
		[AnnualBudgetTotal]=src.[AnnualBudgetTotal],
		[LegalStatus]=src.[LegalStatus],
		[SourceOfFunds]=src.[SourceOfFunds],
		[ExcludeFromWebsite]=src.[ExcludeFromWebsite],
		[ExcludeFromDirectory]=src.[ExcludeFromDirectory],
		[DisabilitiesAccess]=src.[DisabilitiesAccess],
		[PhysicalLocationDescription]=src.[PhysicalLocationDescription],
		[BusServiceAccess]=src.[BusServiceAccess],
		[PublicAccessTransportation]=src.[PublicAccessTransportation],
		[PaymentMethods]=src.[PaymentMethods],
		[FeeStructureSource]=src.[FeeStructureSource],
		[ApplicationProcess]=src.[ApplicationProcess],
		[ResourceInfo]=src.[ResourceInfo],
		[DocumentsRequired]=src.[DocumentsRequired],
		[LanguagesOffered]=src.[LanguagesOffered],
		[LanguagesOfferedList]=src.[LanguagesOfferedList],
		[AvailabilityNumberOfTimes]=src.[AvailabilityNumberOfTimes],
		[AvailabilityFrequency]=src.[AvailabilityFrequency],
		[AvailabilityPeriod]=src.[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability]=src.[ServiceNotAlwaysAvailability],
		[CapacityType]=src.[CapacityType],
		[ServiceCapacity]=src.[ServiceCapacity],
		[NormalWaitTime]=src.[NormalWaitTime],
		[TemporaryMessage]=src.[TemporaryMessage],
		[TemporaryMessageAppears]=src.[TemporaryMessageAppears],
		[TemporaryMessageExpires]=src.[TemporaryMessageExpires],
		[EnteredOn]=src.[EnteredOn],
		[UpdatedOn]=src.[UpdatedOn],
		[MadeInactiveOn]=src.[MadeInactiveOn],
		[InternalNotes]=src.[InternalNotes],
		[InternalNotesForEditorsAndViewers]=src.[InternalNotesForEditorsAndViewers],
		[HighlightedResource]=src.[HighlightedResource],
		[LastVerifiedOn]=src.[LastVerifiedOn],
		[LastVerifiedByName]=src.[LastVerifiedByName],
		[LastVerifiedByTitle]=src.[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber]=src.[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress]=src.[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy]=src.[LastVerificationApprovedBy],
		[AvailableForDirectory]=src.[AvailableForDirectory],
		[AvailableForReferral]=src.[AvailableForReferral],
		[AvailableForResearch]=src.[AvailableForResearch],
		[PreferredProvider]=src.[PreferredProvider],
		[ConnectsToSiteNum]=src.[ConnectsToSiteNum],
		[ConnectsToProgramNum]=src.[ConnectsToProgramNum],
		[LanguageOfRecord]=src.[LanguageOfRecord],
		[CurrentWorkflowStepCode]=src.[CurrentWorkflowStepCode],
		[VolunteerOpportunities]=src.[VolunteerOpportunities],
		[VolunteerDuties]=src.[VolunteerDuties],
		[IsLinkOnly]=src.[IsLinkOnly],
		[ProgramAgencyNamePublic]=src.[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic]=src.[SiteAgencyNamePublic],
		[Categories]=src.[Categories],
		[TaxonomyTerm]=src.[TaxonomyTerm],
		[TaxonomyTerms]=src.[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated]=src.[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes]=src.[TaxonomyCodes],
		[Coverage]=src.[Coverage],
		[Hours]=src.[Hours],
		[Custom_Public Comments]=src.[Custom_Public Comments],
		[Custom_Former Names]=src.[Custom_Former Names],
		[Custom_Legal Name]=src.[Custom_Legal Name],
		[Custom_Facebook]=src.[Custom_Facebook],
		[Custom_Instagram]=src.[Custom_Instagram],
		[Custom_LinkedIn]=src.[Custom_LinkedIn],
		[Custom_Twitter]=src.[Custom_Twitter],
		[Custom_YouTube]=src.[Custom_YouTube],
		[Custom_Minimum Age]=src.[Custom_Minimum Age],
		[Custom_Maximum Age]=src.[Custom_Maximum Age],
		[dst].[DATE_MODIFIED]=GETDATE(),
		ORG_LEVEL_1=src.PublicName,
		dst.ORG_DESCRIPTION=src.AgencyDescription,
		dst.ORG_LOCATION_SERVICE='AGENCY',
		dst.DELETION_DATE=src.DELETION_DATE
WHEN NOT MATCHED BY TARGET AND src.TaxonomyLevelName='Agency' THEN
	INSERT (
		[ResourceAgencyNum],
		[LangID],
		[PublicName],
		[AlternateName],
		[OfficialName],
		[TaxonomyLevelName],
		[ParentAgency],
		[ParentAgencyNum],
		[RECORD_OWNER],
		[UniqueIDPriorSystem],
		[MailingAttentionName],
		[MailingAddress1],
		[MailingAddress2],
		[MailingCity],
		[MailingStateProvince],
		[MailingPostalCode],
		[MailingCountry],
		[MailingAddressIsPrivate],
		[PhysicalAddress1],
		[PhysicalAddress2],
		[PhysicalCity],
		[PhysicalCounty],
		[PhysicalStateProvince],
		[PhysicalPostalCode],
		[PhysicalCountry],
		[PhysicalAddressIsPrivate],
		[OtherAddress1],
		[OtherAddress2],
		[OtherCity],
		[OtherCounty],
		[OtherStateProvince],
		[OtherPostalCode],
		[OtherCountry],
		[Latitude],
		[Longitude],
		[HoursOfOperation],
		[Phone1Number],
		[Phone1Name],
		[Phone1Description],
		[Phone1IsPrivate],
		[Phone1Type],
		[Phone2Number],
		[Phone2Name],
		[Phone2Description],
		[Phone2IsPrivate],
		[Phone2Type],
		[Phone3Number],
		[Phone3Name],
		[Phone3Description],
		[Phone3IsPrivate],
		[Phone3Type],
		[Phone4Number],
		[Phone4Name],
		[Phone4Description],
		[Phone4IsPrivate],
		[Phone4Type],
		[Phone5Number],
		[Phone5name],
		[Phone5Description],
		[Phone5IsPrivate],
		[Phone5Type],
		[PhoneFax],
		[PhoneFaxDescription],
		[PhoneFaxIsPrivate],
		[PhoneTTY],
		[PhoneTTYDescription],
		[PhoneTTYIsPrivate],
		[PhoneTollFree],
		[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline],
		[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain],
		[WebsiteAddress],
		[AgencyStatus],
		[AgencyClassification],
		[CoverageArea],
		[CoverageAreaText],
		[Eligibility],
		[EligibilityAdult],
		[EligibilityChild],
		[EligibilityFamily],
		[EligibilityFemale],
		[EligibilityMale],
		[EligibilityTeen],
		[SeniorWorkerName],
		[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate],
		[MainContactName],
		[MainContactTitle],
		[MainContactEmailAddress],
		[MainContactPhoneNumber],
		[MainContactType],
		[MainContactIsPrivate],
		[LicenseAccreditation],
		[YearIncorporated],
		[AnnualBudgetTotal],
		[LegalStatus],
		[SourceOfFunds],
		[ExcludeFromWebsite],
		[ExcludeFromDirectory],
		[DisabilitiesAccess],
		[PhysicalLocationDescription],
		[BusServiceAccess],
		[PublicAccessTransportation],
		[PaymentMethods],
		[FeeStructureSource],
		[ApplicationProcess],
		[ResourceInfo],
		[DocumentsRequired],
		[LanguagesOffered],
		[LanguagesOfferedList],
		[AvailabilityNumberOfTimes],
		[AvailabilityFrequency],
		[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability],
		[CapacityType],
		[ServiceCapacity],
		[NormalWaitTime],
		[TemporaryMessage],
		[TemporaryMessageAppears],
		[TemporaryMessageExpires],
		[EnteredOn],
		[UpdatedOn],
		[MadeInactiveOn],
		[InternalNotes],
		[InternalNotesForEditorsAndViewers],
		[HighlightedResource],
		[LastVerifiedOn],
		[LastVerifiedByName],
		[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy],
		[AvailableForDirectory],
		[AvailableForReferral],
		[AvailableForResearch],
		[PreferredProvider],
		[ConnectsToSiteNum],
		[ConnectsToProgramNum],
		[LanguageOfRecord],
		[CurrentWorkflowStepCode],
		[VolunteerOpportunities],
		[VolunteerDuties],
		[IsLinkOnly],
		[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic],
		[Categories],
		[TaxonomyTerm],
		[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes],
		[Coverage],
		[Hours],
		[Custom_Public Comments],
		[Custom_Former Names],
		[Custom_Legal Name],
		[Custom_Facebook],
		[Custom_Instagram],
		[Custom_LinkedIn],
		[Custom_Twitter],
		[Custom_YouTube],
		[Custom_Minimum Age],
		[Custom_Maximum Age],
		[DATE_MODIFIED],
		ORG_LEVEL_1,
		ORG_DESCRIPTION,
		ORG_LOCATION_SERVICE,
		DELETION_DATE
	) VALUES (
		src.[ResourceAgencyNum],
		src.LangID,
		src.[PublicName],
		src.[AlternateName],
		src.[OfficialName],
		src.[TaxonomyLevelName],
		src.[ParentAgency],
		src.[ParentAgencyNum],
		src.[Custom_Record Owner (controlled)],
		src.[UniqueIDPriorSystem],
		src.[MailingAttentionName],
		src.[MailingAddress1],
		src.[MailingAddress2],
		src.[MailingCity],
		src.[MailingStateProvince],
		src.[MailingPostalCode],
		src.[MailingCountry],
		src.[MailingAddressIsPrivate],
		src.[PhysicalAddress1],
		src.[PhysicalAddress2],
		src.[PhysicalCity],
		src.[PhysicalCounty],
		src.[PhysicalStateProvince],
		src.[PhysicalPostalCode],
		src.[PhysicalCountry],
		src.[PhysicalAddressIsPrivate],
		src.[OtherAddress1],
		src.[OtherAddress2],
		src.[OtherCity],
		src.[OtherCounty],
		src.[OtherStateProvince],
		src.[OtherPostalCode],
		src.[OtherCountry],
		NULLIF(src.[Latitude],'0'),
		NULLIF(src.[Longitude],'0'),
		src.[HoursOfOperation],
		src.[Phone1Number],
		src.[Phone1Name],
		src.[Phone1Description],
		src.[Phone1IsPrivate],
		src.[Phone1Type],
		src.[Phone2Number],
		src.[Phone2Name],
		src.[Phone2Description],
		src.[Phone2IsPrivate],
		src.[Phone2Type],
		src.[Phone3Number],
		src.[Phone3Name],
		src.[Phone3Description],
		src.[Phone3IsPrivate],
		src.[Phone3Type],
		src.[Phone4Number],
		src.[Phone4Name],
		src.[Phone4Description],
		src.[Phone4IsPrivate],
		src.[Phone4Type],
		src.[Phone5Number],
		src.[Phone5name],
		src.[Phone5Description],
		src.[Phone5IsPrivate],
		src.[Phone5Type],
		src.[PhoneFax],
		src.[PhoneFaxDescription],
		src.[PhoneFaxIsPrivate],
		src.[PhoneTTY],
		src.[PhoneTTYDescription],
		src.[PhoneTTYIsPrivate],
		src.[PhoneTollFree],
		src.[PhoneTollFreeDescription],
		src.[PhoneTollFreeIsPrivate],
		src.[PhoneNumberHotline],
		src.[PhoneNumberHotlineDescription],
		src.[PhoneNumberHotlineIsPrivate],
		src.[PhoneNumberBusinessLine],
		src.[PhoneNumberBusinessLineDescription],
		src.[PhoneNumberBusinessLineIsPrivate],
		src.[PhoneNumberOutOfArea],
		src.[PhoneNumberOutOfAreaDescription],
		src.[PhoneNumberOutOfAreaIsPrivate],
		src.[PhoneNumberAfterHours],
		src.[PhoneNumberAfterHoursDescription],
		src.[PhoneNumberAfterHoursIsPrivate],
		src.[EmailAddressMain],
		src.[WebsiteAddress],
		src.[AgencyStatus],
		src.[AgencyClassification],
		src.[CoverageArea],
		src.[CoverageAreaText],
		src.[Eligibility],
		src.[EligibilityAdult],
		src.[EligibilityChild],
		src.[EligibilityFamily],
		src.[EligibilityFemale],
		src.[EligibilityMale],
		src.[EligibilityTeen],
		src.[SeniorWorkerName],
		src.[SeniorWorkerTitle],
		src.[SeniorWorkerEmailAddress],
		src.[SeniorWorkerPhoneNumber],
		src.[SeniorWorkerIsPrivate],
		src.[MainContactName],
		src.[MainContactTitle],
		src.[MainContactEmailAddress],
		src.[MainContactPhoneNumber],
		src.[MainContactType],
		src.[MainContactIsPrivate],
		src.[LicenseAccreditation],
		src.[YearIncorporated],
		src.[AnnualBudgetTotal],
		src.[LegalStatus],
		src.[SourceOfFunds],
		src.[ExcludeFromWebsite],
		src.[ExcludeFromDirectory],
		src.[DisabilitiesAccess],
		src.[PhysicalLocationDescription],
		src.[BusServiceAccess],
		src.[PublicAccessTransportation],
		src.[PaymentMethods],
		src.[FeeStructureSource],
		src.[ApplicationProcess],
		src.[ResourceInfo],
		src.[DocumentsRequired],
		src.[LanguagesOffered],
		src.[LanguagesOfferedList],
		src.[AvailabilityNumberOfTimes],
		src.[AvailabilityFrequency],
		src.[AvailabilityPeriod],
		src.[ServiceNotAlwaysAvailability],
		src.[CapacityType],
		src.[ServiceCapacity],
		src.[NormalWaitTime],
		src.[TemporaryMessage],
		src.[TemporaryMessageAppears],
		src.[TemporaryMessageExpires],
		src.[EnteredOn],
		src.[UpdatedOn],
		src.[MadeInactiveOn],
		src.[InternalNotes],
		src.[InternalNotesForEditorsAndViewers],
		src.[HighlightedResource],
		src.[LastVerifiedOn],
		src.[LastVerifiedByName],
		src.[LastVerifiedByTitle],
		src.[LastVerifiedByPhoneNumber],
		src.[LastVerifiedByEmailAddress],
		src.[LastVerificationApprovedBy],
		src.[AvailableForDirectory],
		src.[AvailableForReferral],
		src.[AvailableForResearch],
		src.[PreferredProvider],
		src.[ConnectsToSiteNum],
		src.[ConnectsToProgramNum],
		src.[LanguageOfRecord],
		src.[CurrentWorkflowStepCode],
		src.[VolunteerOpportunities],
		src.[VolunteerDuties],
		src.[IsLinkOnly],
		src.[ProgramAgencyNamePublic],
		src.[SiteAgencyNamePublic],
		src.[Categories],
		src.[TaxonomyTerm],
		src.[TaxonomyTerms],
		src.[TaxonomyTermsNotDeactivated],
		src.[TaxonomyCodes],
		src.[Coverage],
		src.[Hours],
		src.[Custom_Public Comments],
		src.[Custom_Former Names],
		src.[Custom_Legal Name],
		src.[Custom_Facebook],
		src.[Custom_Instagram],
		src.[Custom_LinkedIn],
		src.[Custom_Twitter],
		src.[Custom_YouTube],
		src.[Custom_Minimum Age],
		src.[Custom_Maximum Age],
		GETDATE(),
		src.PublicName,
		src.AgencyDescription,
		'AGENCY',
		src.DELETION_DATE
	)

	;



MERGE INTO dbo.CIC_iCarolImportRollup dst
USING (
SELECT 
		(SELECT MAX(SYNC_DATE) FROM (VALUES (pas.SYNC_DATE), (p.SYNC_DATE), (s.SYNC_DATE), (a.SYNC_DATE)) AS i(SYNC_DATE)) AS SYNC_DATE,
		COALESCE(pas.[ResourceAgencyNum], p.[ResourceAgencyNum], s.[ResourceAgencyNum], a.[ResourceAgencyNum]) AS [ResourceAgencyNum],
		COALESCE(pas.[LangID], p.[LangID], s.[LangID], a.[LangID]) AS [LangID],
		COALESCE(pas.[PublicName], p.[PublicName], s.[PublicName], a.[PublicName]) AS [PublicName],
		COALESCE(pas.[AlternateName], p.[AlternateName], s.[AlternateName], a.[AlternateName]) AS [AlternateName],
		COALESCE(pas.[OfficialName], p.[OfficialName], s.[OfficialName], a.[OfficialName]) AS [OfficialName],
		COALESCE(pas.[TaxonomyLevelName], p.[TaxonomyLevelName], s.[TaxonomyLevelName], a.[TaxonomyLevelName]) AS [TaxonomyLevelName],
		COALESCE(pas.[ParentAgency], p.[ParentAgency], s.[ParentAgency], a.[ParentAgency]) AS [ParentAgency],
		COALESCE(pas.[ParentAgencyNum], p.[ParentAgencyNum], s.[ParentAgencyNum], a.[ParentAgencyNum]) AS [ParentAgencyNum],
		COALESCE(pas.[Custom_Record Owner (controlled)], p.[Custom_Record Owner (controlled)]) AS [RECORD_OWNER],
		COALESCE(pas.[UniqueIDPriorSystem], p.[UniqueIDPriorSystem], s.[UniqueIDPriorSystem], a.[UniqueIDPriorSystem]) AS [UniqueIDPriorSystem],
		COALESCE(pas.[MailingAttentionName], p.[MailingAttentionName], CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingAttentionName] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingAttentionName] END) AS [MailingAttentionName],
		COALESCE(pas.[MailingAddress1], CASE WHEN p.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE p.[MailingAddress1] END, CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingAddress1] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingAddress1] END) AS [MailingAddress1],
		COALESCE(pas.[MailingAddress2], CASE WHEN p.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE p.[MailingAddress2] END, CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingAddress2] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingAddress2] END) AS [MailingAddress2],
		COALESCE(pas.[MailingCity], CASE WHEN p.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE p.[MailingCity] END, CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingCity] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingCity] END) AS [MailingCity],
		COALESCE(pas.[MailingStateProvince], CASE WHEN p.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE p.[MailingStateProvince] END, CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingStateProvince] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingStateProvince] END) AS [MailingStateProvince],
		COALESCE(pas.[MailingPostalCode], CASE WHEN p.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE p.[MailingPostalCode] END, CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingPostalCode] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingPostalCode] END) AS [MailingPostalCode],
		COALESCE(pas.[MailingCountry], CASE WHEN p.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE p.[MailingCountry] END, CASE WHEN s.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE s.[MailingCountry] END, CASE WHEN a.MailingAddressIsPrivate = 'Yes' THEN NULL ELSE a.[MailingCountry] END) AS [MailingCountry],
		COALESCE(pas.[MailingAddressIsPrivate], p.[MailingAddressIsPrivate], s.[MailingAddressIsPrivate], a.[MailingAddressIsPrivate]) AS [MailingAddressIsPrivate],
		COALESCE(pas.[PhysicalAddress1], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalAddress1] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalAddress1] END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalAddress1] END) AS [PhysicalAddress1],
		COALESCE(pas.[PhysicalAddress2], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalAddress2] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalAddress2] END,  CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalAddress2] END) AS [PhysicalAddress2],
		COALESCE(pas.[PhysicalCity], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalCity] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalCity] END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalCity] END) AS [PhysicalCity],
		COALESCE(pas.[PhysicalCounty], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalCounty] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalCounty] END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalCounty] END) AS [PhysicalCounty],
		COALESCE(pas.[PhysicalStateProvince], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalStateProvince] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalStateProvince] END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalStateProvince] END) AS [PhysicalStateProvince],
		COALESCE(pas.[PhysicalPostalCode], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalPostalCode] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalPostalCode] END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalPostalCode] END) AS [PhysicalPostalCode],
		COALESCE(pas.[PhysicalCountry], CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE p.[PhysicalCountry] END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE s.[PhysicalCountry] END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE a.[PhysicalCountry] END) AS [PhysicalCountry],
		COALESCE(pas.[PhysicalAddressIsPrivate], p.[PhysicalAddressIsPrivate], s.[PhysicalAddressIsPrivate], a.[PhysicalAddressIsPrivate]) AS [PhysicalAddressIsPrivate],
		COALESCE(pas.[OtherAddress1], p.[OtherAddress1], s.[OtherAddress1], a.[OtherAddress1]) AS [OtherAddress1],
		COALESCE(pas.[OtherAddress2], p.[OtherAddress2], s.[OtherAddress2], a.[OtherAddress2]) AS [OtherAddress2],
		COALESCE(pas.[OtherCity], p.[OtherCity], s.[OtherCity], a.[OtherCity]) AS [OtherCity],
		COALESCE(pas.[OtherCounty], p.[OtherCounty], s.[OtherCounty], a.[OtherCounty]) AS [OtherCounty],
		COALESCE(pas.[OtherStateProvince], p.[OtherStateProvince], s.[OtherStateProvince], a.[OtherStateProvince]) AS [OtherStateProvince],
		COALESCE(pas.[OtherPostalCode], p.[OtherPostalCode], s.[OtherPostalCode], a.[OtherPostalCode]) AS [OtherPostalCode],
		COALESCE(pas.[OtherCountry], p.[OtherCountry], s.[OtherCountry], a.[OtherCountry]) AS [OtherCountry],
		COALESCE(NULLIF(pas.[Latitude],'0'), CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(p.[Latitude],'0') END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Latitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Latitude],'0') END) AS [Latitude],
		COALESCE(NULLIF(pas.[Longitude], '0'), CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(p.[Longitude],'0') END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Longitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Longitude],'0') END) AS [Longitude],
		COALESCE(pas.[HoursOfOperation], p.[HoursOfOperation], s.[HoursOfOperation], a.[HoursOfOperation]) AS [HoursOfOperation],
		COALESCE(pas.[Phone1Number], CASE WHEN p.[Phone1IsPrivate] = 'True' THEN NULL ELSE p.[Phone1Number] END, CASE WHEN s.[Phone1IsPrivate] = 'True' THEN NULL ELSE s.[Phone1Number] END, CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Number] END) AS [Phone1Number],
		COALESCE(pas.[Phone1Name], CASE WHEN p.[Phone1IsPrivate] = 'True' THEN NULL ELSE p.[Phone1Name] END, CASE WHEN s.[Phone1IsPrivate] = 'True' THEN NULL ELSE s.[Phone1Name] END, CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Name] END) AS [Phone1Name],
		COALESCE(pas.[Phone1Description], CASE WHEN p.[Phone1IsPrivate] = 'True' THEN NULL ELSE p.[Phone1Description] END, CASE WHEN s.[Phone1IsPrivate] = 'True' THEN NULL ELSE s.[Phone1Description] END, CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Description] END) AS [Phone1Description],
		COALESCE(pas.[Phone1IsPrivate], p.[Phone1IsPrivate], s.[Phone1IsPrivate], a.[Phone1IsPrivate]) AS [Phone1IsPrivate],
		COALESCE(pas.[Phone1Type], CASE WHEN p.[Phone1IsPrivate] = 'True' THEN NULL ELSE p.[Phone1Type] END, CASE WHEN s.[Phone1IsPrivate] = 'True' THEN NULL ELSE s.[Phone1Type] END, CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Type] END) AS [Phone1Type],
		COALESCE(pas.[Phone2Number], CASE WHEN p.[Phone2IsPrivate] = 'True' THEN NULL ELSE p.[Phone2Number] END, CASE WHEN s.[Phone2IsPrivate] = 'True' THEN NULL ELSE s.[Phone2Number] END, CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Number] END) AS [Phone2Number],
		COALESCE(pas.[Phone2Name], CASE WHEN p.[Phone2IsPrivate] = 'True' THEN NULL ELSE p.[Phone2Name] END, CASE WHEN s.[Phone2IsPrivate] = 'True' THEN NULL ELSE s.[Phone2Name] END, CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Name] END) AS [Phone2Name],
		COALESCE(pas.[Phone2Description], CASE WHEN p.[Phone2IsPrivate] = 'True' THEN NULL ELSE p.[Phone2Description] END, CASE WHEN s.[Phone2IsPrivate] = 'True' THEN NULL ELSE s.[Phone2Description] END, CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Description] END) AS [Phone2Description],
		COALESCE(pas.[Phone2IsPrivate], p.[Phone2IsPrivate], s.[Phone2IsPrivate], a.[Phone2IsPrivate]) AS [Phone2IsPrivate],
		COALESCE(pas.[Phone2Type], CASE WHEN p.[Phone2IsPrivate] = 'True' THEN NULL ELSE p.[Phone2Type] END, CASE WHEN s.[Phone2IsPrivate] = 'True' THEN NULL ELSE s.[Phone2Type] END, CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Type] END) AS [Phone2Type],
		COALESCE(pas.[Phone3Number], CASE WHEN p.[Phone3IsPrivate] = 'True' THEN NULL ELSE p.[Phone3Number] END, CASE WHEN s.[Phone3IsPrivate] = 'True' THEN NULL ELSE s.[Phone3Number] END, CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Number] END) AS [Phone3Number],
		COALESCE(pas.[Phone3Name], CASE WHEN p.[Phone3IsPrivate] = 'True' THEN NULL ELSE p.[Phone3Name] END, CASE WHEN s.[Phone3IsPrivate] = 'True' THEN NULL ELSE s.[Phone3Name] END, CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Name] END) AS [Phone3Name],
		COALESCE(pas.[Phone3Description], CASE WHEN p.[Phone3IsPrivate] = 'True' THEN NULL ELSE p.[Phone3Description] END, CASE WHEN s.[Phone3IsPrivate] = 'True' THEN NULL ELSE s.[Phone3Description] END, CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Description] END) AS [Phone3Description],
		COALESCE(pas.[Phone3IsPrivate], p.[Phone3IsPrivate], s.[Phone3IsPrivate], a.[Phone3IsPrivate]) AS [Phone3IsPrivate],
		COALESCE(pas.[Phone3Type], CASE WHEN p.[Phone3IsPrivate] = 'True' THEN NULL ELSE p.[Phone3Type] END, CASE WHEN s.[Phone3IsPrivate] = 'True' THEN NULL ELSE s.[Phone3Type] END, CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Type] END) AS [Phone3Type],
		COALESCE(pas.[Phone4Number], CASE WHEN p.[Phone4IsPrivate] = 'True' THEN NULL ELSE p.[Phone4Number] END, CASE WHEN s.[Phone4IsPrivate] = 'True' THEN NULL ELSE s.[Phone4Number] END, CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Number] END) AS [Phone4Number],
		COALESCE(pas.[Phone4Name], CASE WHEN p.[Phone4IsPrivate] = 'True' THEN NULL ELSE p.[Phone4Name] END, CASE WHEN s.[Phone4IsPrivate] = 'True' THEN NULL ELSE s.[Phone4Name] END, CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Name] END) AS [Phone4Name],
		COALESCE(pas.[Phone4Description], CASE WHEN p.[Phone4IsPrivate] = 'True' THEN NULL ELSE p.[Phone4Description] END, CASE WHEN s.[Phone4IsPrivate] = 'True' THEN NULL ELSE s.[Phone4Description] END, CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Description] END) AS [Phone4Description],
		COALESCE(pas.[Phone4IsPrivate], p.[Phone4IsPrivate], s.[Phone4IsPrivate], a.[Phone4IsPrivate]) AS [Phone4IsPrivate],
		COALESCE(pas.[Phone4Type], CASE WHEN p.[Phone4IsPrivate] = 'True' THEN NULL ELSE p.[Phone4Type] END, CASE WHEN s.[Phone4IsPrivate] = 'True' THEN NULL ELSE s.[Phone4Type] END, CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Type] END) AS [Phone4Type],
		COALESCE(pas.[Phone5Number], CASE WHEN p.[Phone5IsPrivate] = 'True' THEN NULL ELSE p.[Phone5Number] END, CASE WHEN s.[Phone5IsPrivate] = 'True' THEN NULL ELSE s.[Phone5Number] END, CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5Number] END) AS [Phone5Number],
		COALESCE(pas.[Phone5name], CASE WHEN p.[Phone5IsPrivate] = 'True' THEN NULL ELSE p.[Phone5name] END, CASE WHEN s.[Phone5IsPrivate] = 'True' THEN NULL ELSE s.[Phone5name] END, CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5name] END) AS [Phone5name],
		COALESCE(pas.[Phone5Description], CASE WHEN p.[Phone5IsPrivate] = 'True' THEN NULL ELSE p.[Phone5Description] END, CASE WHEN s.[Phone5IsPrivate] = 'True' THEN NULL ELSE s.[Phone5Description] END, CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5Description] END) AS [Phone5Description],
		COALESCE(pas.[Phone5IsPrivate], p.[Phone5IsPrivate], s.[Phone5IsPrivate], a.[Phone5IsPrivate]) AS [Phone5IsPrivate],
		COALESCE(pas.[Phone5Type], CASE WHEN p.[Phone5IsPrivate] = 'True' THEN NULL ELSE p.[Phone5Type] END, CASE WHEN s.[Phone5IsPrivate] = 'True' THEN NULL ELSE s.[Phone5Type] END, CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5Type] END) AS [Phone5Type],
		COALESCE(pas.[PhoneFax], CASE WHEN p.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE p.[PhoneFax] END, CASE WHEN s.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE s.[PhoneFax] END, CASE WHEN a.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE a.[PhoneFax] END) AS [PhoneFax],
		COALESCE(pas.[PhoneFaxDescription], CASE WHEN p.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE p.[PhoneFaxDescription] END, CASE WHEN s.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE s.[PhoneFaxDescription] END, CASE WHEN a.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE a.[PhoneFaxDescription] END) AS [PhoneFaxDescription],
		COALESCE(pas.[PhoneFaxIsPrivate], p.[PhoneFaxIsPrivate], s.[PhoneFaxIsPrivate], a.[PhoneFaxIsPrivate]) AS [PhoneFaxIsPrivate],
		COALESCE(pas.[PhoneTTY], CASE WHEN p.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE p.[PhoneTTY] END, CASE WHEN s.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE s.[PhoneTTY] END, CASE WHEN a.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTTY] END) AS [PhoneTTY],
		COALESCE(pas.[PhoneTTYDescription], CASE WHEN p.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE p.[PhoneTTYDescription] END, CASE WHEN s.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE s.[PhoneTTYDescription] END, CASE WHEN a.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTTYDescription] END) AS [PhoneTTYDescription],
		COALESCE(pas.[PhoneTTYIsPrivate], p.[PhoneTTYIsPrivate], s.[PhoneTTYIsPrivate], a.[PhoneTTYIsPrivate]) AS [PhoneTTYIsPrivate],
		COALESCE(pas.[PhoneTollFree], CASE WHEN p.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE p.[PhoneTollFree] END, CASE WHEN s.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE s.[PhoneTollFree] END, CASE WHEN a.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTollFree] END) AS [PhoneTollFree],
		COALESCE(pas.[PhoneTollFreeDescription], CASE WHEN p.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE p.[PhoneTollFreeDescription] END, CASE WHEN s.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE s.[PhoneTollFreeDescription] END, CASE WHEN a.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTollFreeDescription] END) AS [PhoneTollFreeDescription],
		COALESCE(pas.[PhoneTollFreeIsPrivate], p.[PhoneTollFreeIsPrivate], s.[PhoneTollFreeIsPrivate], a.[PhoneTollFreeIsPrivate]) AS [PhoneTollFreeIsPrivate],
		COALESCE(pas.[PhoneNumberHotline], CASE WHEN p.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberHotline] END, CASE WHEN s.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberHotline] END, CASE WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberHotline] END) AS [PhoneNumberHotline],
		COALESCE(pas.[PhoneNumberHotlineDescription], CASE WHEN p.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberHotlineDescription] END, CASE WHEN s.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberHotlineDescription] END, CASE WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberHotlineDescription] END) AS [PhoneNumberHotlineDescription],
		COALESCE(pas.[PhoneNumberHotlineIsPrivate], p.[PhoneNumberHotlineIsPrivate], s.[PhoneNumberHotlineIsPrivate], a.[PhoneNumberHotlineIsPrivate]) AS [PhoneNumberHotlineIsPrivate],
		COALESCE(pas.[PhoneNumberBusinessLine], CASE WHEN p.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberBusinessLine] END, CASE WHEN s.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberBusinessLine] END, CASE WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberBusinessLine] END) AS [PhoneNumberBusinessLine],
		COALESCE(pas.[PhoneNumberBusinessLineDescription], CASE WHEN p.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberBusinessLineDescription] END, CASE WHEN s.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberBusinessLineDescription] END, CASE WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberBusinessLineDescription] END) AS [PhoneNumberBusinessLineDescription],
		COALESCE(pas.[PhoneNumberBusinessLineIsPrivate], p.[PhoneNumberBusinessLineIsPrivate], s.[PhoneNumberBusinessLineIsPrivate], a.[PhoneNumberBusinessLineIsPrivate]) AS [PhoneNumberBusinessLineIsPrivate],
		COALESCE(pas.[PhoneNumberOutOfArea], CASE WHEN p.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberOutOfArea] END, CASE WHEN s.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberOutOfArea] END, CASE WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberOutOfArea] END) AS [PhoneNumberOutOfArea],
		COALESCE(pas.[PhoneNumberOutOfAreaDescription], CASE WHEN p.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberOutOfAreaDescription] END, CASE WHEN s.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberOutOfAreaDescription] END, CASE WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberOutOfAreaDescription] END) AS [PhoneNumberOutOfAreaDescription],
		COALESCE(pas.[PhoneNumberOutOfAreaIsPrivate], p.[PhoneNumberOutOfAreaIsPrivate], s.[PhoneNumberOutOfAreaIsPrivate], a.[PhoneNumberOutOfAreaIsPrivate]) AS [PhoneNumberOutOfAreaIsPrivate],
		COALESCE(pas.[PhoneNumberAfterHours], CASE WHEN p.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberAfterHours] END, CASE WHEN s.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberAfterHours] END, CASE WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberAfterHours] END) AS [PhoneNumberAfterHours],
		COALESCE(pas.[PhoneNumberAfterHoursDescription], CASE WHEN p.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE p.[PhoneNumberAfterHoursDescription] END, CASE WHEN s.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE s.[PhoneNumberAfterHoursDescription] END, CASE WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberAfterHoursDescription] END) AS [PhoneNumberAfterHoursDescription],
		COALESCE(pas.[PhoneNumberAfterHoursIsPrivate], p.[PhoneNumberAfterHoursIsPrivate], s.[PhoneNumberAfterHoursIsPrivate], a.[PhoneNumberAfterHoursIsPrivate]) AS [PhoneNumberAfterHoursIsPrivate],
		COALESCE(pas.[EmailAddressMain], p.[EmailAddressMain], s.[EmailAddressMain], a.[EmailAddressMain]) AS [EmailAddressMain],
		COALESCE(pas.[WebsiteAddress], p.[WebsiteAddress], s.[WebsiteAddress], a.[WebsiteAddress]) AS [WebsiteAddress],
		COALESCE(pas.[AgencyStatus], p.[AgencyStatus], s.[AgencyStatus], a.[AgencyStatus]) AS [AgencyStatus],
		COALESCE(pas.[AgencyClassification], p.[AgencyClassification], s.[AgencyClassification], a.[AgencyClassification]) AS [AgencyClassification],
		COALESCE(pas.[CoverageArea], p.[CoverageArea], s.[CoverageArea], a.[CoverageArea]) AS [CoverageArea],
		COALESCE(pas.[CoverageAreaText], p.[CoverageAreaText], s.[CoverageAreaText], a.[CoverageAreaText]) AS [CoverageAreaText],
		COALESCE(pas.[Eligibility], p.[Eligibility], s.[Eligibility], a.[Eligibility]) AS [Eligibility],
		COALESCE(pas.[EligibilityAdult], p.[EligibilityAdult], s.[EligibilityAdult], a.[EligibilityAdult]) AS [EligibilityAdult],
		COALESCE(pas.[EligibilityChild], p.[EligibilityChild], s.[EligibilityChild], a.[EligibilityChild]) AS [EligibilityChild],
		COALESCE(pas.[EligibilityFamily], p.[EligibilityFamily], s.[EligibilityFamily], a.[EligibilityFamily]) AS [EligibilityFamily],
		COALESCE(pas.[EligibilityFemale], p.[EligibilityFemale], s.[EligibilityFemale], a.[EligibilityFemale]) AS [EligibilityFemale],
		COALESCE(pas.[EligibilityMale], p.[EligibilityMale], s.[EligibilityMale], a.[EligibilityMale]) AS [EligibilityMale],
		COALESCE(pas.[EligibilityTeen], p.[EligibilityTeen], s.[EligibilityTeen], a.[EligibilityTeen]) AS [EligibilityTeen],
		COALESCE(pas.[SeniorWorkerName], CASE WHEN p.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE p.[SeniorWorkerName] END, CASE WHEN s.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE s.[SeniorWorkerName] END, CASE WHEN a.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE a.[SeniorWorkerName] END) AS [SeniorWorkerName],
		COALESCE(pas.[SeniorWorkerTitle], CASE WHEN p.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE p.[SeniorWorkerTitle] END, CASE WHEN s.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE s.[SeniorWorkerTitle] END, CASE WHEN a.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE a.[SeniorWorkerTitle] END) AS [SeniorWorkerTitle],
		COALESCE(pas.[SeniorWorkerEmailAddress], CASE WHEN p.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE p.[SeniorWorkerEmailAddress] END, CASE WHEN s.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE s.[SeniorWorkerEmailAddress] END, CASE WHEN a.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE a.[SeniorWorkerEmailAddress] END) AS [SeniorWorkerEmailAddress],
		COALESCE(pas.[SeniorWorkerPhoneNumber], CASE WHEN p.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE p.[SeniorWorkerPhoneNumber] END, CASE WHEN s.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE s.[SeniorWorkerPhoneNumber] END, CASE WHEN a.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE a.[SeniorWorkerPhoneNumber] END) AS [SeniorWorkerPhoneNumber],
		COALESCE(pas.[SeniorWorkerIsPrivate], p.[SeniorWorkerIsPrivate], s.[SeniorWorkerIsPrivate], CASE WHEN a.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE a.[SeniorWorkerIsPrivate] END) AS [SeniorWorkerIsPrivate],
		COALESCE(pas.[MainContactName], CASE WHEN p.MainContactIsPrivate = 'Yes' THEN NULL ELSE p.[MainContactName] END, CASE WHEN s.MainContactIsPrivate = 'Yes' THEN NULL ELSE s.[MainContactName] END, CASE WHEN a.MainContactIsPrivate = 'Yes' THEN NULL ELSE a.[MainContactName] END) AS [MainContactName],
		COALESCE(pas.[MainContactTitle], CASE WHEN p.MainContactIsPrivate = 'Yes' THEN NULL ELSE p.[MainContactTitle] END, CASE WHEN s.MainContactIsPrivate = 'Yes' THEN NULL ELSE s.[MainContactTitle] END, CASE WHEN a.MainContactIsPrivate = 'Yes' THEN NULL ELSE a.[MainContactTitle] END) AS [MainContactTitle],
		COALESCE(pas.[MainContactEmailAddress], CASE WHEN p.MainContactIsPrivate = 'Yes' THEN NULL ELSE p.[MainContactEmailAddress] END, CASE WHEN s.MainContactIsPrivate = 'Yes' THEN NULL ELSE s.[MainContactEmailAddress] END, CASE WHEN a.MainContactIsPrivate = 'Yes' THEN NULL ELSE a.[MainContactEmailAddress] END) AS [MainContactEmailAddress],
		COALESCE(pas.[MainContactPhoneNumber], CASE WHEN p.MainContactIsPrivate = 'Yes' THEN NULL ELSE p.[MainContactPhoneNumber] END, CASE WHEN s.MainContactIsPrivate = 'Yes' THEN NULL ELSE s.[MainContactPhoneNumber] END, CASE WHEN a.MainContactIsPrivate = 'Yes' THEN NULL ELSE a.[MainContactPhoneNumber] END) AS [MainContactPhoneNumber],
		COALESCE(pas.[MainContactType], CASE WHEN p.MainContactIsPrivate = 'Yes' THEN NULL ELSE p.[MainContactType] END, CASE WHEN s.MainContactIsPrivate = 'Yes' THEN NULL ELSE s.[MainContactType] END, CASE WHEN a.MainContactIsPrivate = 'Yes' THEN NULL ELSE a.[MainContactType] END) AS [MainContactType],
		COALESCE(pas.[MainContactIsPrivate], p.[MainContactIsPrivate], s.[MainContactIsPrivate], a.[MainContactIsPrivate]) AS [MainContactIsPrivate],
		COALESCE(pas.[LicenseAccreditation], p.[LicenseAccreditation], s.[LicenseAccreditation], a.[LicenseAccreditation]) AS [LicenseAccreditation],
		COALESCE(pas.[YearIncorporated], p.[YearIncorporated], s.[YearIncorporated], a.[YearIncorporated]) AS [YearIncorporated],
		COALESCE(pas.[AnnualBudgetTotal], p.[AnnualBudgetTotal], s.[AnnualBudgetTotal], a.[AnnualBudgetTotal]) AS [AnnualBudgetTotal],
		COALESCE(pas.[LegalStatus], p.[LegalStatus], s.[LegalStatus], a.[LegalStatus]) AS [LegalStatus],
		COALESCE(pas.[SourceOfFunds], p.[SourceOfFunds], s.[SourceOfFunds], a.[SourceOfFunds]) AS [SourceOfFunds],
		COALESCE(pas.[ExcludeFromWebsite], p.[ExcludeFromWebsite], s.[ExcludeFromWebsite], a.[ExcludeFromWebsite]) AS [ExcludeFromWebsite],
		COALESCE(pas.[ExcludeFromDirectory], p.[ExcludeFromDirectory], s.[ExcludeFromDirectory], a.[ExcludeFromDirectory]) AS [ExcludeFromDirectory],
		COALESCE(pas.[DisabilitiesAccess], p.[DisabilitiesAccess], s.[DisabilitiesAccess], a.[DisabilitiesAccess]) AS [DisabilitiesAccess],
		COALESCE(pas.[PhysicalLocationDescription], p.[PhysicalLocationDescription], s.[PhysicalLocationDescription], a.[PhysicalLocationDescription]) AS [PhysicalLocationDescription],
		COALESCE(pas.[BusServiceAccess], p.[BusServiceAccess], s.[BusServiceAccess], a.[BusServiceAccess]) AS [BusServiceAccess],
		COALESCE(pas.[PublicAccessTransportation], p.[PublicAccessTransportation], s.[PublicAccessTransportation], a.[PublicAccessTransportation]) AS [PublicAccessTransportation],
		COALESCE(pas.[PaymentMethods], p.[PaymentMethods], s.[PaymentMethods], a.[PaymentMethods]) AS [PaymentMethods],
		COALESCE(pas.[FeeStructureSource], p.[FeeStructureSource], s.[FeeStructureSource], a.[FeeStructureSource]) AS [FeeStructureSource],
		COALESCE(pas.[ApplicationProcess], p.[ApplicationProcess], s.[ApplicationProcess], a.[ApplicationProcess]) AS [ApplicationProcess],
		COALESCE(pas.[ResourceInfo], p.[ResourceInfo], s.[ResourceInfo], a.[ResourceInfo]) AS [ResourceInfo],
		COALESCE(pas.[DocumentsRequired], p.[DocumentsRequired], s.[DocumentsRequired], a.[DocumentsRequired]) AS [DocumentsRequired],
		COALESCE(pas.[LanguagesOffered], p.[LanguagesOffered], s.[LanguagesOffered], a.[LanguagesOffered]) AS [LanguagesOffered],
		COALESCE(pas.[LanguagesOfferedList], p.[LanguagesOfferedList], s.[LanguagesOfferedList], a.[LanguagesOfferedList]) AS [LanguagesOfferedList],
		COALESCE(pas.[AvailabilityNumberOfTimes], p.[AvailabilityNumberOfTimes], s.[AvailabilityNumberOfTimes], a.[AvailabilityNumberOfTimes]) AS [AvailabilityNumberOfTimes],
		COALESCE(pas.[AvailabilityFrequency], p.[AvailabilityFrequency], s.[AvailabilityFrequency], a.[AvailabilityFrequency]) AS [AvailabilityFrequency],
		COALESCE(pas.[AvailabilityPeriod], p.[AvailabilityPeriod], s.[AvailabilityPeriod], a.[AvailabilityPeriod]) AS [AvailabilityPeriod],
		COALESCE(pas.[ServiceNotAlwaysAvailability], p.[ServiceNotAlwaysAvailability], s.[ServiceNotAlwaysAvailability], a.[ServiceNotAlwaysAvailability]) AS [ServiceNotAlwaysAvailability],
		COALESCE(pas.[CapacityType], p.[CapacityType], s.[CapacityType], a.[CapacityType]) AS [CapacityType],
		COALESCE(pas.[ServiceCapacity], p.[ServiceCapacity], s.[ServiceCapacity], a.[ServiceCapacity]) AS [ServiceCapacity],
		COALESCE(pas.[NormalWaitTime], p.[NormalWaitTime], s.[NormalWaitTime], a.[NormalWaitTime]) AS [NormalWaitTime],
		COALESCE(pas.[TemporaryMessage], p.[TemporaryMessage], s.[TemporaryMessage], a.[TemporaryMessage]) AS [TemporaryMessage],
		COALESCE(pas.[TemporaryMessageAppears], p.[TemporaryMessageAppears], s.[TemporaryMessageAppears], a.[TemporaryMessageAppears]) AS [TemporaryMessageAppears],
		COALESCE(pas.[TemporaryMessageExpires], p.[TemporaryMessageExpires], s.[TemporaryMessageExpires], a.[TemporaryMessageExpires]) AS [TemporaryMessageExpires],
		COALESCE(pas.[EnteredOn], p.[EnteredOn], s.[EnteredOn], a.[EnteredOn]) AS [EnteredOn],
		COALESCE(pas.[UpdatedOn], p.[UpdatedOn], s.[UpdatedOn], a.[UpdatedOn]) AS [UpdatedOn],
		COALESCE(pas.[MadeInactiveOn], p.[MadeInactiveOn], s.[MadeInactiveOn], a.[MadeInactiveOn]) AS [MadeInactiveOn],
		COALESCE(pas.[InternalNotes], p.[InternalNotes]) AS [InternalNotes],
		COALESCE(pas.[InternalNotesForEditorsAndViewers], p.[InternalNotesForEditorsAndViewers]) AS [InternalNotesForEditorsAndViewers],
		COALESCE(pas.[HighlightedResource], p.[HighlightedResource], s.[HighlightedResource], a.[HighlightedResource]) AS [HighlightedResource],
		COALESCE(pas.[LastVerifiedOn], p.[LastVerifiedOn], s.[LastVerifiedOn], a.[LastVerifiedOn]) AS [LastVerifiedOn],
		COALESCE(pas.[LastVerifiedByName], p.[LastVerifiedByName], s.[LastVerifiedByName], a.[LastVerifiedByName]) AS [LastVerifiedByName],
		COALESCE(pas.[LastVerifiedByTitle], p.[LastVerifiedByTitle], s.[LastVerifiedByTitle], a.[LastVerifiedByTitle]) AS [LastVerifiedByTitle],
		COALESCE(pas.[LastVerifiedByPhoneNumber], p.[LastVerifiedByPhoneNumber], s.[LastVerifiedByPhoneNumber], a.[LastVerifiedByPhoneNumber]) AS [LastVerifiedByPhoneNumber],
		COALESCE(pas.[LastVerifiedByEmailAddress], p.[LastVerifiedByEmailAddress], s.[LastVerifiedByEmailAddress], a.[LastVerifiedByEmailAddress]) AS [LastVerifiedByEmailAddress],
		COALESCE(pas.[LastVerificationApprovedBy], p.[LastVerificationApprovedBy], s.[LastVerificationApprovedBy], a.[LastVerificationApprovedBy]) AS [LastVerificationApprovedBy],
		COALESCE(pas.[AvailableForDirectory], p.[AvailableForDirectory], s.[AvailableForDirectory], a.[AvailableForDirectory]) AS [AvailableForDirectory],
		COALESCE(pas.[AvailableForReferral], p.[AvailableForReferral], s.[AvailableForReferral], a.[AvailableForReferral]) AS [AvailableForReferral],
		COALESCE(pas.[AvailableForResearch], p.[AvailableForResearch], s.[AvailableForResearch], a.[AvailableForResearch]) AS [AvailableForResearch],
		COALESCE(pas.[PreferredProvider], p.[PreferredProvider], s.[PreferredProvider], a.[PreferredProvider]) AS [PreferredProvider],
		COALESCE(pas.[ConnectsToSiteNum], p.[ConnectsToSiteNum], s.[ConnectsToSiteNum], a.[ConnectsToSiteNum]) AS [ConnectsToSiteNum],
		COALESCE(pas.[ConnectsToProgramNum], p.[ConnectsToProgramNum], s.[ConnectsToProgramNum], a.[ConnectsToProgramNum]) AS [ConnectsToProgramNum],
		COALESCE(pas.[LanguageOfRecord], p.[LanguageOfRecord], s.[LanguageOfRecord], a.[LanguageOfRecord]) AS [LanguageOfRecord],
		COALESCE(pas.[CurrentWorkflowStepCode], p.[CurrentWorkflowStepCode], s.[CurrentWorkflowStepCode], a.[CurrentWorkflowStepCode]) AS [CurrentWorkflowStepCode],
		COALESCE(pas.[VolunteerOpportunities], p.[VolunteerOpportunities], s.[VolunteerOpportunities], a.[VolunteerOpportunities]) AS [VolunteerOpportunities],
		COALESCE(pas.[VolunteerDuties], p.[VolunteerDuties], s.[VolunteerDuties], a.[VolunteerDuties]) AS [VolunteerDuties],
		COALESCE(pas.[IsLinkOnly], p.[IsLinkOnly], s.[IsLinkOnly], a.[IsLinkOnly]) AS [IsLinkOnly],
		COALESCE(pas.[ProgramAgencyNamePublic], p.[ProgramAgencyNamePublic], s.[ProgramAgencyNamePublic], a.[ProgramAgencyNamePublic]) AS [ProgramAgencyNamePublic],
		COALESCE(pas.[SiteAgencyNamePublic], p.[SiteAgencyNamePublic], s.[SiteAgencyNamePublic], a.[SiteAgencyNamePublic]) AS [SiteAgencyNamePublic],
		COALESCE(pas.[Categories], p.[Categories], s.[Categories], a.[Categories]) AS [Categories],
		COALESCE(pas.[TaxonomyTerm], p.[TaxonomyTerm], s.[TaxonomyTerm], a.[TaxonomyTerm]) AS [TaxonomyTerm],
		COALESCE(pas.[TaxonomyTerms], p.[TaxonomyTerms], s.[TaxonomyTerms], a.[TaxonomyTerms]) AS [TaxonomyTerms],
		COALESCE(pas.[TaxonomyTermsNotDeactivated], p.[TaxonomyTermsNotDeactivated], s.[TaxonomyTermsNotDeactivated], a.[TaxonomyTermsNotDeactivated]) AS [TaxonomyTermsNotDeactivated],
		COALESCE(pas.[TaxonomyCodes], p.[TaxonomyCodes], s.[TaxonomyCodes], a.[TaxonomyCodes]) AS [TaxonomyCodes],
		COALESCE(pas.[Coverage], p.[Coverage], s.[Coverage], a.[Coverage]) AS [Coverage],
		COALESCE(pas.[Hours], p.[Hours], s.[Hours], a.[Hours]) AS [Hours],
		COALESCE(pas.[Custom_Public Comments], p.[Custom_Public Comments]) AS [Custom_Public Comments],
		COALESCE(pas.[Custom_Former Names], p.[Custom_Former Names], s.[Custom_Former Names], a.[Custom_Former Names]) AS [Custom_Former Names],
		COALESCE(pas.[Custom_Legal Name], p.[Custom_Legal Name], s.[Custom_Legal Name], a.[Custom_Legal Name]) AS [Custom_Legal Name],
		COALESCE(pas.[Custom_Facebook], p.[Custom_Facebook], s.[Custom_Facebook], a.[Custom_Facebook]) AS [Custom_Facebook],
		COALESCE(pas.[Custom_Instagram], p.[Custom_Instagram], s.[Custom_Instagram], a.[Custom_Instagram]) AS [Custom_Instagram],
		COALESCE(pas.[Custom_LinkedIn], p.[Custom_LinkedIn], s.[Custom_LinkedIn], a.[Custom_LinkedIn]) AS [Custom_LinkedIn],
		COALESCE(pas.[Custom_Twitter], p.[Custom_Twitter], s.[Custom_Twitter], a.[Custom_Twitter]) AS [Custom_Twitter],
		COALESCE(pas.[Custom_YouTube], p.[Custom_YouTube], s.[Custom_YouTube], a.[Custom_YouTube]) AS [Custom_YouTube],
		COALESCE(pas.[Custom_Minimum Age], p.[Custom_Minimum Age], s.[Custom_Minimum Age], a.[Custom_Minimum Age]) AS [Custom_Minimum Age],
		COALESCE(pas.[Custom_Maximum Age], p.[Custom_Maximum Age], s.[Custom_Maximum Age], a.[Custom_Maximum Age]) AS [Custom_Maximum Age],
		a.PublicName AS ORG_LEVEL_1,
		a.AgencyDescription AS ORG_DESCRIPTION,
		s.PublicName AS LOCATION_NAME,
		s.AgencyDescription AS LOCATION_DESCRIPTION,
		COALESCE(p.PublicName, pas.PublicName) AS SERVICE_NAME_LEVEL_1,
		s.PublicName AS SERVICE_NAME_LEVEL_2,
		COALESCE(pas.AgencyDescription, p.AgencyDescription) AS DESCRIPTION,
		pas.DELETION_DATE
	FROM dbo.CIC_iCarolImport pas
	LEFT JOIN dbo.CIC_iCarolImport p
		ON p.ResourceAgencyNum=pas.ConnectsToProgramNum AND p.TaxonomyLevelName='Program' AND p.LangID=pas.LangID
	LEFT JOIN dbo.CIC_iCarolImport s
		ON s.ResourceAgencyNum=pas.ConnectsToSiteNum AND s.TaxonomyLevelName='Site' AND s.langid=pas.LangID
	LEFT JOIN dbo.CIC_iCarolImport a
		ON pas.ParentAgencyNum=a.ResourceAgencyNum AND a.TaxonomyLevelName='Agency' AND a.LangID=pas.LangID
	WHERE pas.TaxonomyLevelName='ProgramAtSite'
) AS src
ON src.ResourceAgencyNum=dst.ResourceAgencyNum AND src.LangID=dst.LangID AND src.TaxonomyLevelName = 'ProgramAtSite'
WHEN MATCHED AND src.SYNC_DATE > dst.DATE_MODIFIED THEN 
	UPDATE SET 
		[PublicName]=src.[PublicName],
		[AlternateName]=src.[AlternateName],
		[OfficialName]=src.[OfficialName],
		[TaxonomyLevelName]=src.[TaxonomyLevelName],
		[ParentAgency]=src.[ParentAgency],
		[ParentAgencyNum]=src.[ParentAgencyNum],
		[RECORD_OWNER]=src.[RECORD_OWNER],
		[UniqueIDPriorSystem]=src.[UniqueIDPriorSystem],
		[MailingAttentionName]=src.[MailingAttentionName],
		[MailingAddress1]=src.[MailingAddress1],
		[MailingAddress2]=src.[MailingAddress2],
		[MailingCity]=src.[MailingCity],
		[MailingStateProvince]=src.[MailingStateProvince],
		[MailingPostalCode]=src.[MailingPostalCode],
		[MailingCountry]=src.[MailingCountry],
		[MailingAddressIsPrivate]=src.[MailingAddressIsPrivate],
		[PhysicalAddress1]=src.[PhysicalAddress1],
		[PhysicalAddress2]=src.[PhysicalAddress2],
		[PhysicalCity]=src.[PhysicalCity],
		[PhysicalCounty]=src.[PhysicalCounty],
		[PhysicalStateProvince]=src.[PhysicalStateProvince],
		[PhysicalPostalCode]=src.[PhysicalPostalCode],
		[PhysicalCountry]=src.[PhysicalCountry],
		[PhysicalAddressIsPrivate]=src.[PhysicalAddressIsPrivate],
		[OtherAddress1]=src.[OtherAddress1],
		[OtherAddress2]=src.[OtherAddress2],
		[OtherCity]=src.[OtherCity],
		[OtherCounty]=src.[OtherCounty],
		[OtherStateProvince]=src.[OtherStateProvince],
		[OtherPostalCode]=src.[OtherPostalCode],
		[OtherCountry]=src.[OtherCountry],
		[Latitude]=src.[Latitude],
		[Longitude]=src.[Longitude],
		[HoursOfOperation]=src.[HoursOfOperation],
		[Phone1Number]=src.[Phone1Number],
		[Phone1Name]=src.[Phone1Name],
		[Phone1Description]=src.[Phone1Description],
		[Phone1IsPrivate]=src.[Phone1IsPrivate],
		[Phone1Type]=src.[Phone1Type],
		[Phone2Number]=src.[Phone2Number],
		[Phone2Name]=src.[Phone2Name],
		[Phone2Description]=src.[Phone2Description],
		[Phone2IsPrivate]=src.[Phone2IsPrivate],
		[Phone2Type]=src.[Phone2Type],
		[Phone3Number]=src.[Phone3Number],
		[Phone3Name]=src.[Phone3Name],
		[Phone3Description]=src.[Phone3Description],
		[Phone3IsPrivate]=src.[Phone3IsPrivate],
		[Phone3Type]=src.[Phone3Type],
		[Phone4Number]=src.[Phone4Number],
		[Phone4Name]=src.[Phone4Name],
		[Phone4Description]=src.[Phone4Description],
		[Phone4IsPrivate]=src.[Phone4IsPrivate],
		[Phone4Type]=src.[Phone4Type],
		[Phone5Number]=src.[Phone5Number],
		[Phone5name]=src.[Phone5name],
		[Phone5Description]=src.[Phone5Description],
		[Phone5IsPrivate]=src.[Phone5IsPrivate],
		[Phone5Type]=src.[Phone5Type],
		[PhoneFax]=src.[PhoneFax],
		[PhoneFaxDescription]=src.[PhoneFaxDescription],
		[PhoneFaxIsPrivate]=src.[PhoneFaxIsPrivate],
		[PhoneTTY]=src.[PhoneTTY],
		[PhoneTTYDescription]=src.[PhoneTTYDescription],
		[PhoneTTYIsPrivate]=src.[PhoneTTYIsPrivate],
		[PhoneTollFree]=src.[PhoneTollFree],
		[PhoneTollFreeDescription]=src.[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate]=src.[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline]=src.[PhoneNumberHotline],
		[PhoneNumberHotlineDescription]=src.[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate]=src.[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine]=src.[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription]=src.[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate]=src.[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea]=src.[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription]=src.[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate]=src.[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours]=src.[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription]=src.[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate]=src.[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain]=src.[EmailAddressMain],
		[WebsiteAddress]=src.[WebsiteAddress],
		[AgencyStatus]=src.[AgencyStatus],
		[AgencyClassification]=src.[AgencyClassification],
		[CoverageArea]=src.[CoverageArea],
		[CoverageAreaText]=src.[CoverageAreaText],
		[Eligibility]=src.[Eligibility],
		[EligibilityAdult]=src.[EligibilityAdult],
		[EligibilityChild]=src.[EligibilityChild],
		[EligibilityFamily]=src.[EligibilityFamily],
		[EligibilityFemale]=src.[EligibilityFemale],
		[EligibilityMale]=src.[EligibilityMale],
		[EligibilityTeen]=src.[EligibilityTeen],
		[SeniorWorkerName]=src.[SeniorWorkerName],
		[SeniorWorkerTitle]=src.[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress]=src.[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber]=src.[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate]=src.[SeniorWorkerIsPrivate],
		[MainContactName]=src.[MainContactName],
		[MainContactTitle]=src.[MainContactTitle],
		[MainContactEmailAddress]=src.[MainContactEmailAddress],
		[MainContactPhoneNumber]=src.[MainContactPhoneNumber],
		[MainContactType]=src.[MainContactType],
		[MainContactIsPrivate]=src.[MainContactIsPrivate],
		[LicenseAccreditation]=src.[LicenseAccreditation],
		[YearIncorporated]=src.[YearIncorporated],
		[AnnualBudgetTotal]=src.[AnnualBudgetTotal],
		[LegalStatus]=src.[LegalStatus],
		[SourceOfFunds]=src.[SourceOfFunds],
		[ExcludeFromWebsite]=src.[ExcludeFromWebsite],
		[ExcludeFromDirectory]=src.[ExcludeFromDirectory],
		[DisabilitiesAccess]=src.[DisabilitiesAccess],
		[PhysicalLocationDescription]=src.[PhysicalLocationDescription],
		[BusServiceAccess]=src.[BusServiceAccess],
		[PublicAccessTransportation]=src.[PublicAccessTransportation],
		[PaymentMethods]=src.[PaymentMethods],
		[FeeStructureSource]=src.[FeeStructureSource],
		[ApplicationProcess]=src.[ApplicationProcess],
		[ResourceInfo]=src.[ResourceInfo],
		[DocumentsRequired]=src.[DocumentsRequired],
		[LanguagesOffered]=src.[LanguagesOffered],
		[LanguagesOfferedList]=src.[LanguagesOfferedList],
		[AvailabilityNumberOfTimes]=src.[AvailabilityNumberOfTimes],
		[AvailabilityFrequency]=src.[AvailabilityFrequency],
		[AvailabilityPeriod]=src.[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability]=src.[ServiceNotAlwaysAvailability],
		[CapacityType]=src.[CapacityType],
		[ServiceCapacity]=src.[ServiceCapacity],
		[NormalWaitTime]=src.[NormalWaitTime],
		[TemporaryMessage]=src.[TemporaryMessage],
		[TemporaryMessageAppears]=src.[TemporaryMessageAppears],
		[TemporaryMessageExpires]=src.[TemporaryMessageExpires],
		[EnteredOn]=src.[EnteredOn],
		[UpdatedOn]=src.[UpdatedOn],
		[MadeInactiveOn]=src.[MadeInactiveOn],
		[InternalNotes]=src.[InternalNotes],
		[InternalNotesForEditorsAndViewers]=src.[InternalNotesForEditorsAndViewers],
		[HighlightedResource]=src.[HighlightedResource],
		[LastVerifiedOn]=src.[LastVerifiedOn],
		[LastVerifiedByName]=src.[LastVerifiedByName],
		[LastVerifiedByTitle]=src.[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber]=src.[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress]=src.[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy]=src.[LastVerificationApprovedBy],
		[AvailableForDirectory]=src.[AvailableForDirectory],
		[AvailableForReferral]=src.[AvailableForReferral],
		[AvailableForResearch]=src.[AvailableForResearch],
		[PreferredProvider]=src.[PreferredProvider],
		[ConnectsToSiteNum]=src.[ConnectsToSiteNum],
		[ConnectsToProgramNum]=src.[ConnectsToProgramNum],
		[LanguageOfRecord]=src.[LanguageOfRecord],
		[CurrentWorkflowStepCode]=src.[CurrentWorkflowStepCode],
		[VolunteerOpportunities]=src.[VolunteerOpportunities],
		[VolunteerDuties]=src.[VolunteerDuties],
		[IsLinkOnly]=src.[IsLinkOnly],
		[ProgramAgencyNamePublic]=src.[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic]=src.[SiteAgencyNamePublic],
		[Categories]=src.[Categories],
		[TaxonomyTerm]=src.[TaxonomyTerm],
		[TaxonomyTerms]=src.[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated]=src.[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes]=src.[TaxonomyCodes],
		[Coverage]=src.[Coverage],
		[Hours]=src.[Hours],
		[Custom_Public Comments]=src.[Custom_Public Comments],
		[Custom_Former Names]=src.[Custom_Former Names],
		[Custom_Legal Name]=src.[Custom_Legal Name],
		[Custom_Facebook]=src.[Custom_Facebook],
		[Custom_Instagram]=src.[Custom_Instagram],
		[Custom_LinkedIn]=src.[Custom_LinkedIn],
		[Custom_Twitter]=src.[Custom_Twitter],
		[Custom_YouTube]=src.[Custom_YouTube],
		[Custom_Minimum Age]=src.[Custom_Minimum Age],
		[Custom_Maximum Age]=src.[Custom_Maximum Age],
		[dst].[DATE_MODIFIED]=GETDATE(),
		ORG_LEVEL_1=src.ORG_LEVEL_1,
		ORG_DESCRIPTION=src.ORG_DESCRIPTION,
		LOCATION_NAME=src.LOCATION_NAME,
		LOCATION_DESCRIPTION=src.LOCATION_DESCRIPTION,
		SERVICE_NAME_LEVEL_1=src.SERVICE_NAME_LEVEL_1,
		SERVICE_NAME_LEVEL_2=src.SERVICE_NAME_LEVEL_2,
		DESCRIPTION=src.DESCRIPTION,
		dst.ORG_LOCATION_SERVICE='SERVICE',
		dst.DELETION_DATE=src.DELETION_DATE
WHEN NOT MATCHED BY TARGET AND src.TaxonomyLevelName='ProgramAtSite' THEN
	INSERT (
		[ResourceAgencyNum],
		[LangID],
		[PublicName],
		[AlternateName],
		[OfficialName],
		[TaxonomyLevelName],
		[ParentAgency],
		[ParentAgencyNum],
		[RECORD_OWNER],
		[UniqueIDPriorSystem],
		[MailingAttentionName],
		[MailingAddress1],
		[MailingAddress2],
		[MailingCity],
		[MailingStateProvince],
		[MailingPostalCode],
		[MailingCountry],
		[MailingAddressIsPrivate],
		[PhysicalAddress1],
		[PhysicalAddress2],
		[PhysicalCity],
		[PhysicalCounty],
		[PhysicalStateProvince],
		[PhysicalPostalCode],
		[PhysicalCountry],
		[PhysicalAddressIsPrivate],
		[OtherAddress1],
		[OtherAddress2],
		[OtherCity],
		[OtherCounty],
		[OtherStateProvince],
		[OtherPostalCode],
		[OtherCountry],
		[Latitude],
		[Longitude],
		[HoursOfOperation],
		[Phone1Number],
		[Phone1Name],
		[Phone1Description],
		[Phone1IsPrivate],
		[Phone1Type],
		[Phone2Number],
		[Phone2Name],
		[Phone2Description],
		[Phone2IsPrivate],
		[Phone2Type],
		[Phone3Number],
		[Phone3Name],
		[Phone3Description],
		[Phone3IsPrivate],
		[Phone3Type],
		[Phone4Number],
		[Phone4Name],
		[Phone4Description],
		[Phone4IsPrivate],
		[Phone4Type],
		[Phone5Number],
		[Phone5name],
		[Phone5Description],
		[Phone5IsPrivate],
		[Phone5Type],
		[PhoneFax],
		[PhoneFaxDescription],
		[PhoneFaxIsPrivate],
		[PhoneTTY],
		[PhoneTTYDescription],
		[PhoneTTYIsPrivate],
		[PhoneTollFree],
		[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline],
		[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain],
		[WebsiteAddress],
		[AgencyStatus],
		[AgencyClassification],
		[CoverageArea],
		[CoverageAreaText],
		[Eligibility],
		[EligibilityAdult],
		[EligibilityChild],
		[EligibilityFamily],
		[EligibilityFemale],
		[EligibilityMale],
		[EligibilityTeen],
		[SeniorWorkerName],
		[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate],
		[MainContactName],
		[MainContactTitle],
		[MainContactEmailAddress],
		[MainContactPhoneNumber],
		[MainContactType],
		[MainContactIsPrivate],
		[LicenseAccreditation],
		[YearIncorporated],
		[AnnualBudgetTotal],
		[LegalStatus],
		[SourceOfFunds],
		[ExcludeFromWebsite],
		[ExcludeFromDirectory],
		[DisabilitiesAccess],
		[PhysicalLocationDescription],
		[BusServiceAccess],
		[PublicAccessTransportation],
		[PaymentMethods],
		[FeeStructureSource],
		[ApplicationProcess],
		[ResourceInfo],
		[DocumentsRequired],
		[LanguagesOffered],
		[LanguagesOfferedList],
		[AvailabilityNumberOfTimes],
		[AvailabilityFrequency],
		[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability],
		[CapacityType],
		[ServiceCapacity],
		[NormalWaitTime],
		[TemporaryMessage],
		[TemporaryMessageAppears],
		[TemporaryMessageExpires],
		[EnteredOn],
		[UpdatedOn],
		[MadeInactiveOn],
		[InternalNotes],
		[InternalNotesForEditorsAndViewers],
		[HighlightedResource],
		[LastVerifiedOn],
		[LastVerifiedByName],
		[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy],
		[AvailableForDirectory],
		[AvailableForReferral],
		[AvailableForResearch],
		[PreferredProvider],
		[ConnectsToSiteNum],
		[ConnectsToProgramNum],
		[LanguageOfRecord],
		[CurrentWorkflowStepCode],
		[VolunteerOpportunities],
		[VolunteerDuties],
		[IsLinkOnly],
		[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic],
		[Categories],
		[TaxonomyTerm],
		[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes],
		[Coverage],
		[Hours],
		[Custom_Public Comments],
		[Custom_Former Names],
		[Custom_Legal Name],
		[Custom_Facebook],
		[Custom_Instagram],
		[Custom_LinkedIn],
		[Custom_Twitter],
		[Custom_YouTube],
		[Custom_Minimum Age],
		[Custom_Maximum Age],
		[DATE_MODIFIED],
		ORG_LEVEL_1,
		ORG_DESCRIPTION,
		LOCATION_NAME,
		LOCATION_DESCRIPTION,
		SERVICE_NAME_LEVEL_1,
		SERVICE_NAME_LEVEL_2,
		DESCRIPTION,
		ORG_LOCATION_SERVICE,
		DELETION_DATE
	) VALUES (
		src.[ResourceAgencyNum],
		src.LangID,
		src.[PublicName],
		src.[AlternateName],
		src.[OfficialName],
		src.[TaxonomyLevelName],
		src.[ParentAgency],
		src.[ParentAgencyNum],
		src.[RECORD_OWNER],
		src.[UniqueIDPriorSystem],
		src.[MailingAttentionName],
		src.[MailingAddress1],
		src.[MailingAddress2],
		src.[MailingCity],
		src.[MailingStateProvince],
		src.[MailingPostalCode],
		src.[MailingCountry],
		src.[MailingAddressIsPrivate],
		src.[PhysicalAddress1],
		src.[PhysicalAddress2],
		src.[PhysicalCity],
		src.[PhysicalCounty],
		src.[PhysicalStateProvince],
		src.[PhysicalPostalCode],
		src.[PhysicalCountry],
		src.[PhysicalAddressIsPrivate],
		src.[OtherAddress1],
		src.[OtherAddress2],
		src.[OtherCity],
		src.[OtherCounty],
		src.[OtherStateProvince],
		src.[OtherPostalCode],
		src.[OtherCountry],
		src.[Latitude],
		src.[Longitude],
		src.[HoursOfOperation],
		src.[Phone1Number],
		src.[Phone1Name],
		src.[Phone1Description],
		src.[Phone1IsPrivate],
		src.[Phone1Type],
		src.[Phone2Number],
		src.[Phone2Name],
		src.[Phone2Description],
		src.[Phone2IsPrivate],
		src.[Phone2Type],
		src.[Phone3Number],
		src.[Phone3Name],
		src.[Phone3Description],
		src.[Phone3IsPrivate],
		src.[Phone3Type],
		src.[Phone4Number],
		src.[Phone4Name],
		src.[Phone4Description],
		src.[Phone4IsPrivate],
		src.[Phone4Type],
		src.[Phone5Number],
		src.[Phone5name],
		src.[Phone5Description],
		src.[Phone5IsPrivate],
		src.[Phone5Type],
		src.[PhoneFax],
		src.[PhoneFaxDescription],
		src.[PhoneFaxIsPrivate],
		src.[PhoneTTY],
		src.[PhoneTTYDescription],
		src.[PhoneTTYIsPrivate],
		src.[PhoneTollFree],
		src.[PhoneTollFreeDescription],
		src.[PhoneTollFreeIsPrivate],
		src.[PhoneNumberHotline],
		src.[PhoneNumberHotlineDescription],
		src.[PhoneNumberHotlineIsPrivate],
		src.[PhoneNumberBusinessLine],
		src.[PhoneNumberBusinessLineDescription],
		src.[PhoneNumberBusinessLineIsPrivate],
		src.[PhoneNumberOutOfArea],
		src.[PhoneNumberOutOfAreaDescription],
		src.[PhoneNumberOutOfAreaIsPrivate],
		src.[PhoneNumberAfterHours],
		src.[PhoneNumberAfterHoursDescription],
		src.[PhoneNumberAfterHoursIsPrivate],
		src.[EmailAddressMain],
		src.[WebsiteAddress],
		src.[AgencyStatus],
		src.[AgencyClassification],
		src.[CoverageArea],
		src.[CoverageAreaText],
		src.[Eligibility],
		src.[EligibilityAdult],
		src.[EligibilityChild],
		src.[EligibilityFamily],
		src.[EligibilityFemale],
		src.[EligibilityMale],
		src.[EligibilityTeen],
		src.[SeniorWorkerName],
		src.[SeniorWorkerTitle],
		src.[SeniorWorkerEmailAddress],
		src.[SeniorWorkerPhoneNumber],
		src.[SeniorWorkerIsPrivate],
		src.[MainContactName],
		src.[MainContactTitle],
		src.[MainContactEmailAddress],
		src.[MainContactPhoneNumber],
		src.[MainContactType],
		src.[MainContactIsPrivate],
		src.[LicenseAccreditation],
		src.[YearIncorporated],
		src.[AnnualBudgetTotal],
		src.[LegalStatus],
		src.[SourceOfFunds],
		src.[ExcludeFromWebsite],
		src.[ExcludeFromDirectory],
		src.[DisabilitiesAccess],
		src.[PhysicalLocationDescription],
		src.[BusServiceAccess],
		src.[PublicAccessTransportation],
		src.[PaymentMethods],
		src.[FeeStructureSource],
		src.[ApplicationProcess],
		src.[ResourceInfo],
		src.[DocumentsRequired],
		src.[LanguagesOffered],
		src.[LanguagesOfferedList],
		src.[AvailabilityNumberOfTimes],
		src.[AvailabilityFrequency],
		src.[AvailabilityPeriod],
		src.[ServiceNotAlwaysAvailability],
		src.[CapacityType],
		src.[ServiceCapacity],
		src.[NormalWaitTime],
		src.[TemporaryMessage],
		src.[TemporaryMessageAppears],
		src.[TemporaryMessageExpires],
		src.[EnteredOn],
		src.[UpdatedOn],
		src.[MadeInactiveOn],
		src.[InternalNotes],
		src.[InternalNotesForEditorsAndViewers],
		src.[HighlightedResource],
		src.[LastVerifiedOn],
		src.[LastVerifiedByName],
		src.[LastVerifiedByTitle],
		src.[LastVerifiedByPhoneNumber],
		src.[LastVerifiedByEmailAddress],
		src.[LastVerificationApprovedBy],
		src.[AvailableForDirectory],
		src.[AvailableForReferral],
		src.[AvailableForResearch],
		src.[PreferredProvider],
		src.[ConnectsToSiteNum],
		src.[ConnectsToProgramNum],
		src.[LanguageOfRecord],
		src.[CurrentWorkflowStepCode],
		src.[VolunteerOpportunities],
		src.[VolunteerDuties],
		src.[IsLinkOnly],
		src.[ProgramAgencyNamePublic],
		src.[SiteAgencyNamePublic],
		src.[Categories],
		src.[TaxonomyTerm],
		src.[TaxonomyTerms],
		src.[TaxonomyTermsNotDeactivated],
		src.[TaxonomyCodes],
		src.[Coverage],
		src.[Hours],
		src.[Custom_Public Comments],
		src.[Custom_Former Names],
		src.[Custom_Legal Name],
		src.[Custom_Facebook],
		src.[Custom_Instagram],
		src.[Custom_LinkedIn],
		src.[Custom_Twitter],
		src.[Custom_YouTube],
		src.[Custom_Minimum Age],
		src.[Custom_Maximum Age],
		GETDATE(),
		src.ORG_LEVEL_1,
		src.ORG_DESCRIPTION,
		src.LOCATION_NAME,
		src.LOCATION_DESCRIPTION,
		src.SERVICE_NAME_LEVEL_1,
		src.SERVICE_NAME_LEVEL_2,
		src.DESCRIPTION,
		'SERVICE',
		src.DELETION_DATE
	)
OPTION (ROBUST PLAN)
	;

MERGE INTO dbo.CIC_iCarolImportRollup dst
USING (
SELECT 
		(
			SELECT MAX(SYNC_DATE)
			FROM (
				(SELECT SYNC_DATE FROM ( VALUES (s.SYNC_DATE),(a.SYNC_DATE) ) AS i(SYNC_DATE)
				UNION SELECT ISNULL(irr.DELETION_DATE, irr.DATE_MODIFIED) AS SYNC_DATE
				FROM  dbo.CIC_iCarolImportRollup irr WHERE irr.ConnectsToSiteNum=s.ResourceAgencyNum AND irr.TaxonomyLevelName='ProgramAtSite'
				)
			) AS s
		) AS SYNC_DATE,
		COALESCE(s.[ResourceAgencyNum], a.[ResourceAgencyNum]) AS [ResourceAgencyNum],
		COALESCE(s.[LangID], a.[LangID]) AS [LangID],
		COALESCE(s.[PublicName], a.[PublicName]) AS [PublicName],
		COALESCE(s.[AlternateName], a.[AlternateName]) AS [AlternateName],
		COALESCE(s.[OfficialName], a.[OfficialName]) AS [OfficialName],
		COALESCE(s.[TaxonomyLevelName], a.[TaxonomyLevelName]) AS [TaxonomyLevelName],
		COALESCE(s.[ParentAgency], a.[ParentAgency]) AS [ParentAgency],
		COALESCE(s.[ParentAgencyNum], a.[ParentAgencyNum]) AS [ParentAgencyNum],
		s.[Custom_Record Owner (controlled)] AS [RECORD_OWNER],
		COALESCE(s.[UniqueIDPriorSystem], a.[UniqueIDPriorSystem]) AS [UniqueIDPriorSystem],
		COALESCE(s.[MailingAttentionName], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingAttentionName] END) AS [MailingAttentionName],
		COALESCE(s.[MailingAddress1], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingAddress1] END) AS [MailingAddress1],
		COALESCE(s.[MailingAddress2], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingAddress2] END) AS [MailingAddress2],
		COALESCE(s.[MailingCity], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingCity] END) AS [MailingCity],
		COALESCE(s.[MailingStateProvince], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingStateProvince] END) AS [MailingStateProvince],
		COALESCE(s.[MailingPostalCode], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingPostalCode] END) AS [MailingPostalCode],
		COALESCE(s.[MailingCountry], CASE WHEN a.[MailingAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[MailingCountry] END) AS [MailingCountry],
		COALESCE(s.[MailingAddressIsPrivate], a.[MailingAddressIsPrivate]) AS [MailingAddressIsPrivate],
		COALESCE(s.[PhysicalAddress1], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalAddress1] END) AS [PhysicalAddress1],
		COALESCE(s.[PhysicalAddress2], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalAddress2] END) AS [PhysicalAddress2],
		COALESCE(s.[PhysicalCity], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalCity] END) AS [PhysicalCity],
		COALESCE(s.[PhysicalCounty], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalCounty] END) AS [PhysicalCounty],
		COALESCE(s.[PhysicalStateProvince], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalStateProvince] END) AS [PhysicalStateProvince],
		COALESCE(s.[PhysicalPostalCode], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalPostalCode] END) AS [PhysicalPostalCode],
		COALESCE(s.[PhysicalCountry], CASE WHEN a.[PhysicalAddressIsPrivate] = 'Yes' THEN NULL ELSE a.[PhysicalCountry] END) AS [PhysicalCountry],
		COALESCE(s.[PhysicalAddressIsPrivate], a.[PhysicalAddressIsPrivate]) AS [PhysicalAddressIsPrivate],
		COALESCE(s.[OtherAddress1], a.[OtherAddress1]) AS [OtherAddress1],
		COALESCE(s.[OtherAddress2], a.[OtherAddress2]) AS [OtherAddress2],
		COALESCE(s.[OtherCity], a.[OtherCity]) AS [OtherCity],
		COALESCE(s.[OtherCounty], a.[OtherCounty]) AS [OtherCounty],
		COALESCE(s.[OtherStateProvince], a.[OtherStateProvince]) AS [OtherStateProvince],
		COALESCE(s.[OtherPostalCode], a.[OtherPostalCode]) AS [OtherPostalCode],
		COALESCE(s.[OtherCountry], a.[OtherCountry]) AS [OtherCountry],
		COALESCE(CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Latitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Latitude],'0') END) AS [Latitude],
		COALESCE(CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Longitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Longitude],'0') END) AS [Longitude],
		COALESCE(s.[HoursOfOperation], a.[HoursOfOperation]) AS [HoursOfOperation],
		COALESCE(s.[Phone1Number], CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Number] END) AS [Phone1Number],
		COALESCE(s.[Phone1Name], CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Name] END) AS [Phone1Name],
		COALESCE(s.[Phone1Description], CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Description] END) AS [Phone1Description],
		COALESCE(s.[Phone1IsPrivate], a.[Phone1IsPrivate]) AS [Phone1IsPrivate],
		COALESCE(s.[Phone1Type], CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Type] END) AS [Phone1Type],
		COALESCE(s.[Phone2Number], CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Number] END) AS [Phone2Number],
		COALESCE(s.[Phone2Name], CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Name] END) AS [Phone2Name],
		COALESCE(s.[Phone2Description], CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Description] END) AS [Phone2Description],
		COALESCE(s.[Phone2IsPrivate], a.[Phone2IsPrivate]) AS [Phone2IsPrivate],
		COALESCE(s.[Phone2Type], CASE WHEN a.[Phone2IsPrivate] = 'True' THEN NULL ELSE a.[Phone2Type] END) AS [Phone2Type],
		COALESCE(s.[Phone3Number], CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Number] END) AS [Phone3Number],
		COALESCE(s.[Phone3Name], CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Name] END) AS [Phone3Name],
		COALESCE(s.[Phone3Description], CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Description] END) AS [Phone3Description],
		COALESCE(s.[Phone3IsPrivate], a.[Phone3IsPrivate]) AS [Phone3IsPrivate],
		COALESCE(s.[Phone3Type], CASE WHEN a.[Phone3IsPrivate] = 'True' THEN NULL ELSE a.[Phone3Type] END) AS [Phone3Type],
		COALESCE(s.[Phone4Number], CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Number] END) AS [Phone4Number],
		COALESCE(s.[Phone4Name], CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Name] END) AS [Phone4Name],
		COALESCE(s.[Phone4Description], CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Description] END) AS [Phone4Description],
		COALESCE(s.[Phone4IsPrivate], a.[Phone4IsPrivate]) AS [Phone4IsPrivate],
		COALESCE(s.[Phone4Type], CASE WHEN a.[Phone4IsPrivate] = 'True' THEN NULL ELSE a.[Phone4Type] END) AS [Phone4Type],
		COALESCE(s.[Phone5Number], CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5Number] END) AS [Phone5Number],
		COALESCE(s.[Phone5name], CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5name] END) AS [Phone5name],
		COALESCE(s.[Phone5Description], CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5Description] END) AS [Phone5Description],
		COALESCE(s.[Phone5IsPrivate], a.[Phone5IsPrivate]) AS [Phone5IsPrivate],
		COALESCE(s.[Phone5Type], CASE WHEN a.[Phone5IsPrivate] = 'True' THEN NULL ELSE a.[Phone5Type] END) AS [Phone5Type],
		COALESCE(s.[PhoneFax], CASE WHEN a.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE a.[PhoneFax] END) AS [PhoneFax],
		COALESCE(s.[PhoneFaxDescription], CASE WHEN a.[PhoneFaxIsPrivate] = 'True' THEN NULL ELSE a.[PhoneFaxDescription] END) AS [PhoneFaxDescription],
		COALESCE(s.[PhoneFaxIsPrivate], a.[PhoneFaxIsPrivate]) AS [PhoneFaxIsPrivate],
		COALESCE(s.[PhoneTTY], CASE WHEN a.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTTY] END) AS [PhoneTTY],
		COALESCE(s.[PhoneTTYDescription], CASE WHEN a.[PhoneTTYIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTTYDescription] END) AS [PhoneTTYDescription],
		COALESCE(s.[PhoneTTYIsPrivate], a.[PhoneTTYIsPrivate]) AS [PhoneTTYIsPrivate],
		COALESCE(s.[PhoneTollFree], CASE WHEN a.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTollFree] END) AS [PhoneTollFree],
		COALESCE(s.[PhoneTollFreeDescription], CASE WHEN a.[PhoneTollFreeIsPrivate] = 'True' THEN NULL ELSE a.[PhoneTollFreeDescription] END) AS [PhoneTollFreeDescription],
		COALESCE(s.[PhoneTollFreeIsPrivate], a.[PhoneTollFreeIsPrivate]) AS [PhoneTollFreeIsPrivate],
		COALESCE(s.[PhoneNumberHotline], CASE WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberHotline] END) AS [PhoneNumberHotline],
		COALESCE(s.[PhoneNumberHotlineDescription], CASE WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberHotlineDescription] END) AS [PhoneNumberHotlineDescription],
		COALESCE(s.[PhoneNumberHotlineIsPrivate], a.[PhoneNumberHotlineIsPrivate]) AS [PhoneNumberHotlineIsPrivate],
		COALESCE(s.[PhoneNumberBusinessLine], CASE WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberBusinessLine] END) AS [PhoneNumberBusinessLine],
		COALESCE(s.[PhoneNumberBusinessLineDescription], CASE WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberBusinessLineDescription] END) AS [PhoneNumberBusinessLineDescription],
		COALESCE(s.[PhoneNumberBusinessLineIsPrivate], a.[PhoneNumberBusinessLineIsPrivate]) AS [PhoneNumberBusinessLineIsPrivate],
		COALESCE(s.[PhoneNumberOutOfArea], CASE WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberOutOfArea] END) AS [PhoneNumberOutOfArea],
		COALESCE(s.[PhoneNumberOutOfAreaDescription], CASE WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberOutOfAreaDescription] END) AS [PhoneNumberOutOfAreaDescription],
		COALESCE(s.[PhoneNumberOutOfAreaIsPrivate], a.[PhoneNumberOutOfAreaIsPrivate]) AS [PhoneNumberOutOfAreaIsPrivate],
		COALESCE(s.[PhoneNumberAfterHours], CASE WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberAfterHours] END) AS [PhoneNumberAfterHours],
		COALESCE(s.[PhoneNumberAfterHoursDescription], CASE WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' THEN NULL ELSE a.[PhoneNumberAfterHoursDescription] END) AS [PhoneNumberAfterHoursDescription],
		COALESCE(s.[PhoneNumberAfterHoursIsPrivate], a.[PhoneNumberAfterHoursIsPrivate]) AS [PhoneNumberAfterHoursIsPrivate],
		COALESCE(s.[EmailAddressMain], a.[EmailAddressMain]) AS [EmailAddressMain],
		COALESCE(s.[WebsiteAddress], a.[WebsiteAddress]) AS [WebsiteAddress],
		COALESCE(s.[AgencyStatus], a.[AgencyStatus]) AS [AgencyStatus],
		COALESCE(s.[AgencyClassification], a.[AgencyClassification]) AS [AgencyClassification],
		COALESCE(s.[CoverageArea], a.[CoverageArea]) AS [CoverageArea],
		COALESCE(s.[CoverageAreaText], a.[CoverageAreaText]) AS [CoverageAreaText],
		COALESCE(s.[Eligibility], a.[Eligibility]) AS [Eligibility],
		COALESCE(s.[EligibilityAdult], a.[EligibilityAdult]) AS [EligibilityAdult],
		COALESCE(s.[EligibilityChild], a.[EligibilityChild]) AS [EligibilityChild],
		COALESCE(s.[EligibilityFamily], a.[EligibilityFamily]) AS [EligibilityFamily],
		COALESCE(s.[EligibilityFemale], a.[EligibilityFemale]) AS [EligibilityFemale],
		COALESCE(s.[EligibilityMale], a.[EligibilityMale]) AS [EligibilityMale],
		COALESCE(s.[EligibilityTeen], a.[EligibilityTeen]) AS [EligibilityTeen],
		COALESCE(s.[SeniorWorkerName], CASE WHEN a.[SeniorWorkerIsPrivate] = 'Yes' THEN NULL ELSE a.[SeniorWorkerName] END) AS [SeniorWorkerName],
		COALESCE(s.[SeniorWorkerTitle], CASE WHEN a.[SeniorWorkerIsPrivate] = 'Yes' THEN NULL ELSE a.[SeniorWorkerTitle] END) AS [SeniorWorkerTitle],
		COALESCE(s.[SeniorWorkerEmailAddress], CASE WHEN a.[SeniorWorkerIsPrivate] = 'Yes' THEN NULL ELSE a.[SeniorWorkerEmailAddress] END) AS [SeniorWorkerEmailAddress],
		COALESCE(s.[SeniorWorkerPhoneNumber], CASE WHEN a.[SeniorWorkerIsPrivate] = 'Yes' THEN NULL ELSE a.[SeniorWorkerPhoneNumber] END) AS [SeniorWorkerPhoneNumber],
		COALESCE(s.[SeniorWorkerIsPrivate], a.[SeniorWorkerIsPrivate]) AS [SeniorWorkerIsPrivate],
		COALESCE(s.[MainContactName], CASE WHEN a.[MainContactIsPrivate] = 'Yes' THEN NULL ELSE a.[MainContactName] END) AS [MainContactName],
		COALESCE(s.[MainContactTitle], CASE WHEN a.[MainContactIsPrivate] = 'Yes' THEN NULL ELSE a.[MainContactTitle] END) AS [MainContactTitle],
		COALESCE(s.[MainContactEmailAddress], CASE WHEN a.[MainContactIsPrivate] = 'Yes' THEN NULL ELSE a.[MainContactEmailAddress] END) AS [MainContactEmailAddress],
		COALESCE(s.[MainContactPhoneNumber], CASE WHEN a.[MainContactIsPrivate] = 'Yes' THEN NULL ELSE a.[MainContactPhoneNumber] END) AS [MainContactPhoneNumber],
		COALESCE(s.[MainContactType], CASE WHEN a.[MainContactIsPrivate] = 'Yes' THEN NULL ELSE a.[MainContactType] END) AS [MainContactType],
		COALESCE(s.[MainContactIsPrivate], a.[MainContactIsPrivate]) AS [MainContactIsPrivate],
		COALESCE(s.[LicenseAccreditation], a.[LicenseAccreditation]) AS [LicenseAccreditation],
		COALESCE(s.[YearIncorporated], a.[YearIncorporated]) AS [YearIncorporated],
		COALESCE(s.[AnnualBudgetTotal], a.[AnnualBudgetTotal]) AS [AnnualBudgetTotal],
		COALESCE(s.[LegalStatus], a.[LegalStatus]) AS [LegalStatus],
		COALESCE(s.[SourceOfFunds], a.[SourceOfFunds]) AS [SourceOfFunds],
		COALESCE(s.[ExcludeFromWebsite], a.[ExcludeFromWebsite]) AS [ExcludeFromWebsite],
		COALESCE(s.[ExcludeFromDirectory], a.[ExcludeFromDirectory]) AS [ExcludeFromDirectory],
		COALESCE(s.[DisabilitiesAccess], a.[DisabilitiesAccess]) AS [DisabilitiesAccess],
		COALESCE(s.[PhysicalLocationDescription], a.[PhysicalLocationDescription]) AS [PhysicalLocationDescription],
		COALESCE(s.[BusServiceAccess], a.[BusServiceAccess]) AS [BusServiceAccess],
		COALESCE(s.[PublicAccessTransportation], a.[PublicAccessTransportation]) AS [PublicAccessTransportation],
		COALESCE(s.[PaymentMethods], a.[PaymentMethods]) AS [PaymentMethods],
		COALESCE(s.[FeeStructureSource], a.[FeeStructureSource]) AS [FeeStructureSource],
		COALESCE(s.[ApplicationProcess], a.[ApplicationProcess]) AS [ApplicationProcess],
		COALESCE(s.[ResourceInfo], a.[ResourceInfo]) AS [ResourceInfo],
		COALESCE(s.[DocumentsRequired], a.[DocumentsRequired]) AS [DocumentsRequired],
		COALESCE(s.[LanguagesOffered], a.[LanguagesOffered]) AS [LanguagesOffered],
		COALESCE(s.[LanguagesOfferedList], a.[LanguagesOfferedList]) AS [LanguagesOfferedList],
		COALESCE(s.[AvailabilityNumberOfTimes], a.[AvailabilityNumberOfTimes]) AS [AvailabilityNumberOfTimes],
		COALESCE(s.[AvailabilityFrequency], a.[AvailabilityFrequency]) AS [AvailabilityFrequency],
		COALESCE(s.[AvailabilityPeriod], a.[AvailabilityPeriod]) AS [AvailabilityPeriod],
		COALESCE(s.[ServiceNotAlwaysAvailability], a.[ServiceNotAlwaysAvailability]) AS [ServiceNotAlwaysAvailability],
		COALESCE(s.[CapacityType], a.[CapacityType]) AS [CapacityType],
		COALESCE(s.[ServiceCapacity], a.[ServiceCapacity]) AS [ServiceCapacity],
		COALESCE(s.[NormalWaitTime], a.[NormalWaitTime]) AS [NormalWaitTime],
		COALESCE(s.[TemporaryMessage], a.[TemporaryMessage]) AS [TemporaryMessage],
		COALESCE(s.[TemporaryMessageAppears], a.[TemporaryMessageAppears]) AS [TemporaryMessageAppears],
		COALESCE(s.[TemporaryMessageExpires], a.[TemporaryMessageExpires]) AS [TemporaryMessageExpires],
		COALESCE(s.[EnteredOn], a.[EnteredOn]) AS [EnteredOn],
		COALESCE(s.[UpdatedOn], a.[UpdatedOn]) AS [UpdatedOn],
		COALESCE(s.[MadeInactiveOn], a.[MadeInactiveOn]) AS [MadeInactiveOn],
		s.[InternalNotes] AS [InternalNotes],
		s.[InternalNotesForEditorsAndViewers] AS [InternalNotesForEditorsAndViewers],
		COALESCE(s.[HighlightedResource], a.[HighlightedResource]) AS [HighlightedResource],
		COALESCE(s.[LastVerifiedOn], a.[LastVerifiedOn]) AS [LastVerifiedOn],
		COALESCE(s.[LastVerifiedByName], a.[LastVerifiedByName]) AS [LastVerifiedByName],
		COALESCE(s.[LastVerifiedByTitle], a.[LastVerifiedByTitle]) AS [LastVerifiedByTitle],
		COALESCE(s.[LastVerifiedByPhoneNumber], a.[LastVerifiedByPhoneNumber]) AS [LastVerifiedByPhoneNumber],
		COALESCE(s.[LastVerifiedByEmailAddress], a.[LastVerifiedByEmailAddress]) AS [LastVerifiedByEmailAddress],
		COALESCE(s.[LastVerificationApprovedBy], a.[LastVerificationApprovedBy]) AS [LastVerificationApprovedBy],
		COALESCE(s.[AvailableForDirectory], a.[AvailableForDirectory]) AS [AvailableForDirectory],
		COALESCE(s.[AvailableForReferral], a.[AvailableForReferral]) AS [AvailableForReferral],
		COALESCE(s.[AvailableForResearch], a.[AvailableForResearch]) AS [AvailableForResearch],
		COALESCE(s.[PreferredProvider], a.[PreferredProvider]) AS [PreferredProvider],
		COALESCE(s.[ConnectsToSiteNum], a.[ConnectsToSiteNum]) AS [ConnectsToSiteNum],
		COALESCE(s.[ConnectsToProgramNum], a.[ConnectsToProgramNum]) AS [ConnectsToProgramNum],
		COALESCE(s.[LanguageOfRecord], a.[LanguageOfRecord]) AS [LanguageOfRecord],
		COALESCE(s.[CurrentWorkflowStepCode], a.[CurrentWorkflowStepCode]) AS [CurrentWorkflowStepCode],
		COALESCE(s.[VolunteerOpportunities], a.[VolunteerOpportunities]) AS [VolunteerOpportunities],
		COALESCE(s.[VolunteerDuties], a.[VolunteerDuties]) AS [VolunteerDuties],
		COALESCE(s.[IsLinkOnly], a.[IsLinkOnly]) AS [IsLinkOnly],
		COALESCE(s.[ProgramAgencyNamePublic], a.[ProgramAgencyNamePublic]) AS [ProgramAgencyNamePublic],
		COALESCE(s.[SiteAgencyNamePublic], a.[SiteAgencyNamePublic]) AS [SiteAgencyNamePublic],
		COALESCE(s.[Categories], a.[Categories]) AS [Categories],
		COALESCE(s.[TaxonomyTerm], a.[TaxonomyTerm]) AS [TaxonomyTerm],
		COALESCE(s.[TaxonomyTerms], a.[TaxonomyTerms]) AS [TaxonomyTerms],
		COALESCE(s.[TaxonomyTermsNotDeactivated], a.[TaxonomyTermsNotDeactivated]) AS [TaxonomyTermsNotDeactivated],
		COALESCE(s.[TaxonomyCodes], a.[TaxonomyCodes]) AS [TaxonomyCodes],
		COALESCE(s.[Coverage], a.[Coverage]) AS [Coverage],
		COALESCE(s.[Hours], a.[Hours]) AS [Hours],
		s.[Custom_Public Comments] AS [Custom_Public Comments],
		COALESCE(s.[Custom_Former Names], a.[Custom_Former Names]) AS [Custom_Former Names],
		COALESCE(s.[Custom_Legal Name], a.[Custom_Legal Name]) AS [Custom_Legal Name],
		COALESCE(s.[Custom_Facebook], a.[Custom_Facebook]) AS [Custom_Facebook],
		COALESCE(s.[Custom_Instagram], a.[Custom_Instagram]) AS [Custom_Instagram],
		COALESCE(s.[Custom_LinkedIn], a.[Custom_LinkedIn]) AS [Custom_LinkedIn],
		COALESCE(s.[Custom_Twitter], a.[Custom_Twitter]) AS [Custom_Twitter],
		COALESCE(s.[Custom_YouTube], a.[Custom_YouTube]) AS [Custom_YouTube],
		COALESCE(s.[Custom_Minimum Age], a.[Custom_Minimum Age]) AS [Custom_Minimum Age],
		COALESCE(s.[Custom_Maximum Age], a.[Custom_Maximum Age]) AS [Custom_Maximum Age],
		a.PublicName AS ORG_LEVEL_1,
		a.AgencyDescription AS ORG_DESCRIPTION,
		s.PublicName AS LOCATION_NAME,
		s.AgencyDescription AS LOCATION_DESCRIPTION,
		s.DELETION_DATE
FROM dbo.CIC_iCarolImport AS s
LEFT JOIN dbo.CIC_iCarolImport a
	ON s.ParentAgencyNum=a.ResourceAgencyNum AND a.TaxonomyLevelName='Agency' AND a.LangID=s.LangID
WHERE s.TaxonomyLevelName='Site'
) AS src
ON src.ResourceAgencyNum=dst.ResourceAgencyNum AND src.LangID=dst.LangID AND src.TaxonomyLevelName = 'Site'
WHEN MATCHED AND src.SYNC_DATE > dst.DATE_MODIFIED THEN 
	UPDATE SET 
		[PublicName]=src.[PublicName],
		[AlternateName]=src.[AlternateName],
		[OfficialName]=src.[OfficialName],
		[TaxonomyLevelName]=src.[TaxonomyLevelName],
		[ParentAgency]=src.[ParentAgency],
		[ParentAgencyNum]=src.[ParentAgencyNum],
		[RECORD_OWNER]=src.[RECORD_OWNER],
		[UniqueIDPriorSystem]=src.[UniqueIDPriorSystem],
		[MailingAttentionName]=src.[MailingAttentionName],
		[MailingAddress1]=src.[MailingAddress1],
		[MailingAddress2]=src.[MailingAddress2],
		[MailingCity]=src.[MailingCity],
		[MailingStateProvince]=src.[MailingStateProvince],
		[MailingPostalCode]=src.[MailingPostalCode],
		[MailingCountry]=src.[MailingCountry],
		[MailingAddressIsPrivate]=src.[MailingAddressIsPrivate],
		[PhysicalAddress1]=src.[PhysicalAddress1],
		[PhysicalAddress2]=src.[PhysicalAddress2],
		[PhysicalCity]=src.[PhysicalCity],
		[PhysicalCounty]=src.[PhysicalCounty],
		[PhysicalStateProvince]=src.[PhysicalStateProvince],
		[PhysicalPostalCode]=src.[PhysicalPostalCode],
		[PhysicalCountry]=src.[PhysicalCountry],
		[PhysicalAddressIsPrivate]=src.[PhysicalAddressIsPrivate],
		[OtherAddress1]=src.[OtherAddress1],
		[OtherAddress2]=src.[OtherAddress2],
		[OtherCity]=src.[OtherCity],
		[OtherCounty]=src.[OtherCounty],
		[OtherStateProvince]=src.[OtherStateProvince],
		[OtherPostalCode]=src.[OtherPostalCode],
		[OtherCountry]=src.[OtherCountry],
		[Latitude]=src.[Latitude],
		[Longitude]=src.[Longitude],
		[HoursOfOperation]=src.[HoursOfOperation],
		[Phone1Number]=src.[Phone1Number],
		[Phone1Name]=src.[Phone1Name],
		[Phone1Description]=src.[Phone1Description],
		[Phone1IsPrivate]=src.[Phone1IsPrivate],
		[Phone1Type]=src.[Phone1Type],
		[Phone2Number]=src.[Phone2Number],
		[Phone2Name]=src.[Phone2Name],
		[Phone2Description]=src.[Phone2Description],
		[Phone2IsPrivate]=src.[Phone2IsPrivate],
		[Phone2Type]=src.[Phone2Type],
		[Phone3Number]=src.[Phone3Number],
		[Phone3Name]=src.[Phone3Name],
		[Phone3Description]=src.[Phone3Description],
		[Phone3IsPrivate]=src.[Phone3IsPrivate],
		[Phone3Type]=src.[Phone3Type],
		[Phone4Number]=src.[Phone4Number],
		[Phone4Name]=src.[Phone4Name],
		[Phone4Description]=src.[Phone4Description],
		[Phone4IsPrivate]=src.[Phone4IsPrivate],
		[Phone4Type]=src.[Phone4Type],
		[Phone5Number]=src.[Phone5Number],
		[Phone5name]=src.[Phone5name],
		[Phone5Description]=src.[Phone5Description],
		[Phone5IsPrivate]=src.[Phone5IsPrivate],
		[Phone5Type]=src.[Phone5Type],
		[PhoneFax]=src.[PhoneFax],
		[PhoneFaxDescription]=src.[PhoneFaxDescription],
		[PhoneFaxIsPrivate]=src.[PhoneFaxIsPrivate],
		[PhoneTTY]=src.[PhoneTTY],
		[PhoneTTYDescription]=src.[PhoneTTYDescription],
		[PhoneTTYIsPrivate]=src.[PhoneTTYIsPrivate],
		[PhoneTollFree]=src.[PhoneTollFree],
		[PhoneTollFreeDescription]=src.[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate]=src.[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline]=src.[PhoneNumberHotline],
		[PhoneNumberHotlineDescription]=src.[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate]=src.[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine]=src.[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription]=src.[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate]=src.[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea]=src.[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription]=src.[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate]=src.[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours]=src.[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription]=src.[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate]=src.[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain]=src.[EmailAddressMain],
		[WebsiteAddress]=src.[WebsiteAddress],
		[AgencyStatus]=src.[AgencyStatus],
		[AgencyClassification]=src.[AgencyClassification],
		[CoverageArea]=src.[CoverageArea],
		[CoverageAreaText]=src.[CoverageAreaText],
		[Eligibility]=src.[Eligibility],
		[EligibilityAdult]=src.[EligibilityAdult],
		[EligibilityChild]=src.[EligibilityChild],
		[EligibilityFamily]=src.[EligibilityFamily],
		[EligibilityFemale]=src.[EligibilityFemale],
		[EligibilityMale]=src.[EligibilityMale],
		[EligibilityTeen]=src.[EligibilityTeen],
		[SeniorWorkerName]=src.[SeniorWorkerName],
		[SeniorWorkerTitle]=src.[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress]=src.[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber]=src.[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate]=src.[SeniorWorkerIsPrivate],
		[MainContactName]=src.[MainContactName],
		[MainContactTitle]=src.[MainContactTitle],
		[MainContactEmailAddress]=src.[MainContactEmailAddress],
		[MainContactPhoneNumber]=src.[MainContactPhoneNumber],
		[MainContactType]=src.[MainContactType],
		[MainContactIsPrivate]=src.[MainContactIsPrivate],
		[LicenseAccreditation]=src.[LicenseAccreditation],
		[YearIncorporated]=src.[YearIncorporated],
		[AnnualBudgetTotal]=src.[AnnualBudgetTotal],
		[LegalStatus]=src.[LegalStatus],
		[SourceOfFunds]=src.[SourceOfFunds],
		[ExcludeFromWebsite]=src.[ExcludeFromWebsite],
		[ExcludeFromDirectory]=src.[ExcludeFromDirectory],
		[DisabilitiesAccess]=src.[DisabilitiesAccess],
		[PhysicalLocationDescription]=src.[PhysicalLocationDescription],
		[BusServiceAccess]=src.[BusServiceAccess],
		[PublicAccessTransportation]=src.[PublicAccessTransportation],
		[PaymentMethods]=src.[PaymentMethods],
		[FeeStructureSource]=src.[FeeStructureSource],
		[ApplicationProcess]=src.[ApplicationProcess],
		[ResourceInfo]=src.[ResourceInfo],
		[DocumentsRequired]=src.[DocumentsRequired],
		[LanguagesOffered]=src.[LanguagesOffered],
		[LanguagesOfferedList]=src.[LanguagesOfferedList],
		[AvailabilityNumberOfTimes]=src.[AvailabilityNumberOfTimes],
		[AvailabilityFrequency]=src.[AvailabilityFrequency],
		[AvailabilityPeriod]=src.[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability]=src.[ServiceNotAlwaysAvailability],
		[CapacityType]=src.[CapacityType],
		[ServiceCapacity]=src.[ServiceCapacity],
		[NormalWaitTime]=src.[NormalWaitTime],
		[TemporaryMessage]=src.[TemporaryMessage],
		[TemporaryMessageAppears]=src.[TemporaryMessageAppears],
		[TemporaryMessageExpires]=src.[TemporaryMessageExpires],
		[EnteredOn]=src.[EnteredOn],
		[UpdatedOn]=src.[UpdatedOn],
		[MadeInactiveOn]=src.[MadeInactiveOn],
		[InternalNotes]=src.[InternalNotes],
		[InternalNotesForEditorsAndViewers]=src.[InternalNotesForEditorsAndViewers],
		[HighlightedResource]=src.[HighlightedResource],
		[LastVerifiedOn]=src.[LastVerifiedOn],
		[LastVerifiedByName]=src.[LastVerifiedByName],
		[LastVerifiedByTitle]=src.[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber]=src.[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress]=src.[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy]=src.[LastVerificationApprovedBy],
		[AvailableForDirectory]=src.[AvailableForDirectory],
		[AvailableForReferral]=src.[AvailableForReferral],
		[AvailableForResearch]=src.[AvailableForResearch],
		[PreferredProvider]=src.[PreferredProvider],
		[ConnectsToSiteNum]=src.[ConnectsToSiteNum],
		[ConnectsToProgramNum]=src.[ConnectsToProgramNum],
		[LanguageOfRecord]=src.[LanguageOfRecord],
		[CurrentWorkflowStepCode]=src.[CurrentWorkflowStepCode],
		[VolunteerOpportunities]=src.[VolunteerOpportunities],
		[VolunteerDuties]=src.[VolunteerDuties],
		[IsLinkOnly]=src.[IsLinkOnly],
		[ProgramAgencyNamePublic]=src.[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic]=src.[SiteAgencyNamePublic],
		[Categories]=src.[Categories],
		[TaxonomyTerm]=src.[TaxonomyTerm],
		[TaxonomyTerms]=src.[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated]=src.[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes]=src.[TaxonomyCodes],
		[Coverage]=src.[Coverage],
		[Hours]=src.[Hours],
		[Custom_Public Comments]=src.[Custom_Public Comments],
		[Custom_Former Names]=src.[Custom_Former Names],
		[Custom_Legal Name]=src.[Custom_Legal Name],
		[Custom_Facebook]=src.[Custom_Facebook],
		[Custom_Instagram]=src.[Custom_Instagram],
		[Custom_LinkedIn]=src.[Custom_LinkedIn],
		[Custom_Twitter]=src.[Custom_Twitter],
		[Custom_YouTube]=src.[Custom_YouTube],
		[Custom_Minimum Age]=src.[Custom_Minimum Age],
		[Custom_Maximum Age]=src.[Custom_Maximum Age],
		[dst].[DATE_MODIFIED]=GETDATE(),
		ORG_LEVEL_1=src.ORG_LEVEL_1,
		ORG_DESCRIPTION=src.ORG_DESCRIPTION,
		LOCATION_NAME=src.LOCATION_NAME,
		LOCATION_DESCRIPTION=src.LOCATION_DESCRIPTION,
		dst.ORG_LOCATION_SERVICE='SITE',
		dst.DELETION_DATE=src.DELETION_DATE
WHEN NOT MATCHED BY TARGET AND src.TaxonomyLevelName='Site' THEN
	INSERT (
		[ResourceAgencyNum],
		[LangID],
		[PublicName],
		[AlternateName],
		[OfficialName],
		[TaxonomyLevelName],
		[ParentAgency],
		[ParentAgencyNum],
		[RECORD_OWNER],
		[UniqueIDPriorSystem],
		[MailingAttentionName],
		[MailingAddress1],
		[MailingAddress2],
		[MailingCity],
		[MailingStateProvince],
		[MailingPostalCode],
		[MailingCountry],
		[MailingAddressIsPrivate],
		[PhysicalAddress1],
		[PhysicalAddress2],
		[PhysicalCity],
		[PhysicalCounty],
		[PhysicalStateProvince],
		[PhysicalPostalCode],
		[PhysicalCountry],
		[PhysicalAddressIsPrivate],
		[OtherAddress1],
		[OtherAddress2],
		[OtherCity],
		[OtherCounty],
		[OtherStateProvince],
		[OtherPostalCode],
		[OtherCountry],
		[Latitude],
		[Longitude],
		[HoursOfOperation],
		[Phone1Number],
		[Phone1Name],
		[Phone1Description],
		[Phone1IsPrivate],
		[Phone1Type],
		[Phone2Number],
		[Phone2Name],
		[Phone2Description],
		[Phone2IsPrivate],
		[Phone2Type],
		[Phone3Number],
		[Phone3Name],
		[Phone3Description],
		[Phone3IsPrivate],
		[Phone3Type],
		[Phone4Number],
		[Phone4Name],
		[Phone4Description],
		[Phone4IsPrivate],
		[Phone4Type],
		[Phone5Number],
		[Phone5name],
		[Phone5Description],
		[Phone5IsPrivate],
		[Phone5Type],
		[PhoneFax],
		[PhoneFaxDescription],
		[PhoneFaxIsPrivate],
		[PhoneTTY],
		[PhoneTTYDescription],
		[PhoneTTYIsPrivate],
		[PhoneTollFree],
		[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline],
		[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain],
		[WebsiteAddress],
		[AgencyStatus],
		[AgencyClassification],
		[CoverageArea],
		[CoverageAreaText],
		[Eligibility],
		[EligibilityAdult],
		[EligibilityChild],
		[EligibilityFamily],
		[EligibilityFemale],
		[EligibilityMale],
		[EligibilityTeen],
		[SeniorWorkerName],
		[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate],
		[MainContactName],
		[MainContactTitle],
		[MainContactEmailAddress],
		[MainContactPhoneNumber],
		[MainContactType],
		[MainContactIsPrivate],
		[LicenseAccreditation],
		[YearIncorporated],
		[AnnualBudgetTotal],
		[LegalStatus],
		[SourceOfFunds],
		[ExcludeFromWebsite],
		[ExcludeFromDirectory],
		[DisabilitiesAccess],
		[PhysicalLocationDescription],
		[BusServiceAccess],
		[PublicAccessTransportation],
		[PaymentMethods],
		[FeeStructureSource],
		[ApplicationProcess],
		[ResourceInfo],
		[DocumentsRequired],
		[LanguagesOffered],
		[LanguagesOfferedList],
		[AvailabilityNumberOfTimes],
		[AvailabilityFrequency],
		[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability],
		[CapacityType],
		[ServiceCapacity],
		[NormalWaitTime],
		[TemporaryMessage],
		[TemporaryMessageAppears],
		[TemporaryMessageExpires],
		[EnteredOn],
		[UpdatedOn],
		[MadeInactiveOn],
		[InternalNotes],
		[InternalNotesForEditorsAndViewers],
		[HighlightedResource],
		[LastVerifiedOn],
		[LastVerifiedByName],
		[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy],
		[AvailableForDirectory],
		[AvailableForReferral],
		[AvailableForResearch],
		[PreferredProvider],
		[ConnectsToSiteNum],
		[ConnectsToProgramNum],
		[LanguageOfRecord],
		[CurrentWorkflowStepCode],
		[VolunteerOpportunities],
		[VolunteerDuties],
		[IsLinkOnly],
		[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic],
		[Categories],
		[TaxonomyTerm],
		[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes],
		[Coverage],
		[Hours],
		[Custom_Public Comments],
		[Custom_Former Names],
		[Custom_Legal Name],
		[Custom_Facebook],
		[Custom_Instagram],
		[Custom_LinkedIn],
		[Custom_Twitter],
		[Custom_YouTube],
		[Custom_Minimum Age],
		[Custom_Maximum Age],
		[DATE_MODIFIED],
		ORG_LEVEL_1,
		ORG_DESCRIPTION,
		LOCATION_NAME,
		LOCATION_DESCRIPTION,
		ORG_LOCATION_SERVICE,
		DELETION_DATE
	) VALUES (
		src.[ResourceAgencyNum],
		src.LangID,
		src.[PublicName],
		src.[AlternateName],
		src.[OfficialName],
		src.[TaxonomyLevelName],
		src.[ParentAgency],
		src.[ParentAgencyNum],
		src.[RECORD_OWNER],
		src.[UniqueIDPriorSystem],
		src.[MailingAttentionName],
		src.[MailingAddress1],
		src.[MailingAddress2],
		src.[MailingCity],
		src.[MailingStateProvince],
		src.[MailingPostalCode],
		src.[MailingCountry],
		src.[MailingAddressIsPrivate],
		src.[PhysicalAddress1],
		src.[PhysicalAddress2],
		src.[PhysicalCity],
		src.[PhysicalCounty],
		src.[PhysicalStateProvince],
		src.[PhysicalPostalCode],
		src.[PhysicalCountry],
		src.[PhysicalAddressIsPrivate],
		src.[OtherAddress1],
		src.[OtherAddress2],
		src.[OtherCity],
		src.[OtherCounty],
		src.[OtherStateProvince],
		src.[OtherPostalCode],
		src.[OtherCountry],
		src.[Latitude],
		src.[Longitude],
		src.[HoursOfOperation],
		src.[Phone1Number],
		src.[Phone1Name],
		src.[Phone1Description],
		src.[Phone1IsPrivate],
		src.[Phone1Type],
		src.[Phone2Number],
		src.[Phone2Name],
		src.[Phone2Description],
		src.[Phone2IsPrivate],
		src.[Phone2Type],
		src.[Phone3Number],
		src.[Phone3Name],
		src.[Phone3Description],
		src.[Phone3IsPrivate],
		src.[Phone3Type],
		src.[Phone4Number],
		src.[Phone4Name],
		src.[Phone4Description],
		src.[Phone4IsPrivate],
		src.[Phone4Type],
		src.[Phone5Number],
		src.[Phone5name],
		src.[Phone5Description],
		src.[Phone5IsPrivate],
		src.[Phone5Type],
		src.[PhoneFax],
		src.[PhoneFaxDescription],
		src.[PhoneFaxIsPrivate],
		src.[PhoneTTY],
		src.[PhoneTTYDescription],
		src.[PhoneTTYIsPrivate],
		src.[PhoneTollFree],
		src.[PhoneTollFreeDescription],
		src.[PhoneTollFreeIsPrivate],
		src.[PhoneNumberHotline],
		src.[PhoneNumberHotlineDescription],
		src.[PhoneNumberHotlineIsPrivate],
		src.[PhoneNumberBusinessLine],
		src.[PhoneNumberBusinessLineDescription],
		src.[PhoneNumberBusinessLineIsPrivate],
		src.[PhoneNumberOutOfArea],
		src.[PhoneNumberOutOfAreaDescription],
		src.[PhoneNumberOutOfAreaIsPrivate],
		src.[PhoneNumberAfterHours],
		src.[PhoneNumberAfterHoursDescription],
		src.[PhoneNumberAfterHoursIsPrivate],
		src.[EmailAddressMain],
		src.[WebsiteAddress],
		src.[AgencyStatus],
		src.[AgencyClassification],
		src.[CoverageArea],
		src.[CoverageAreaText],
		src.[Eligibility],
		src.[EligibilityAdult],
		src.[EligibilityChild],
		src.[EligibilityFamily],
		src.[EligibilityFemale],
		src.[EligibilityMale],
		src.[EligibilityTeen],
		src.[SeniorWorkerName],
		src.[SeniorWorkerTitle],
		src.[SeniorWorkerEmailAddress],
		src.[SeniorWorkerPhoneNumber],
		src.[SeniorWorkerIsPrivate],
		src.[MainContactName],
		src.[MainContactTitle],
		src.[MainContactEmailAddress],
		src.[MainContactPhoneNumber],
		src.[MainContactType],
		src.[MainContactIsPrivate],
		src.[LicenseAccreditation],
		src.[YearIncorporated],
		src.[AnnualBudgetTotal],
		src.[LegalStatus],
		src.[SourceOfFunds],
		src.[ExcludeFromWebsite],
		src.[ExcludeFromDirectory],
		src.[DisabilitiesAccess],
		src.[PhysicalLocationDescription],
		src.[BusServiceAccess],
		src.[PublicAccessTransportation],
		src.[PaymentMethods],
		src.[FeeStructureSource],
		src.[ApplicationProcess],
		src.[ResourceInfo],
		src.[DocumentsRequired],
		src.[LanguagesOffered],
		src.[LanguagesOfferedList],
		src.[AvailabilityNumberOfTimes],
		src.[AvailabilityFrequency],
		src.[AvailabilityPeriod],
		src.[ServiceNotAlwaysAvailability],
		src.[CapacityType],
		src.[ServiceCapacity],
		src.[NormalWaitTime],
		src.[TemporaryMessage],
		src.[TemporaryMessageAppears],
		src.[TemporaryMessageExpires],
		src.[EnteredOn],
		src.[UpdatedOn],
		src.[MadeInactiveOn],
		src.[InternalNotes],
		src.[InternalNotesForEditorsAndViewers],
		src.[HighlightedResource],
		src.[LastVerifiedOn],
		src.[LastVerifiedByName],
		src.[LastVerifiedByTitle],
		src.[LastVerifiedByPhoneNumber],
		src.[LastVerifiedByEmailAddress],
		src.[LastVerificationApprovedBy],
		src.[AvailableForDirectory],
		src.[AvailableForReferral],
		src.[AvailableForResearch],
		src.[PreferredProvider],
		src.[ConnectsToSiteNum],
		src.[ConnectsToProgramNum],
		src.[LanguageOfRecord],
		src.[CurrentWorkflowStepCode],
		src.[VolunteerOpportunities],
		src.[VolunteerDuties],
		src.[IsLinkOnly],
		src.[ProgramAgencyNamePublic],
		src.[SiteAgencyNamePublic],
		src.[Categories],
		src.[TaxonomyTerm],
		src.[TaxonomyTerms],
		src.[TaxonomyTermsNotDeactivated],
		src.[TaxonomyCodes],
		src.[Coverage],
		src.[Hours],
		src.[Custom_Public Comments],
		src.[Custom_Former Names],
		src.[Custom_Legal Name],
		src.[Custom_Facebook],
		src.[Custom_Instagram],
		src.[Custom_LinkedIn],
		src.[Custom_Twitter],
		src.[Custom_YouTube],
		src.[Custom_Minimum Age],
		src.[Custom_Maximum Age],
		GETDATE(),
		src.ORG_LEVEL_1,
		src.ORG_DESCRIPTION,
		src.LOCATION_NAME,
		src.LOCATION_DESCRIPTION,
		'SITE',
		src.DELETION_DATE
	)
OPTION (ROBUST PLAN)
	;

SELECT m.MemberID, m.DefaultEmailNameCIC, m.BaseURLCIC, m.ImportNotificationEmailCIC
FROM dbo.STP_Member m WHERE m.Active=1


RETURN @Error

SET NOCOUNT OFF



GO
GRANT EXECUTE ON  [dbo].[sp_CIC_iCarolImport_Rollup] TO [cioc_login_role]
GO
