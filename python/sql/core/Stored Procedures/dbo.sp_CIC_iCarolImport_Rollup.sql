SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE PROCEDURE [dbo].[sp_CIC_iCarolImport_Rollup]
WITH EXECUTE AS CALLER
AS
SET NOCOUNT ON

DECLARE	@Error		INT
SET @Error = 0

MERGE INTO dbo.CIC_iCarolImportRollup dst
USING dbo.CIC_iCarolImport AS src
ON src.ResourceAgencyNum=dst.ResourceAgencyNum AND src.LangID=dst.LangID AND src.TaxonomyLevelName = 'Agency'
WHEN MATCHED AND src.SYNC_DATE > dst.DATE_MODIFIED THEN 
	UPDATE SET 
		[PublicName]=src.[PublicName],
		[AlternateName]=src.[AlternateName],
		[OfficialName]=src.[OfficialName],
		[TaxonomyLevelName]=src.[TaxonomyLevelName],
		[ParentAgency]=src.[ParentAgency],
		[ParentAgencyNum]=src.[ParentAgencyNum],
		[RECORD_OWNER]=src.[Custom_Record Owner (controlled)],
		[UniqueIDPriorSystem]=src.[UniqueIDPriorSystem],
		[MailingAttentionName]=src.[MailingAttentionName],
		[MailingAddress1]=src.[MailingAddress1],
		[MailingAddress2]=src.[MailingAddress2],
		[MailingCity]=src.[MailingCity],
		[MailingStateProvince]=src.[MailingStateProvince],
		[MailingPostalCode]=src.[MailingPostalCode],
		[MailingCountry]=src.[MailingCountry],
		[MailingAddressIsPrivate]=src.[MailingAddressIsPrivate],
		[PhysicalAddress1]=src.[PhysicalAddress1],
		[PhysicalAddress2]=src.[PhysicalAddress2],
		[PhysicalCity]=src.[PhysicalCity],
		[PhysicalCounty]=src.[PhysicalCounty],
		[PhysicalStateProvince]=src.[PhysicalStateProvince],
		[PhysicalPostalCode]=src.[PhysicalPostalCode],
		[PhysicalCountry]=src.[PhysicalCountry],
		[PhysicalAddressIsPrivate]=src.[PhysicalAddressIsPrivate],
		[OtherAddress1]=src.[OtherAddress1],
		[OtherAddress2]=src.[OtherAddress2],
		[OtherCity]=src.[OtherCity],
		[OtherCounty]=src.[OtherCounty],
		[OtherStateProvince]=src.[OtherStateProvince],
		[OtherPostalCode]=src.[OtherPostalCode],
		[OtherCountry]=src.[OtherCountry],
		[Latitude]=NULLIF(src.[Latitude],'0'),
		[Longitude]=NULLIF(src.[Longitude], '0'),
		[HoursOfOperation]=src.[HoursOfOperation],
		[Phone1Number]=src.[Phone1Number],
		[Phone1Name]=src.[Phone1Name],
		[Phone1Description]=src.[Phone1Description],
		[Phone1IsPrivate]=src.[Phone1IsPrivate],
		[Phone1Type]=src.[Phone1Type],
		[Phone2Number]=src.[Phone2Number],
		[Phone2Name]=src.[Phone2Name],
		[Phone2Description]=src.[Phone2Description],
		[Phone2IsPrivate]=src.[Phone2IsPrivate],
		[Phone2Type]=src.[Phone2Type],
		[Phone3Number]=src.[Phone3Number],
		[Phone3Name]=src.[Phone3Name],
		[Phone3Description]=src.[Phone3Description],
		[Phone3IsPrivate]=src.[Phone3IsPrivate],
		[Phone3Type]=src.[Phone3Type],
		[Phone4Number]=src.[Phone4Number],
		[Phone4Name]=src.[Phone4Name],
		[Phone4Description]=src.[Phone4Description],
		[Phone4IsPrivate]=src.[Phone4IsPrivate],
		[Phone4Type]=src.[Phone4Type],
		[Phone5Number]=src.[Phone5Number],
		[Phone5name]=src.[Phone5name],
		[Phone5Description]=src.[Phone5Description],
		[Phone5IsPrivate]=src.[Phone5IsPrivate],
		[Phone5Type]=src.[Phone5Type],
		[PhoneFax]=src.[PhoneFax],
		[PhoneFaxDescription]=src.[PhoneFaxDescription],
		[PhoneFaxIsPrivate]=src.[PhoneFaxIsPrivate],
		[PhoneTTY]=src.[PhoneTTY],
		[PhoneTTYDescription]=src.[PhoneTTYDescription],
		[PhoneTTYIsPrivate]=src.[PhoneTTYIsPrivate],
		[PhoneTollFree]=src.[PhoneTollFree],
		[PhoneTollFreeDescription]=src.[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate]=src.[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline]=src.[PhoneNumberHotline],
		[PhoneNumberHotlineDescription]=src.[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate]=src.[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine]=src.[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription]=src.[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate]=src.[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea]=src.[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription]=src.[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate]=src.[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours]=src.[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription]=src.[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate]=src.[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain]=src.[EmailAddressMain],
		[WebsiteAddress]=src.[WebsiteAddress],
		[AgencyStatus]=src.[AgencyStatus],
		[AgencyClassification]=src.[AgencyClassification],
		[CoverageArea]=src.[CoverageArea],
		[CoverageAreaText]=src.[CoverageAreaText],
		[Eligibility]=src.[Eligibility],
		[EligibilityAdult]=src.[EligibilityAdult],
		[EligibilityChild]=src.[EligibilityChild],
		[EligibilityFamily]=src.[EligibilityFamily],
		[EligibilityFemale]=src.[EligibilityFemale],
		[EligibilityMale]=src.[EligibilityMale],
		[EligibilityTeen]=src.[EligibilityTeen],
		[SeniorWorkerName]=src.[SeniorWorkerName],
		[SeniorWorkerTitle]=src.[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress]=src.[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber]=src.[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate]=src.[SeniorWorkerIsPrivate],
		[MainContactName]=src.[MainContactName],
		[MainContactTitle]=src.[MainContactTitle],
		[MainContactEmailAddress]=src.[MainContactEmailAddress],
		[MainContactPhoneNumber]=src.[MainContactPhoneNumber],
		[MainContactType]=src.[MainContactType],
		[MainContactIsPrivate]=src.[MainContactIsPrivate],
		[LicenseAccreditation]=src.[LicenseAccreditation],
		[YearIncorporated]=src.[YearIncorporated],
		[AnnualBudgetTotal]=src.[AnnualBudgetTotal],
		[LegalStatus]=src.[LegalStatus],
		[SourceOfFunds]=src.[SourceOfFunds],
		[ExcludeFromWebsite]=src.[ExcludeFromWebsite],
		[ExcludeFromDirectory]=src.[ExcludeFromDirectory],
		[DisabilitiesAccess]=src.[DisabilitiesAccess],
		[PhysicalLocationDescription]=src.[PhysicalLocationDescription],
		[BusServiceAccess]=src.[BusServiceAccess],
		[PublicAccessTransportation]=src.[PublicAccessTransportation],
		[PaymentMethods]=src.[PaymentMethods],
		[FeeStructureSource]=src.[FeeStructureSource],
		[ApplicationProcess]=src.[ApplicationProcess],
		[ResourceInfo]=src.[ResourceInfo],
		[DocumentsRequired]=src.[DocumentsRequired],
		[LanguagesOffered]=src.[LanguagesOffered],
		[LanguagesOfferedList]=src.[LanguagesOfferedList],
		[AvailabilityNumberOfTimes]=src.[AvailabilityNumberOfTimes],
		[AvailabilityFrequency]=src.[AvailabilityFrequency],
		[AvailabilityPeriod]=src.[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability]=src.[ServiceNotAlwaysAvailability],
		[CapacityType]=src.[CapacityType],
		[ServiceCapacity]=src.[ServiceCapacity],
		[NormalWaitTime]=src.[NormalWaitTime],
		[TemporaryMessage]=src.[TemporaryMessage],
		[TemporaryMessageAppears]=src.[TemporaryMessageAppears],
		[TemporaryMessageExpires]=src.[TemporaryMessageExpires],
		[EnteredOn]=src.[EnteredOn],
		[UpdatedOn]=src.[UpdatedOn],
		[MadeInactiveOn]=src.[MadeInactiveOn],
		[InternalNotes]=src.[InternalNotes],
		[InternalNotesForEditorsAndViewers]=src.[InternalNotesForEditorsAndViewers],
		[HighlightedResource]=src.[HighlightedResource],
		[LastVerifiedOn]=src.[LastVerifiedOn],
		[LastVerifiedByName]=src.[LastVerifiedByName],
		[LastVerifiedByTitle]=src.[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber]=src.[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress]=src.[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy]=src.[LastVerificationApprovedBy],
		[AvailableForDirectory]=src.[AvailableForDirectory],
		[AvailableForReferral]=src.[AvailableForReferral],
		[AvailableForResearch]=src.[AvailableForResearch],
		[PreferredProvider]=src.[PreferredProvider],
		[ConnectsToSiteNum]=src.[ConnectsToSiteNum],
		[ConnectsToProgramNum]=src.[ConnectsToProgramNum],
		[LanguageOfRecord]=src.[LanguageOfRecord],
		[CurrentWorkflowStepCode]=src.[CurrentWorkflowStepCode],
		[VolunteerOpportunities]=src.[VolunteerOpportunities],
		[VolunteerDuties]=src.[VolunteerDuties],
		[IsLinkOnly]=src.[IsLinkOnly],
		[ProgramAgencyNamePublic]=src.[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic]=src.[SiteAgencyNamePublic],
		[Categories]=src.[Categories],
		[TaxonomyTerm]=src.[TaxonomyTerm],
		[TaxonomyTerms]=src.[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated]=src.[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes]=src.[TaxonomyCodes],
		[Coverage]=src.[Coverage],
		[Hours]=src.[Hours],
		[Custom_Public Comments]=src.[Custom_Public Comments],
		[Custom_Former Names]=src.[Custom_Former Names],
		[Custom_Legal Name]=src.[Custom_Legal Name],
		[Custom_Facebook]=src.[Custom_Facebook],
		[Custom_Instagram]=src.[Custom_Instagram],
		[Custom_LinkedIn]=src.[Custom_LinkedIn],
		[Custom_Twitter]=src.[Custom_Twitter],
		[Custom_YouTube]=src.[Custom_YouTube],
		[Custom_Minimum Age]=src.[Custom_Minimum Age],
		[Custom_Maximum Age]=src.[Custom_Maximum Age],
		[dst].[DATE_MODIFIED]=GETDATE(),
		ORG_LEVEL_1=src.PublicName,
		dst.ORG_DESCRIPTION=src.AgencyDescription,
		dst.ORG_LOCATION_SERVICE='AGENCY',
		dst.DELETION_DATE=src.DELETION_DATE
WHEN NOT MATCHED BY TARGET AND src.TaxonomyLevelName='Agency' THEN
	INSERT (
		[ResourceAgencyNum],
		[LangID],
		[PublicName],
		[AlternateName],
		[OfficialName],
		[TaxonomyLevelName],
		[ParentAgency],
		[ParentAgencyNum],
		[RECORD_OWNER],
		[UniqueIDPriorSystem],
		[MailingAttentionName],
		[MailingAddress1],
		[MailingAddress2],
		[MailingCity],
		[MailingStateProvince],
		[MailingPostalCode],
		[MailingCountry],
		[MailingAddressIsPrivate],
		[PhysicalAddress1],
		[PhysicalAddress2],
		[PhysicalCity],
		[PhysicalCounty],
		[PhysicalStateProvince],
		[PhysicalPostalCode],
		[PhysicalCountry],
		[PhysicalAddressIsPrivate],
		[OtherAddress1],
		[OtherAddress2],
		[OtherCity],
		[OtherCounty],
		[OtherStateProvince],
		[OtherPostalCode],
		[OtherCountry],
		[Latitude],
		[Longitude],
		[HoursOfOperation],
		[Phone1Number],
		[Phone1Name],
		[Phone1Description],
		[Phone1IsPrivate],
		[Phone1Type],
		[Phone2Number],
		[Phone2Name],
		[Phone2Description],
		[Phone2IsPrivate],
		[Phone2Type],
		[Phone3Number],
		[Phone3Name],
		[Phone3Description],
		[Phone3IsPrivate],
		[Phone3Type],
		[Phone4Number],
		[Phone4Name],
		[Phone4Description],
		[Phone4IsPrivate],
		[Phone4Type],
		[Phone5Number],
		[Phone5name],
		[Phone5Description],
		[Phone5IsPrivate],
		[Phone5Type],
		[PhoneFax],
		[PhoneFaxDescription],
		[PhoneFaxIsPrivate],
		[PhoneTTY],
		[PhoneTTYDescription],
		[PhoneTTYIsPrivate],
		[PhoneTollFree],
		[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline],
		[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain],
		[WebsiteAddress],
		[AgencyStatus],
		[AgencyClassification],
		[CoverageArea],
		[CoverageAreaText],
		[Eligibility],
		[EligibilityAdult],
		[EligibilityChild],
		[EligibilityFamily],
		[EligibilityFemale],
		[EligibilityMale],
		[EligibilityTeen],
		[SeniorWorkerName],
		[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate],
		[MainContactName],
		[MainContactTitle],
		[MainContactEmailAddress],
		[MainContactPhoneNumber],
		[MainContactType],
		[MainContactIsPrivate],
		[LicenseAccreditation],
		[YearIncorporated],
		[AnnualBudgetTotal],
		[LegalStatus],
		[SourceOfFunds],
		[ExcludeFromWebsite],
		[ExcludeFromDirectory],
		[DisabilitiesAccess],
		[PhysicalLocationDescription],
		[BusServiceAccess],
		[PublicAccessTransportation],
		[PaymentMethods],
		[FeeStructureSource],
		[ApplicationProcess],
		[ResourceInfo],
		[DocumentsRequired],
		[LanguagesOffered],
		[LanguagesOfferedList],
		[AvailabilityNumberOfTimes],
		[AvailabilityFrequency],
		[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability],
		[CapacityType],
		[ServiceCapacity],
		[NormalWaitTime],
		[TemporaryMessage],
		[TemporaryMessageAppears],
		[TemporaryMessageExpires],
		[EnteredOn],
		[UpdatedOn],
		[MadeInactiveOn],
		[InternalNotes],
		[InternalNotesForEditorsAndViewers],
		[HighlightedResource],
		[LastVerifiedOn],
		[LastVerifiedByName],
		[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy],
		[AvailableForDirectory],
		[AvailableForReferral],
		[AvailableForResearch],
		[PreferredProvider],
		[ConnectsToSiteNum],
		[ConnectsToProgramNum],
		[LanguageOfRecord],
		[CurrentWorkflowStepCode],
		[VolunteerOpportunities],
		[VolunteerDuties],
		[IsLinkOnly],
		[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic],
		[Categories],
		[TaxonomyTerm],
		[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes],
		[Coverage],
		[Hours],
		[Custom_Public Comments],
		[Custom_Former Names],
		[Custom_Legal Name],
		[Custom_Facebook],
		[Custom_Instagram],
		[Custom_LinkedIn],
		[Custom_Twitter],
		[Custom_YouTube],
		[Custom_Minimum Age],
		[Custom_Maximum Age],
		[DATE_MODIFIED],
		ORG_LEVEL_1,
		ORG_DESCRIPTION,
		ORG_LOCATION_SERVICE,
		DELETION_DATE
	) VALUES (
		src.[ResourceAgencyNum],
		src.LangID,
		src.[PublicName],
		src.[AlternateName],
		src.[OfficialName],
		src.[TaxonomyLevelName],
		src.[ParentAgency],
		src.[ParentAgencyNum],
		src.[Custom_Record Owner (controlled)],
		src.[UniqueIDPriorSystem],
		src.[MailingAttentionName],
		src.[MailingAddress1],
		src.[MailingAddress2],
		src.[MailingCity],
		src.[MailingStateProvince],
		src.[MailingPostalCode],
		src.[MailingCountry],
		src.[MailingAddressIsPrivate],
		src.[PhysicalAddress1],
		src.[PhysicalAddress2],
		src.[PhysicalCity],
		src.[PhysicalCounty],
		src.[PhysicalStateProvince],
		src.[PhysicalPostalCode],
		src.[PhysicalCountry],
		src.[PhysicalAddressIsPrivate],
		src.[OtherAddress1],
		src.[OtherAddress2],
		src.[OtherCity],
		src.[OtherCounty],
		src.[OtherStateProvince],
		src.[OtherPostalCode],
		src.[OtherCountry],
		NULLIF(src.[Latitude],'0'),
		NULLIF(src.[Longitude],'0'),
		src.[HoursOfOperation],
		src.[Phone1Number],
		src.[Phone1Name],
		src.[Phone1Description],
		src.[Phone1IsPrivate],
		src.[Phone1Type],
		src.[Phone2Number],
		src.[Phone2Name],
		src.[Phone2Description],
		src.[Phone2IsPrivate],
		src.[Phone2Type],
		src.[Phone3Number],
		src.[Phone3Name],
		src.[Phone3Description],
		src.[Phone3IsPrivate],
		src.[Phone3Type],
		src.[Phone4Number],
		src.[Phone4Name],
		src.[Phone4Description],
		src.[Phone4IsPrivate],
		src.[Phone4Type],
		src.[Phone5Number],
		src.[Phone5name],
		src.[Phone5Description],
		src.[Phone5IsPrivate],
		src.[Phone5Type],
		src.[PhoneFax],
		src.[PhoneFaxDescription],
		src.[PhoneFaxIsPrivate],
		src.[PhoneTTY],
		src.[PhoneTTYDescription],
		src.[PhoneTTYIsPrivate],
		src.[PhoneTollFree],
		src.[PhoneTollFreeDescription],
		src.[PhoneTollFreeIsPrivate],
		src.[PhoneNumberHotline],
		src.[PhoneNumberHotlineDescription],
		src.[PhoneNumberHotlineIsPrivate],
		src.[PhoneNumberBusinessLine],
		src.[PhoneNumberBusinessLineDescription],
		src.[PhoneNumberBusinessLineIsPrivate],
		src.[PhoneNumberOutOfArea],
		src.[PhoneNumberOutOfAreaDescription],
		src.[PhoneNumberOutOfAreaIsPrivate],
		src.[PhoneNumberAfterHours],
		src.[PhoneNumberAfterHoursDescription],
		src.[PhoneNumberAfterHoursIsPrivate],
		src.[EmailAddressMain],
		src.[WebsiteAddress],
		src.[AgencyStatus],
		src.[AgencyClassification],
		src.[CoverageArea],
		src.[CoverageAreaText],
		src.[Eligibility],
		src.[EligibilityAdult],
		src.[EligibilityChild],
		src.[EligibilityFamily],
		src.[EligibilityFemale],
		src.[EligibilityMale],
		src.[EligibilityTeen],
		src.[SeniorWorkerName],
		src.[SeniorWorkerTitle],
		src.[SeniorWorkerEmailAddress],
		src.[SeniorWorkerPhoneNumber],
		src.[SeniorWorkerIsPrivate],
		src.[MainContactName],
		src.[MainContactTitle],
		src.[MainContactEmailAddress],
		src.[MainContactPhoneNumber],
		src.[MainContactType],
		src.[MainContactIsPrivate],
		src.[LicenseAccreditation],
		src.[YearIncorporated],
		src.[AnnualBudgetTotal],
		src.[LegalStatus],
		src.[SourceOfFunds],
		src.[ExcludeFromWebsite],
		src.[ExcludeFromDirectory],
		src.[DisabilitiesAccess],
		src.[PhysicalLocationDescription],
		src.[BusServiceAccess],
		src.[PublicAccessTransportation],
		src.[PaymentMethods],
		src.[FeeStructureSource],
		src.[ApplicationProcess],
		src.[ResourceInfo],
		src.[DocumentsRequired],
		src.[LanguagesOffered],
		src.[LanguagesOfferedList],
		src.[AvailabilityNumberOfTimes],
		src.[AvailabilityFrequency],
		src.[AvailabilityPeriod],
		src.[ServiceNotAlwaysAvailability],
		src.[CapacityType],
		src.[ServiceCapacity],
		src.[NormalWaitTime],
		src.[TemporaryMessage],
		src.[TemporaryMessageAppears],
		src.[TemporaryMessageExpires],
		src.[EnteredOn],
		src.[UpdatedOn],
		src.[MadeInactiveOn],
		src.[InternalNotes],
		src.[InternalNotesForEditorsAndViewers],
		src.[HighlightedResource],
		src.[LastVerifiedOn],
		src.[LastVerifiedByName],
		src.[LastVerifiedByTitle],
		src.[LastVerifiedByPhoneNumber],
		src.[LastVerifiedByEmailAddress],
		src.[LastVerificationApprovedBy],
		src.[AvailableForDirectory],
		src.[AvailableForReferral],
		src.[AvailableForResearch],
		src.[PreferredProvider],
		src.[ConnectsToSiteNum],
		src.[ConnectsToProgramNum],
		src.[LanguageOfRecord],
		src.[CurrentWorkflowStepCode],
		src.[VolunteerOpportunities],
		src.[VolunteerDuties],
		src.[IsLinkOnly],
		src.[ProgramAgencyNamePublic],
		src.[SiteAgencyNamePublic],
		src.[Categories],
		src.[TaxonomyTerm],
		src.[TaxonomyTerms],
		src.[TaxonomyTermsNotDeactivated],
		src.[TaxonomyCodes],
		src.[Coverage],
		src.[Hours],
		src.[Custom_Public Comments],
		src.[Custom_Former Names],
		src.[Custom_Legal Name],
		src.[Custom_Facebook],
		src.[Custom_Instagram],
		src.[Custom_LinkedIn],
		src.[Custom_Twitter],
		src.[Custom_YouTube],
		src.[Custom_Minimum Age],
		src.[Custom_Maximum Age],
		GETDATE(),
		src.PublicName,
		src.AgencyDescription,
		'AGENCY',
		src.DELETION_DATE
	)

	;


MERGE INTO dbo.CIC_iCarolImportRollup dst
USING (
SELECT 
		(SELECT MAX(SYNC_DATE) FROM (VALUES (pas.SYNC_DATE), (p.SYNC_DATE), (s.SYNC_DATE), (a.SYNC_DATE)) AS i(SYNC_DATE)) AS SYNC_DATE,
		COALESCE(pas.[ResourceAgencyNum], p.[ResourceAgencyNum], s.[ResourceAgencyNum], a.[ResourceAgencyNum]) AS [ResourceAgencyNum],
		COALESCE(pas.[LangID], p.[LangID], s.[LangID], a.[LangID]) AS [LangID],
		COALESCE(pas.[PublicName], p.[PublicName], s.[PublicName], a.[PublicName]) AS [PublicName],
		COALESCE(pas.[AlternateName], p.[AlternateName], s.[AlternateName], a.[AlternateName]) AS [AlternateName],
		COALESCE(pas.[OfficialName], p.[OfficialName], s.[OfficialName], a.[OfficialName]) AS [OfficialName],
		COALESCE(pas.[TaxonomyLevelName], p.[TaxonomyLevelName], s.[TaxonomyLevelName], a.[TaxonomyLevelName]) AS [TaxonomyLevelName],
		COALESCE(pas.[ParentAgency], p.[ParentAgency], s.[ParentAgency], a.[ParentAgency]) AS [ParentAgency],
		COALESCE(pas.[ParentAgencyNum], p.[ParentAgencyNum], s.[ParentAgencyNum], a.[ParentAgencyNum]) AS [ParentAgencyNum],
		COALESCE(pas.[Custom_Record Owner (controlled)], p.[Custom_Record Owner (controlled)]) AS [RECORD_OWNER],
		COALESCE(pas.[UniqueIDPriorSystem], p.[UniqueIDPriorSystem], s.[UniqueIDPriorSystem], a.[UniqueIDPriorSystem]) AS [UniqueIDPriorSystem],
		CASE WHEN pas.[MailingAttentionName] IS NOT NULL THEN pas.[MailingAttentionName] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.MailingAttentionName IS NOT NULL THEN p.[MailingAttentionName] WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingAttentionName]  IS NOT NULL THEN s.[MailingAttentionName]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingAttentionName]  IS NOT NULL THEN a.[MailingAttentionName]  ELSE NULL END AS [MailingAttentionName],
		CASE WHEN pas.[MailingAddress1] IS NOT NULL THEN pas.[MailingAddress1] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.[MailingAddress1]  IS NOT NULL THEN p.[MailingAddress1]  WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingAddress1]  IS NOT NULL THEN s.[MailingAddress1]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingAddress1]  IS NOT NULL THEN a.[MailingAddress1]  ELSE NULL END AS [MailingAddress1],
		CASE WHEN pas.[MailingAddress2] IS NOT NULL THEN pas.[MailingAddress2] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.[MailingAddress2]  IS NOT NULL THEN p.[MailingAddress2]  WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingAddress2]  IS NOT NULL THEN s.[MailingAddress2]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingAddress2]  IS NOT NULL THEN a.[MailingAddress2]  ELSE NULL END AS [MailingAddress2],
		CASE WHEN pas.[MailingCity] IS NOT NULL THEN pas.[MailingCity] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.[MailingCity]  IS NOT NULL THEN p.[MailingCity]  WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingCity]  IS NOT NULL THEN s.[MailingCity]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingCity]  IS NOT NULL THEN a.[MailingCity]  ELSE NULL END AS [MailingCity],
		CASE WHEN pas.[MailingStateProvince] IS NOT NULL THEN pas.[MailingStateProvince] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.[MailingStateProvince]  IS NOT NULL THEN p.[MailingStateProvince]  WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingStateProvince]  IS NOT NULL THEN s.[MailingStateProvince]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingStateProvince]  IS NOT NULL THEN a.[MailingStateProvince]  ELSE NULL END AS [MailingStateProvince],
		CASE WHEN pas.[MailingPostalCode] IS NOT NULL THEN pas.[MailingPostalCode] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.[MailingPostalCode]  IS NOT NULL THEN p.[MailingPostalCode]  WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingPostalCode]  IS NOT NULL THEN s.[MailingPostalCode]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingPostalCode]  IS NOT NULL THEN a.[MailingPostalCode]  ELSE NULL END AS [MailingPostalCode],
		CASE WHEN pas.[MailingCountry] IS NOT NULL THEN pas.[MailingCountry] WHEN p.MailingAddressIsPrivate = 'Yes' AND p.[MailingCountry]  IS NOT NULL THEN p.[MailingCountry]  WHEN s.MailingAddressIsPrivate = 'Yes' AND s.[MailingCountry]  IS NOT NULL THEN s.[MailingCountry]  WHEN a.MailingAddressIsPrivate = 'Yes' AND a.[MailingCountry]  IS NOT NULL THEN a.[MailingCountry]  ELSE NULL END AS [MailingCountry],
		COALESCE(pas.[MailingAddressIsPrivate], p.[MailingAddressIsPrivate], s.[MailingAddressIsPrivate], a.[MailingAddressIsPrivate]) AS [MailingAddressIsPrivate],
		CASE WHEN pas.[PhysicalAddress1] IS NOT NULL THEN pas.[PhysicalAddress1] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalAddress1]  IS NOT NULL THEN p.[PhysicalAddress1]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalAddress1]  IS NOT NULL THEN s.[PhysicalAddress1]  WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalAddress1]  IS NOT NULL THEN a.[PhysicalAddress1]  ELSE NULL END AS [PhysicalAddress1],
		CASE WHEN pas.[PhysicalAddress2] IS NOT NULL THEN pas.[PhysicalAddress2] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalAddress2]  IS NOT NULL THEN p.[PhysicalAddress2]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalAddress2]  IS NOT NULL THEN s.[PhysicalAddress2]   WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalAddress2]  IS NOT NULL THEN a.[PhysicalAddress2]  ELSE NULL END AS [PhysicalAddress2],
		CASE WHEN pas.[PhysicalCity] IS NOT NULL THEN pas.[PhysicalCity] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalCity]  IS NOT NULL THEN p.[PhysicalCity]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalCity]  IS NOT NULL THEN s.[PhysicalCity]  WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalCity]  IS NOT NULL THEN a.[PhysicalCity]  ELSE NULL END AS [PhysicalCity],
		CASE WHEN pas.[PhysicalCounty] IS NOT NULL THEN pas.[PhysicalCounty] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalCounty]  IS NOT NULL THEN p.[PhysicalCounty]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalCounty]  IS NOT NULL THEN s.[PhysicalCounty]  WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalCounty]  IS NOT NULL THEN a.[PhysicalCounty]  ELSE NULL END AS [PhysicalCounty],
		CASE WHEN pas.[PhysicalStateProvince] IS NOT NULL THEN pas.[PhysicalStateProvince] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalStateProvince]  IS NOT NULL THEN p.[PhysicalStateProvince]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalStateProvince]  IS NOT NULL THEN s.[PhysicalStateProvince]  WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalStateProvince]  IS NOT NULL THEN a.[PhysicalStateProvince]  ELSE NULL END AS [PhysicalStateProvince],
		CASE WHEN pas.[PhysicalPostalCode] IS NOT NULL THEN pas.[PhysicalPostalCode] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalPostalCode]  IS NOT NULL THEN p.[PhysicalPostalCode]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalPostalCode]  IS NOT NULL THEN s.[PhysicalPostalCode]  WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalPostalCode]  IS NOT NULL THEN a.[PhysicalPostalCode]  ELSE NULL END AS [PhysicalPostalCode],
		CASE WHEN pas.[PhysicalCountry] IS NOT NULL THEN pas.[PhysicalCountry] WHEN p.PhysicalAddressIsPrivate = 'Yes' AND p.[PhysicalCountry]  IS NOT NULL THEN p.[PhysicalCountry]  WHEN s.PhysicalAddressIsPrivate = 'Yes' AND s.[PhysicalCountry]  IS NOT NULL THEN s.[PhysicalCountry]  WHEN a.PhysicalAddressIsPrivate = 'Yes' AND a.[PhysicalCountry]  IS NOT NULL THEN a.[PhysicalCountry]  ELSE NULL END AS [PhysicalCountry],
		COALESCE(pas.[PhysicalAddressIsPrivate], p.[PhysicalAddressIsPrivate], s.[PhysicalAddressIsPrivate], a.[PhysicalAddressIsPrivate]) AS [PhysicalAddressIsPrivate],
		COALESCE(pas.[OtherAddress1], p.[OtherAddress1], s.[OtherAddress1], a.[OtherAddress1]) AS [OtherAddress1],
		COALESCE(pas.[OtherAddress2], p.[OtherAddress2], s.[OtherAddress2], a.[OtherAddress2]) AS [OtherAddress2],
		COALESCE(pas.[OtherCity], p.[OtherCity], s.[OtherCity], a.[OtherCity]) AS [OtherCity],
		COALESCE(pas.[OtherCounty], p.[OtherCounty], s.[OtherCounty], a.[OtherCounty]) AS [OtherCounty],
		COALESCE(pas.[OtherStateProvince], p.[OtherStateProvince], s.[OtherStateProvince], a.[OtherStateProvince]) AS [OtherStateProvince],
		COALESCE(pas.[OtherPostalCode], p.[OtherPostalCode], s.[OtherPostalCode], a.[OtherPostalCode]) AS [OtherPostalCode],
		COALESCE(pas.[OtherCountry], p.[OtherCountry], s.[OtherCountry], a.[OtherCountry]) AS [OtherCountry],
		COALESCE(NULLIF(pas.[Latitude],'0'), CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(p.[Latitude],'0') END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Latitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Latitude],'0') END) AS [Latitude],
		COALESCE(NULLIF(pas.[Longitude], '0'), CASE WHEN p.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(p.[Longitude],'0') END, CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Longitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Longitude],'0') END) AS [Longitude],
		COALESCE(pas.[HoursOfOperation], p.[HoursOfOperation], s.[HoursOfOperation], a.[HoursOfOperation]) AS [HoursOfOperation],
		CASE WHEN pas.[Phone1Number] IS NOT NULL THEN pas.[Phone1Number] WHEN p.[Phone1IsPrivate] = 'True' AND p.[Phone1Number]  IS NOT NULL THEN p.[Phone1Number]  WHEN s.[Phone1IsPrivate] = 'True' AND s.[Phone1Number]  IS NOT NULL THEN s.[Phone1Number]  WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Number]  IS NOT NULL THEN a.[Phone1Number]  ELSE NULL END AS [Phone1Number],
		COALESCE(pas.[Phone1Name], CASE WHEN p.[Phone1IsPrivate] = 'True' THEN NULL ELSE p.[Phone1Name] END, CASE WHEN s.[Phone1IsPrivate] = 'True' THEN NULL ELSE s.[Phone1Name] END, CASE WHEN a.[Phone1IsPrivate] = 'True' THEN NULL ELSE a.[Phone1Name] END) AS [Phone1Name],
		CASE WHEN pas.[Phone1Description] IS NOT NULL THEN pas.[Phone1Description] WHEN p.[Phone1IsPrivate] = 'True' AND p.[Phone1Description]  IS NOT NULL THEN p.[Phone1Description]  WHEN s.[Phone1IsPrivate] = 'True' AND s.[Phone1Description]  IS NOT NULL THEN s.[Phone1Description]  WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Description]  IS NOT NULL THEN a.[Phone1Description]  ELSE NULL END AS [Phone1Description],
		COALESCE(pas.[Phone1IsPrivate], p.[Phone1IsPrivate], s.[Phone1IsPrivate], a.[Phone1IsPrivate]) AS [Phone1IsPrivate],
		CASE WHEN pas.[Phone1Type] IS NOT NULL THEN pas.[Phone1Type] WHEN p.[Phone1IsPrivate] = 'True' AND p.[Phone1Type]  IS NOT NULL THEN p.[Phone1Type]  WHEN s.[Phone1IsPrivate] = 'True' AND s.[Phone1Type]  IS NOT NULL THEN s.[Phone1Type]  WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Type]  IS NOT NULL THEN a.[Phone1Type]  ELSE NULL END AS [Phone1Type],
		CASE WHEN pas.[Phone2Number] IS NOT NULL THEN pas.[Phone2Number] WHEN p.[Phone2IsPrivate] = 'True' AND p.[Phone2Number]  IS NOT NULL THEN p.[Phone2Number]  WHEN s.[Phone2IsPrivate] = 'True' AND s.[Phone2Number]  IS NOT NULL THEN s.[Phone2Number]  WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Number]  IS NOT NULL THEN a.[Phone2Number]  ELSE NULL END AS [Phone2Number],
		CASE WHEN pas.[Phone2Name] IS NOT NULL THEN pas.[Phone2Name] WHEN p.[Phone2IsPrivate] = 'True' AND p.[Phone2Name]  IS NOT NULL THEN p.[Phone2Name]  WHEN s.[Phone2IsPrivate] = 'True' AND s.[Phone2Name]  IS NOT NULL THEN s.[Phone2Name]  WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Name]  IS NOT NULL THEN a.[Phone2Name]  ELSE NULL END AS [Phone2Name],
		CASE WHEN pas.[Phone2Description] IS NOT NULL THEN pas.[Phone2Description] WHEN p.[Phone2IsPrivate] = 'True' AND p.[Phone2Description]  IS NOT NULL THEN p.[Phone2Description]  WHEN s.[Phone2IsPrivate] = 'True' AND s.[Phone2Description]  IS NOT NULL THEN s.[Phone2Description]  WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Description]  IS NOT NULL THEN a.[Phone2Description]  ELSE NULL END AS [Phone2Description],
		COALESCE(pas.[Phone2IsPrivate], p.[Phone2IsPrivate], s.[Phone2IsPrivate], a.[Phone2IsPrivate]) AS [Phone2IsPrivate],
		CASE WHEN pas.[Phone2Type] IS NOT NULL THEN pas.[Phone2Type] WHEN p.[Phone2IsPrivate] = 'True' AND p.[Phone2Type]  IS NOT NULL THEN p.[Phone2Type]  WHEN s.[Phone2IsPrivate] = 'True' AND s.[Phone2Type]  IS NOT NULL THEN s.[Phone2Type]  WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Type]  IS NOT NULL THEN a.[Phone2Type]  ELSE NULL END AS [Phone2Type],
		CASE WHEN pas.[Phone3Number] IS NOT NULL THEN pas.[Phone3Number] WHEN p.[Phone3IsPrivate] = 'True' AND p.[Phone3Number]  IS NOT NULL THEN p.[Phone3Number]  WHEN s.[Phone3IsPrivate] = 'True' AND s.[Phone3Number]  IS NOT NULL THEN s.[Phone3Number]  WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Number]  IS NOT NULL THEN a.[Phone3Number]  ELSE NULL END AS [Phone3Number],
		CASE WHEN pas.[Phone3Name] IS NOT NULL THEN pas.[Phone3Name] WHEN p.[Phone3IsPrivate] = 'True' AND p.[Phone3Name]  IS NOT NULL THEN p.[Phone3Name]  WHEN s.[Phone3IsPrivate] = 'True' AND s.[Phone3Name]  IS NOT NULL THEN s.[Phone3Name]  WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Name]  IS NOT NULL THEN a.[Phone3Name]  ELSE NULL END AS [Phone3Name],
		CASE WHEN pas.[Phone3Description] IS NOT NULL THEN pas.[Phone3Description] WHEN p.[Phone3IsPrivate] = 'True' AND p.[Phone3Description]  IS NOT NULL THEN p.[Phone3Description]  WHEN s.[Phone3IsPrivate] = 'True' AND s.[Phone3Description]  IS NOT NULL THEN s.[Phone3Description]  WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Description]  IS NOT NULL THEN a.[Phone3Description]  ELSE NULL END AS [Phone3Description],
		COALESCE(pas.[Phone3IsPrivate], p.[Phone3IsPrivate], s.[Phone3IsPrivate], a.[Phone3IsPrivate]) AS [Phone3IsPrivate],
		CASE WHEN pas.[Phone3Type] IS NOT NULL THEN pas.[Phone3Type] WHEN p.[Phone3IsPrivate] = 'True' AND p.[Phone3Type]  IS NOT NULL THEN p.[Phone3Type]  WHEN s.[Phone3IsPrivate] = 'True' AND s.[Phone3Type]  IS NOT NULL THEN s.[Phone3Type]  WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Type]  IS NOT NULL THEN a.[Phone3Type]  ELSE NULL END AS [Phone3Type],
		CASE WHEN pas.[Phone4Number] IS NOT NULL THEN pas.[Phone4Number] WHEN p.[Phone4IsPrivate] = 'True' AND p.[Phone4Number]  IS NOT NULL THEN p.[Phone4Number]  WHEN s.[Phone4IsPrivate] = 'True' AND s.[Phone4Number]  IS NOT NULL THEN s.[Phone4Number]  WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Number]  IS NOT NULL THEN a.[Phone4Number]  ELSE NULL END AS [Phone4Number],
		CASE WHEN pas.[Phone4Name] IS NOT NULL THEN pas.[Phone4Name] WHEN p.[Phone4IsPrivate] = 'True' AND p.[Phone4Name]  IS NOT NULL THEN p.[Phone4Name]  WHEN s.[Phone4IsPrivate] = 'True' AND s.[Phone4Name]  IS NOT NULL THEN s.[Phone4Name]  WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Name]  IS NOT NULL THEN a.[Phone4Name]  ELSE NULL END AS [Phone4Name],
		CASE WHEN pas.[Phone4Description] IS NOT NULL THEN pas.[Phone4Description] WHEN p.[Phone4IsPrivate] = 'True' AND p.[Phone4Description]  IS NOT NULL THEN p.[Phone4Description]  WHEN s.[Phone4IsPrivate] = 'True' AND s.[Phone4Description]  IS NOT NULL THEN s.[Phone4Description]  WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Description]  IS NOT NULL THEN a.[Phone4Description]  ELSE NULL END AS [Phone4Description],
		COALESCE(pas.[Phone4IsPrivate], p.[Phone4IsPrivate], s.[Phone4IsPrivate], a.[Phone4IsPrivate]) AS [Phone4IsPrivate],
		CASE WHEN pas.[Phone4Type] IS NOT NULL THEN pas.[Phone4Type] WHEN p.[Phone4IsPrivate] = 'True' AND p.[Phone4Type]  IS NOT NULL THEN p.[Phone4Type]  WHEN s.[Phone4IsPrivate] = 'True' AND s.[Phone4Type]  IS NOT NULL THEN s.[Phone4Type]  WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Type]  IS NOT NULL THEN a.[Phone4Type]  ELSE NULL END AS [Phone4Type],
		CASE WHEN pas.[Phone5Number] IS NOT NULL THEN pas.[Phone5Number] WHEN p.[Phone5IsPrivate] = 'True' AND p.[Phone5Number]  IS NOT NULL THEN p.[Phone5Number]  WHEN s.[Phone5IsPrivate] = 'True' AND s.[Phone5Number]  IS NOT NULL THEN s.[Phone5Number]  WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5Number]  IS NOT NULL THEN a.[Phone5Number]  ELSE NULL END AS [Phone5Number],
		CASE WHEN pas.[Phone5name] IS NOT NULL THEN pas.[Phone5name] WHEN p.[Phone5IsPrivate] = 'True' AND p.[Phone5name]  IS NOT NULL THEN p.[Phone5name]  WHEN s.[Phone5IsPrivate] = 'True' AND s.[Phone5name]  IS NOT NULL THEN s.[Phone5name]  WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5name]  IS NOT NULL THEN a.[Phone5name]  ELSE NULL END AS [Phone5name],
		CASE WHEN pas.[Phone5Description] IS NOT NULL THEN pas.[Phone5Description] WHEN p.[Phone5IsPrivate] = 'True' AND p.[Phone5Description]  IS NOT NULL THEN p.[Phone5Description]  WHEN s.[Phone5IsPrivate] = 'True' AND s.[Phone5Description]  IS NOT NULL THEN s.[Phone5Description]  WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5Description]  IS NOT NULL THEN a.[Phone5Description]  ELSE NULL END AS [Phone5Description],
		COALESCE(pas.[Phone5IsPrivate], p.[Phone5IsPrivate], s.[Phone5IsPrivate], a.[Phone5IsPrivate]) AS [Phone5IsPrivate],
		CASE WHEN pas.[Phone5Type] IS NOT NULL THEN pas.[Phone5Type] WHEN p.[Phone5IsPrivate] = 'True' AND p.[Phone5Type]  IS NOT NULL THEN p.[Phone5Type]  WHEN s.[Phone5IsPrivate] = 'True' AND s.[Phone5Type]  IS NOT NULL THEN s.[Phone5Type]  WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5Type]  IS NOT NULL THEN a.[Phone5Type]  ELSE NULL END AS [Phone5Type],
		CASE WHEN pas.[PhoneFax] IS NOT NULL THEN pas.[PhoneFax] WHEN p.[PhoneFaxIsPrivate] = 'True' AND p.[PhoneFax]  IS NOT NULL THEN p.[PhoneFax]  WHEN s.[PhoneFaxIsPrivate] = 'True' AND s.[PhoneFax]  IS NOT NULL THEN s.[PhoneFax]  WHEN a.[PhoneFaxIsPrivate] = 'True' AND a.[PhoneFax]  IS NOT NULL THEN a.[PhoneFax]  ELSE NULL END AS [PhoneFax],
		CASE WHEN pas.[PhoneFaxDescription] IS NOT NULL THEN pas.[PhoneFaxDescription] WHEN p.[PhoneFaxIsPrivate] = 'True' AND p.[PhoneFaxDescription]  IS NOT NULL THEN p.[PhoneFaxDescription]  WHEN s.[PhoneFaxIsPrivate] = 'True' AND s.[PhoneFaxDescription]  IS NOT NULL THEN s.[PhoneFaxDescription]  WHEN a.[PhoneFaxIsPrivate] = 'True' AND a.[PhoneFaxDescription]  IS NOT NULL THEN a.[PhoneFaxDescription]  ELSE NULL END AS [PhoneFaxDescription],
		COALESCE(pas.[PhoneFaxIsPrivate], p.[PhoneFaxIsPrivate], s.[PhoneFaxIsPrivate], a.[PhoneFaxIsPrivate]) AS [PhoneFaxIsPrivate],
		CASE WHEN pas.[PhoneTTY] IS NOT NULL THEN pas.[PhoneTTY] WHEN p.[PhoneTTYIsPrivate] = 'True' AND p.[PhoneTTY]  IS NOT NULL THEN p.[PhoneTTY]  WHEN s.[PhoneTTYIsPrivate] = 'True' AND s.[PhoneTTY]  IS NOT NULL THEN s.[PhoneTTY]  WHEN a.[PhoneTTYIsPrivate] = 'True' AND a.[PhoneTTY]  IS NOT NULL THEN a.[PhoneTTY]  ELSE NULL END AS [PhoneTTY],
		CASE WHEN pas.[PhoneTTYDescription] IS NOT NULL THEN pas.[PhoneTTYDescription] WHEN p.[PhoneTTYIsPrivate] = 'True' AND p.[PhoneTTYDescription]  IS NOT NULL THEN p.[PhoneTTYDescription]  WHEN s.[PhoneTTYIsPrivate] = 'True' AND s.[PhoneTTYDescription]  IS NOT NULL THEN s.[PhoneTTYDescription]  WHEN a.[PhoneTTYIsPrivate] = 'True' AND a.[PhoneTTYDescription]  IS NOT NULL THEN a.[PhoneTTYDescription]  ELSE NULL END AS [PhoneTTYDescription],
		COALESCE(pas.[PhoneTTYIsPrivate], p.[PhoneTTYIsPrivate], s.[PhoneTTYIsPrivate], a.[PhoneTTYIsPrivate]) AS [PhoneTTYIsPrivate],
		CASE WHEN pas.[PhoneTollFree] IS NOT NULL THEN pas.[PhoneTollFree] WHEN p.[PhoneTollFreeIsPrivate] = 'True' AND p.[PhoneTollFree]  IS NOT NULL THEN p.[PhoneTollFree]  WHEN s.[PhoneTollFreeIsPrivate] = 'True' AND s.[PhoneTollFree]  IS NOT NULL THEN s.[PhoneTollFree]  WHEN a.[PhoneTollFreeIsPrivate] = 'True' AND a.[PhoneTollFree]  IS NOT NULL THEN a.[PhoneTollFree]  ELSE NULL END AS [PhoneTollFree],
		CASE WHEN pas.[PhoneTollFreeDescription] IS NOT NULL THEN pas.[PhoneTollFreeDescription] WHEN p.[PhoneTollFreeIsPrivate] = 'True' AND p.[PhoneTollFreeDescription]  IS NOT NULL THEN p.[PhoneTollFreeDescription]  WHEN s.[PhoneTollFreeIsPrivate] = 'True' AND s.[PhoneTollFreeDescription]  IS NOT NULL THEN s.[PhoneTollFreeDescription]  WHEN a.[PhoneTollFreeIsPrivate] = 'True' AND a.[PhoneTollFreeDescription]  IS NOT NULL THEN a.[PhoneTollFreeDescription]  ELSE NULL END AS [PhoneTollFreeDescription],
		COALESCE(pas.[PhoneTollFreeIsPrivate], p.[PhoneTollFreeIsPrivate], s.[PhoneTollFreeIsPrivate], a.[PhoneTollFreeIsPrivate]) AS [PhoneTollFreeIsPrivate],
		CASE WHEN pas.[PhoneNumberHotline] IS NOT NULL THEN pas.[PhoneNumberHotline] WHEN p.[PhoneNumberHotlineIsPrivate] = 'True' AND p.[PhoneNumberHotline]  IS NOT NULL THEN p.[PhoneNumberHotline]  WHEN s.[PhoneNumberHotlineIsPrivate] = 'True' AND s.[PhoneNumberHotline]  IS NOT NULL THEN s.[PhoneNumberHotline]  WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' AND a.[PhoneNumberHotline]  IS NOT NULL THEN a.[PhoneNumberHotline]  ELSE NULL END AS [PhoneNumberHotline],
		CASE WHEN pas.[PhoneNumberHotlineDescription] IS NOT NULL THEN pas.[PhoneNumberHotlineDescription] WHEN p.[PhoneNumberHotlineIsPrivate] = 'True' AND p.[PhoneNumberHotlineDescription]  IS NOT NULL THEN p.[PhoneNumberHotlineDescription]  WHEN s.[PhoneNumberHotlineIsPrivate] = 'True' AND s.[PhoneNumberHotlineDescription]  IS NOT NULL THEN s.[PhoneNumberHotlineDescription]  WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' AND a.[PhoneNumberHotlineDescription]  IS NOT NULL THEN a.[PhoneNumberHotlineDescription]  ELSE NULL END AS [PhoneNumberHotlineDescription],
		COALESCE(pas.[PhoneNumberHotlineIsPrivate], p.[PhoneNumberHotlineIsPrivate], s.[PhoneNumberHotlineIsPrivate], a.[PhoneNumberHotlineIsPrivate]) AS [PhoneNumberHotlineIsPrivate],
		CASE WHEN pas.[PhoneNumberBusinessLine] IS NOT NULL THEN pas.[PhoneNumberBusinessLine] WHEN p.[PhoneNumberBusinessLineIsPrivate] = 'True' AND p.[PhoneNumberBusinessLine]  IS NOT NULL THEN p.[PhoneNumberBusinessLine]  WHEN s.[PhoneNumberBusinessLineIsPrivate] = 'True' AND s.[PhoneNumberBusinessLine]  IS NOT NULL THEN s.[PhoneNumberBusinessLine]  WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' AND a.[PhoneNumberBusinessLine]  IS NOT NULL THEN a.[PhoneNumberBusinessLine]  ELSE NULL END AS [PhoneNumberBusinessLine],
		CASE WHEN pas.[PhoneNumberBusinessLineDescription] IS NOT NULL THEN pas.[PhoneNumberBusinessLineDescription] WHEN p.[PhoneNumberBusinessLineIsPrivate] = 'True' AND p.[PhoneNumberBusinessLineDescription]  IS NOT NULL THEN p.[PhoneNumberBusinessLineDescription]  WHEN s.[PhoneNumberBusinessLineIsPrivate] = 'True' AND s.[PhoneNumberBusinessLineDescription]  IS NOT NULL THEN s.[PhoneNumberBusinessLineDescription]  WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' AND a.[PhoneNumberBusinessLineDescription]  IS NOT NULL THEN a.[PhoneNumberBusinessLineDescription]  ELSE NULL END AS [PhoneNumberBusinessLineDescription],
		COALESCE(pas.[PhoneNumberBusinessLineIsPrivate], p.[PhoneNumberBusinessLineIsPrivate], s.[PhoneNumberBusinessLineIsPrivate], a.[PhoneNumberBusinessLineIsPrivate]) AS [PhoneNumberBusinessLineIsPrivate],
		CASE WHEN pas.[PhoneNumberOutOfArea] IS NOT NULL THEN pas.[PhoneNumberOutOfArea] WHEN p.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND p.[PhoneNumberOutOfArea]  IS NOT NULL THEN p.[PhoneNumberOutOfArea]  WHEN s.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND s.[PhoneNumberOutOfArea]  IS NOT NULL THEN s.[PhoneNumberOutOfArea]  WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND a.[PhoneNumberOutOfArea]  IS NOT NULL THEN a.[PhoneNumberOutOfArea]  ELSE NULL END AS [PhoneNumberOutOfArea],
		CASE WHEN pas.[PhoneNumberOutOfAreaDescription] IS NOT NULL THEN pas.[PhoneNumberOutOfAreaDescription] WHEN p.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND p.[PhoneNumberOutOfAreaDescription]  IS NOT NULL THEN p.[PhoneNumberOutOfAreaDescription]  WHEN s.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND s.[PhoneNumberOutOfAreaDescription]  IS NOT NULL THEN s.[PhoneNumberOutOfAreaDescription]  WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND a.[PhoneNumberOutOfAreaDescription]  IS NOT NULL THEN a.[PhoneNumberOutOfAreaDescription]  ELSE NULL END AS [PhoneNumberOutOfAreaDescription],
		COALESCE(pas.[PhoneNumberOutOfAreaIsPrivate], p.[PhoneNumberOutOfAreaIsPrivate], s.[PhoneNumberOutOfAreaIsPrivate], a.[PhoneNumberOutOfAreaIsPrivate]) AS [PhoneNumberOutOfAreaIsPrivate],
		CASE WHEN pas.[PhoneNumberAfterHours] IS NOT NULL THEN pas.[PhoneNumberAfterHours] WHEN p.[PhoneNumberAfterHoursIsPrivate] = 'True' AND p.[PhoneNumberAfterHours]  IS NOT NULL THEN p.[PhoneNumberAfterHours]  WHEN s.[PhoneNumberAfterHoursIsPrivate] = 'True' AND s.[PhoneNumberAfterHours]  IS NOT NULL THEN s.[PhoneNumberAfterHours]  WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' AND a.[PhoneNumberAfterHours]  IS NOT NULL THEN a.[PhoneNumberAfterHours]  ELSE NULL END AS [PhoneNumberAfterHours],
		CASE WHEN pas.[PhoneNumberAfterHoursDescription] IS NOT NULL THEN pas.[PhoneNumberAfterHoursDescription] WHEN p.[PhoneNumberAfterHoursIsPrivate] = 'True' AND p.[PhoneNumberAfterHoursDescription]  IS NOT NULL THEN p.[PhoneNumberAfterHoursDescription]  WHEN s.[PhoneNumberAfterHoursIsPrivate] = 'True' AND s.[PhoneNumberAfterHoursDescription]  IS NOT NULL THEN s.[PhoneNumberAfterHoursDescription]  WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' AND a.[PhoneNumberAfterHoursDescription]  IS NOT NULL THEN a.[PhoneNumberAfterHoursDescription]  ELSE NULL END AS [PhoneNumberAfterHoursDescription],
		COALESCE(pas.[PhoneNumberAfterHoursIsPrivate], p.[PhoneNumberAfterHoursIsPrivate], s.[PhoneNumberAfterHoursIsPrivate], a.[PhoneNumberAfterHoursIsPrivate]) AS [PhoneNumberAfterHoursIsPrivate],
		COALESCE(pas.[EmailAddressMain], p.[EmailAddressMain], s.[EmailAddressMain], a.[EmailAddressMain]) AS [EmailAddressMain],
		COALESCE(pas.[WebsiteAddress], p.[WebsiteAddress], s.[WebsiteAddress], a.[WebsiteAddress]) AS [WebsiteAddress],
		COALESCE(pas.[AgencyStatus], p.[AgencyStatus], s.[AgencyStatus], a.[AgencyStatus]) AS [AgencyStatus],
		COALESCE(pas.[AgencyClassification], p.[AgencyClassification], s.[AgencyClassification], a.[AgencyClassification]) AS [AgencyClassification],
		COALESCE(pas.[CoverageArea], p.[CoverageArea], s.[CoverageArea], a.[CoverageArea]) AS [CoverageArea],
		COALESCE(pas.[CoverageAreaText], p.[CoverageAreaText], s.[CoverageAreaText], a.[CoverageAreaText]) AS [CoverageAreaText],
		COALESCE(pas.[Eligibility], p.[Eligibility], s.[Eligibility], a.[Eligibility]) AS [Eligibility],
		COALESCE(pas.[EligibilityAdult], p.[EligibilityAdult], s.[EligibilityAdult], a.[EligibilityAdult]) AS [EligibilityAdult],
		COALESCE(pas.[EligibilityChild], p.[EligibilityChild], s.[EligibilityChild], a.[EligibilityChild]) AS [EligibilityChild],
		COALESCE(pas.[EligibilityFamily], p.[EligibilityFamily], s.[EligibilityFamily], a.[EligibilityFamily]) AS [EligibilityFamily],
		COALESCE(pas.[EligibilityFemale], p.[EligibilityFemale], s.[EligibilityFemale], a.[EligibilityFemale]) AS [EligibilityFemale],
		COALESCE(pas.[EligibilityMale], p.[EligibilityMale], s.[EligibilityMale], a.[EligibilityMale]) AS [EligibilityMale],
		COALESCE(pas.[EligibilityTeen], p.[EligibilityTeen], s.[EligibilityTeen], a.[EligibilityTeen]) AS [EligibilityTeen],
		CASE WHEN pas.[SeniorWorkerName] IS NOT NULL THEN pas.[SeniorWorkerName] WHEN p.SeniorWorkerIsPrivate = 'Yes' AND p.[SeniorWorkerName]  IS NOT NULL THEN p.[SeniorWorkerName]  WHEN s.SeniorWorkerIsPrivate = 'Yes' AND s.[SeniorWorkerName]  IS NOT NULL THEN s.[SeniorWorkerName]  WHEN a.SeniorWorkerIsPrivate = 'Yes' AND a.[SeniorWorkerName]  IS NOT NULL THEN a.[SeniorWorkerName]  ELSE NULL END AS [SeniorWorkerName],
		CASE WHEN pas.[SeniorWorkerTitle] IS NOT NULL THEN pas.[SeniorWorkerTitle] WHEN p.SeniorWorkerIsPrivate = 'Yes' AND p.[SeniorWorkerTitle]  IS NOT NULL THEN p.[SeniorWorkerTitle]  WHEN s.SeniorWorkerIsPrivate = 'Yes' AND s.[SeniorWorkerTitle]  IS NOT NULL THEN s.[SeniorWorkerTitle]  WHEN a.SeniorWorkerIsPrivate = 'Yes' AND a.[SeniorWorkerTitle]  IS NOT NULL THEN a.[SeniorWorkerTitle]  ELSE NULL END AS [SeniorWorkerTitle],
		CASE WHEN pas.[SeniorWorkerEmailAddress] IS NOT NULL THEN pas.[SeniorWorkerEmailAddress] WHEN p.SeniorWorkerIsPrivate = 'Yes' AND p.[SeniorWorkerEmailAddress]  IS NOT NULL THEN p.[SeniorWorkerEmailAddress]  WHEN s.SeniorWorkerIsPrivate = 'Yes' AND s.[SeniorWorkerEmailAddress]  IS NOT NULL THEN s.[SeniorWorkerEmailAddress]  WHEN a.SeniorWorkerIsPrivate = 'Yes' AND a.[SeniorWorkerEmailAddress]  IS NOT NULL THEN a.[SeniorWorkerEmailAddress]  ELSE NULL END AS [SeniorWorkerEmailAddress],
		CASE WHEN pas.[SeniorWorkerPhoneNumber] IS NOT NULL THEN pas.[SeniorWorkerPhoneNumber] WHEN p.SeniorWorkerIsPrivate = 'Yes' AND p.[SeniorWorkerPhoneNumber]  IS NOT NULL THEN p.[SeniorWorkerPhoneNumber]  WHEN s.SeniorWorkerIsPrivate = 'Yes' AND s.[SeniorWorkerPhoneNumber]  IS NOT NULL THEN s.[SeniorWorkerPhoneNumber]  WHEN a.SeniorWorkerIsPrivate = 'Yes' AND a.[SeniorWorkerPhoneNumber]  IS NOT NULL THEN a.[SeniorWorkerPhoneNumber]  ELSE NULL END AS [SeniorWorkerPhoneNumber],
		COALESCE(pas.[SeniorWorkerIsPrivate], p.[SeniorWorkerIsPrivate], s.[SeniorWorkerIsPrivate], CASE WHEN a.SeniorWorkerIsPrivate = 'Yes' THEN NULL ELSE a.[SeniorWorkerIsPrivate] END) AS [SeniorWorkerIsPrivate],
		CASE WHEN pas.[MainContactName] IS NOT NULL THEN pas.[MainContactName] WHEN p.MainContactIsPrivate = 'Yes' AND p.[MainContactName]  IS NOT NULL THEN p.[MainContactName]  WHEN s.MainContactIsPrivate = 'Yes' AND s.[MainContactName]  IS NOT NULL THEN s.[MainContactName]  WHEN a.MainContactIsPrivate = 'Yes' AND a.[MainContactName]  IS NOT NULL THEN a.[MainContactName]  ELSE NULL END AS [MainContactName],
		CASE WHEN pas.[MainContactTitle] IS NOT NULL THEN pas.[MainContactTitle] WHEN p.MainContactIsPrivate = 'Yes' AND p.[MainContactTitle]  IS NOT NULL THEN p.[MainContactTitle]  WHEN s.MainContactIsPrivate = 'Yes' AND s.[MainContactTitle]  IS NOT NULL THEN s.[MainContactTitle]  WHEN a.MainContactIsPrivate = 'Yes' AND a.[MainContactTitle]  IS NOT NULL THEN a.[MainContactTitle]  ELSE NULL END AS [MainContactTitle],
		CASE WHEN pas.[MainContactEmailAddress] IS NOT NULL THEN pas.[MainContactEmailAddress] WHEN p.MainContactIsPrivate = 'Yes' AND p.[MainContactEmailAddress]  IS NOT NULL THEN p.[MainContactEmailAddress]  WHEN s.MainContactIsPrivate = 'Yes' AND s.[MainContactEmailAddress]  IS NOT NULL THEN s.[MainContactEmailAddress]  WHEN a.MainContactIsPrivate = 'Yes' AND a.[MainContactEmailAddress]  IS NOT NULL THEN a.[MainContactEmailAddress]  ELSE NULL END AS [MainContactEmailAddress],
		CASE WHEN pas.[MainContactPhoneNumber] IS NOT NULL THEN pas.[MainContactPhoneNumber] WHEN p.MainContactIsPrivate = 'Yes' AND p.[MainContactPhoneNumber]  IS NOT NULL THEN p.[MainContactPhoneNumber]  WHEN s.MainContactIsPrivate = 'Yes' AND s.[MainContactPhoneNumber]  IS NOT NULL THEN s.[MainContactPhoneNumber]  WHEN a.MainContactIsPrivate = 'Yes' AND a.[MainContactPhoneNumber]  IS NOT NULL THEN a.[MainContactPhoneNumber]  ELSE NULL END AS [MainContactPhoneNumber],
		CASE WHEN pas.[MainContactType] IS NOT NULL THEN pas.[MainContactType] WHEN p.MainContactIsPrivate = 'Yes' AND p.[MainContactType]  IS NOT NULL THEN p.[MainContactType]  WHEN s.MainContactIsPrivate = 'Yes' AND s.[MainContactType]  IS NOT NULL THEN s.[MainContactType]  WHEN a.MainContactIsPrivate = 'Yes' AND a.[MainContactType]  IS NOT NULL THEN a.[MainContactType]  ELSE NULL END AS [MainContactType],
		COALESCE(pas.[MainContactIsPrivate], p.[MainContactIsPrivate], s.[MainContactIsPrivate], a.[MainContactIsPrivate]) AS [MainContactIsPrivate],
		COALESCE(pas.[LicenseAccreditation], p.[LicenseAccreditation], s.[LicenseAccreditation], a.[LicenseAccreditation]) AS [LicenseAccreditation],
		COALESCE(pas.[YearIncorporated], p.[YearIncorporated], s.[YearIncorporated], a.[YearIncorporated]) AS [YearIncorporated],
		COALESCE(pas.[AnnualBudgetTotal], p.[AnnualBudgetTotal], s.[AnnualBudgetTotal], a.[AnnualBudgetTotal]) AS [AnnualBudgetTotal],
		COALESCE(pas.[LegalStatus], p.[LegalStatus], s.[LegalStatus], a.[LegalStatus]) AS [LegalStatus],
		COALESCE(pas.[SourceOfFunds], p.[SourceOfFunds], s.[SourceOfFunds], a.[SourceOfFunds]) AS [SourceOfFunds],
		COALESCE(pas.[ExcludeFromWebsite], p.[ExcludeFromWebsite], s.[ExcludeFromWebsite], a.[ExcludeFromWebsite]) AS [ExcludeFromWebsite],
		COALESCE(pas.[ExcludeFromDirectory], p.[ExcludeFromDirectory], s.[ExcludeFromDirectory], a.[ExcludeFromDirectory]) AS [ExcludeFromDirectory],
		COALESCE(pas.[DisabilitiesAccess], p.[DisabilitiesAccess], s.[DisabilitiesAccess], a.[DisabilitiesAccess]) AS [DisabilitiesAccess],
		COALESCE(pas.[PhysicalLocationDescription], p.[PhysicalLocationDescription], s.[PhysicalLocationDescription], a.[PhysicalLocationDescription]) AS [PhysicalLocationDescription],
		COALESCE(pas.[BusServiceAccess], p.[BusServiceAccess], s.[BusServiceAccess], a.[BusServiceAccess]) AS [BusServiceAccess],
		COALESCE(pas.[PublicAccessTransportation], p.[PublicAccessTransportation], s.[PublicAccessTransportation], a.[PublicAccessTransportation]) AS [PublicAccessTransportation],
		COALESCE(pas.[PaymentMethods], p.[PaymentMethods], s.[PaymentMethods], a.[PaymentMethods]) AS [PaymentMethods],
		COALESCE(pas.[FeeStructureSource], p.[FeeStructureSource], s.[FeeStructureSource], a.[FeeStructureSource]) AS [FeeStructureSource],
		COALESCE(pas.[ApplicationProcess], p.[ApplicationProcess], s.[ApplicationProcess], a.[ApplicationProcess]) AS [ApplicationProcess],
		COALESCE(pas.[ResourceInfo], p.[ResourceInfo], s.[ResourceInfo], a.[ResourceInfo]) AS [ResourceInfo],
		COALESCE(pas.[DocumentsRequired], p.[DocumentsRequired], s.[DocumentsRequired], a.[DocumentsRequired]) AS [DocumentsRequired],
		COALESCE(pas.[LanguagesOffered], p.[LanguagesOffered], s.[LanguagesOffered], a.[LanguagesOffered]) AS [LanguagesOffered],
		COALESCE(pas.[LanguagesOfferedList], p.[LanguagesOfferedList], s.[LanguagesOfferedList], a.[LanguagesOfferedList]) AS [LanguagesOfferedList],
		COALESCE(pas.[AvailabilityNumberOfTimes], p.[AvailabilityNumberOfTimes], s.[AvailabilityNumberOfTimes], a.[AvailabilityNumberOfTimes]) AS [AvailabilityNumberOfTimes],
		COALESCE(pas.[AvailabilityFrequency], p.[AvailabilityFrequency], s.[AvailabilityFrequency], a.[AvailabilityFrequency]) AS [AvailabilityFrequency],
		COALESCE(pas.[AvailabilityPeriod], p.[AvailabilityPeriod], s.[AvailabilityPeriod], a.[AvailabilityPeriod]) AS [AvailabilityPeriod],
		COALESCE(pas.[ServiceNotAlwaysAvailability], p.[ServiceNotAlwaysAvailability], s.[ServiceNotAlwaysAvailability], a.[ServiceNotAlwaysAvailability]) AS [ServiceNotAlwaysAvailability],
		COALESCE(pas.[CapacityType], p.[CapacityType], s.[CapacityType], a.[CapacityType]) AS [CapacityType],
		COALESCE(pas.[ServiceCapacity], p.[ServiceCapacity], s.[ServiceCapacity], a.[ServiceCapacity]) AS [ServiceCapacity],
		COALESCE(pas.[NormalWaitTime], p.[NormalWaitTime], s.[NormalWaitTime], a.[NormalWaitTime]) AS [NormalWaitTime],
		COALESCE(pas.[TemporaryMessage], p.[TemporaryMessage], s.[TemporaryMessage], a.[TemporaryMessage]) AS [TemporaryMessage],
		COALESCE(pas.[TemporaryMessageAppears], p.[TemporaryMessageAppears], s.[TemporaryMessageAppears], a.[TemporaryMessageAppears]) AS [TemporaryMessageAppears],
		COALESCE(pas.[TemporaryMessageExpires], p.[TemporaryMessageExpires], s.[TemporaryMessageExpires], a.[TemporaryMessageExpires]) AS [TemporaryMessageExpires],
		COALESCE(pas.[EnteredOn], p.[EnteredOn], s.[EnteredOn], a.[EnteredOn]) AS [EnteredOn],
		COALESCE(pas.[UpdatedOn], p.[UpdatedOn], s.[UpdatedOn], a.[UpdatedOn]) AS [UpdatedOn],
		COALESCE(pas.[MadeInactiveOn], p.[MadeInactiveOn], s.[MadeInactiveOn], a.[MadeInactiveOn]) AS [MadeInactiveOn],
		COALESCE(pas.[InternalNotes], p.[InternalNotes]) AS [InternalNotes],
		COALESCE(pas.[InternalNotesForEditorsAndViewers], p.[InternalNotesForEditorsAndViewers]) AS [InternalNotesForEditorsAndViewers],
		COALESCE(pas.[HighlightedResource], p.[HighlightedResource], s.[HighlightedResource], a.[HighlightedResource]) AS [HighlightedResource],
		COALESCE(pas.[LastVerifiedOn], p.[LastVerifiedOn], s.[LastVerifiedOn], a.[LastVerifiedOn]) AS [LastVerifiedOn],
		COALESCE(pas.[LastVerifiedByName], p.[LastVerifiedByName], s.[LastVerifiedByName], a.[LastVerifiedByName]) AS [LastVerifiedByName],
		COALESCE(pas.[LastVerifiedByTitle], p.[LastVerifiedByTitle], s.[LastVerifiedByTitle], a.[LastVerifiedByTitle]) AS [LastVerifiedByTitle],
		COALESCE(pas.[LastVerifiedByPhoneNumber], p.[LastVerifiedByPhoneNumber], s.[LastVerifiedByPhoneNumber], a.[LastVerifiedByPhoneNumber]) AS [LastVerifiedByPhoneNumber],
		COALESCE(pas.[LastVerifiedByEmailAddress], p.[LastVerifiedByEmailAddress], s.[LastVerifiedByEmailAddress], a.[LastVerifiedByEmailAddress]) AS [LastVerifiedByEmailAddress],
		COALESCE(pas.[LastVerificationApprovedBy], p.[LastVerificationApprovedBy], s.[LastVerificationApprovedBy], a.[LastVerificationApprovedBy]) AS [LastVerificationApprovedBy],
		COALESCE(pas.[AvailableForDirectory], p.[AvailableForDirectory], s.[AvailableForDirectory], a.[AvailableForDirectory]) AS [AvailableForDirectory],
		COALESCE(pas.[AvailableForReferral], p.[AvailableForReferral], s.[AvailableForReferral], a.[AvailableForReferral]) AS [AvailableForReferral],
		COALESCE(pas.[AvailableForResearch], p.[AvailableForResearch], s.[AvailableForResearch], a.[AvailableForResearch]) AS [AvailableForResearch],
		COALESCE(pas.[PreferredProvider], p.[PreferredProvider], s.[PreferredProvider], a.[PreferredProvider]) AS [PreferredProvider],
		COALESCE(pas.[ConnectsToSiteNum], p.[ConnectsToSiteNum], s.[ConnectsToSiteNum], a.[ConnectsToSiteNum]) AS [ConnectsToSiteNum],
		COALESCE(pas.[ConnectsToProgramNum], p.[ConnectsToProgramNum], s.[ConnectsToProgramNum], a.[ConnectsToProgramNum]) AS [ConnectsToProgramNum],
		COALESCE(pas.[LanguageOfRecord], p.[LanguageOfRecord], s.[LanguageOfRecord], a.[LanguageOfRecord]) AS [LanguageOfRecord],
		COALESCE(pas.[CurrentWorkflowStepCode], p.[CurrentWorkflowStepCode], s.[CurrentWorkflowStepCode], a.[CurrentWorkflowStepCode]) AS [CurrentWorkflowStepCode],
		COALESCE(pas.[VolunteerOpportunities], p.[VolunteerOpportunities], s.[VolunteerOpportunities], a.[VolunteerOpportunities]) AS [VolunteerOpportunities],
		COALESCE(pas.[VolunteerDuties], p.[VolunteerDuties], s.[VolunteerDuties], a.[VolunteerDuties]) AS [VolunteerDuties],
		COALESCE(pas.[IsLinkOnly], p.[IsLinkOnly], s.[IsLinkOnly], a.[IsLinkOnly]) AS [IsLinkOnly],
		COALESCE(pas.[ProgramAgencyNamePublic], p.[ProgramAgencyNamePublic], s.[ProgramAgencyNamePublic], a.[ProgramAgencyNamePublic]) AS [ProgramAgencyNamePublic],
		COALESCE(pas.[SiteAgencyNamePublic], p.[SiteAgencyNamePublic], s.[SiteAgencyNamePublic], a.[SiteAgencyNamePublic]) AS [SiteAgencyNamePublic],
		COALESCE(pas.[Categories], p.[Categories], s.[Categories], a.[Categories]) AS [Categories],
		COALESCE(pas.[TaxonomyTerm], p.[TaxonomyTerm], s.[TaxonomyTerm], a.[TaxonomyTerm]) AS [TaxonomyTerm],
		COALESCE(pas.[TaxonomyTerms], p.[TaxonomyTerms], s.[TaxonomyTerms], a.[TaxonomyTerms]) AS [TaxonomyTerms],
		COALESCE(pas.[TaxonomyTermsNotDeactivated], p.[TaxonomyTermsNotDeactivated], s.[TaxonomyTermsNotDeactivated], a.[TaxonomyTermsNotDeactivated]) AS [TaxonomyTermsNotDeactivated],
		COALESCE(pas.[TaxonomyCodes], p.[TaxonomyCodes], s.[TaxonomyCodes], a.[TaxonomyCodes]) AS [TaxonomyCodes],
		COALESCE(pas.[Coverage], p.[Coverage], s.[Coverage], a.[Coverage]) AS [Coverage],
		COALESCE(pas.[Hours], p.[Hours], s.[Hours], a.[Hours]) AS [Hours],
		COALESCE(pas.[Custom_Public Comments], p.[Custom_Public Comments]) AS [Custom_Public Comments],
		COALESCE(pas.[Custom_Former Names], p.[Custom_Former Names], s.[Custom_Former Names], a.[Custom_Former Names]) AS [Custom_Former Names],
		COALESCE(pas.[Custom_Legal Name], p.[Custom_Legal Name], s.[Custom_Legal Name], a.[Custom_Legal Name]) AS [Custom_Legal Name],
		COALESCE(pas.[Custom_Facebook], p.[Custom_Facebook], s.[Custom_Facebook], a.[Custom_Facebook]) AS [Custom_Facebook],
		COALESCE(pas.[Custom_Instagram], p.[Custom_Instagram], s.[Custom_Instagram], a.[Custom_Instagram]) AS [Custom_Instagram],
		COALESCE(pas.[Custom_LinkedIn], p.[Custom_LinkedIn], s.[Custom_LinkedIn], a.[Custom_LinkedIn]) AS [Custom_LinkedIn],
		COALESCE(pas.[Custom_Twitter], p.[Custom_Twitter], s.[Custom_Twitter], a.[Custom_Twitter]) AS [Custom_Twitter],
		COALESCE(pas.[Custom_YouTube], p.[Custom_YouTube], s.[Custom_YouTube], a.[Custom_YouTube]) AS [Custom_YouTube],
		COALESCE(pas.[Custom_Minimum Age], p.[Custom_Minimum Age], s.[Custom_Minimum Age], a.[Custom_Minimum Age]) AS [Custom_Minimum Age],
		COALESCE(pas.[Custom_Maximum Age], p.[Custom_Maximum Age], s.[Custom_Maximum Age], a.[Custom_Maximum Age]) AS [Custom_Maximum Age],
		a.PublicName AS ORG_LEVEL_1,
		a.AgencyDescription AS ORG_DESCRIPTION,
		s.PublicName AS LOCATION_NAME,
		s.AgencyDescription AS LOCATION_DESCRIPTION,
		COALESCE(p.PublicName, pas.PublicName) AS SERVICE_NAME_LEVEL_1,
		s.PublicName AS SERVICE_NAME_LEVEL_2,
		COALESCE(pas.AgencyDescription, p.AgencyDescription) AS DESCRIPTION,
		pas.DELETION_DATE
	FROM dbo.CIC_iCarolImport pas
	LEFT JOIN dbo.CIC_iCarolImport p
		ON p.ResourceAgencyNum=pas.ConnectsToProgramNum AND p.TaxonomyLevelName='Program' AND p.LangID=pas.LangID
	LEFT JOIN dbo.CIC_iCarolImport s
		ON s.ResourceAgencyNum=pas.ConnectsToSiteNum AND s.TaxonomyLevelName='Site' AND s.langid=pas.LangID
	LEFT JOIN dbo.CIC_iCarolImport a
		ON pas.ParentAgencyNum=a.ResourceAgencyNum AND a.TaxonomyLevelName='Agency' AND a.LangID=pas.LangID
	WHERE pas.TaxonomyLevelName='ProgramAtSite'
) AS src
ON src.ResourceAgencyNum=dst.ResourceAgencyNum AND src.LangID=dst.LangID AND src.TaxonomyLevelName = 'ProgramAtSite'
WHEN MATCHED AND src.SYNC_DATE > dst.DATE_MODIFIED THEN 
	UPDATE SET 
		[PublicName]=src.[PublicName],
		[AlternateName]=src.[AlternateName],
		[OfficialName]=src.[OfficialName],
		[TaxonomyLevelName]=src.[TaxonomyLevelName],
		[ParentAgency]=src.[ParentAgency],
		[ParentAgencyNum]=src.[ParentAgencyNum],
		[RECORD_OWNER]=src.[RECORD_OWNER],
		[UniqueIDPriorSystem]=src.[UniqueIDPriorSystem],
		[MailingAttentionName]=src.[MailingAttentionName],
		[MailingAddress1]=src.[MailingAddress1],
		[MailingAddress2]=src.[MailingAddress2],
		[MailingCity]=src.[MailingCity],
		[MailingStateProvince]=src.[MailingStateProvince],
		[MailingPostalCode]=src.[MailingPostalCode],
		[MailingCountry]=src.[MailingCountry],
		[MailingAddressIsPrivate]=src.[MailingAddressIsPrivate],
		[PhysicalAddress1]=src.[PhysicalAddress1],
		[PhysicalAddress2]=src.[PhysicalAddress2],
		[PhysicalCity]=src.[PhysicalCity],
		[PhysicalCounty]=src.[PhysicalCounty],
		[PhysicalStateProvince]=src.[PhysicalStateProvince],
		[PhysicalPostalCode]=src.[PhysicalPostalCode],
		[PhysicalCountry]=src.[PhysicalCountry],
		[PhysicalAddressIsPrivate]=src.[PhysicalAddressIsPrivate],
		[OtherAddress1]=src.[OtherAddress1],
		[OtherAddress2]=src.[OtherAddress2],
		[OtherCity]=src.[OtherCity],
		[OtherCounty]=src.[OtherCounty],
		[OtherStateProvince]=src.[OtherStateProvince],
		[OtherPostalCode]=src.[OtherPostalCode],
		[OtherCountry]=src.[OtherCountry],
		[Latitude]=src.[Latitude],
		[Longitude]=src.[Longitude],
		[HoursOfOperation]=src.[HoursOfOperation],
		[Phone1Number]=src.[Phone1Number],
		[Phone1Name]=src.[Phone1Name],
		[Phone1Description]=src.[Phone1Description],
		[Phone1IsPrivate]=src.[Phone1IsPrivate],
		[Phone1Type]=src.[Phone1Type],
		[Phone2Number]=src.[Phone2Number],
		[Phone2Name]=src.[Phone2Name],
		[Phone2Description]=src.[Phone2Description],
		[Phone2IsPrivate]=src.[Phone2IsPrivate],
		[Phone2Type]=src.[Phone2Type],
		[Phone3Number]=src.[Phone3Number],
		[Phone3Name]=src.[Phone3Name],
		[Phone3Description]=src.[Phone3Description],
		[Phone3IsPrivate]=src.[Phone3IsPrivate],
		[Phone3Type]=src.[Phone3Type],
		[Phone4Number]=src.[Phone4Number],
		[Phone4Name]=src.[Phone4Name],
		[Phone4Description]=src.[Phone4Description],
		[Phone4IsPrivate]=src.[Phone4IsPrivate],
		[Phone4Type]=src.[Phone4Type],
		[Phone5Number]=src.[Phone5Number],
		[Phone5name]=src.[Phone5name],
		[Phone5Description]=src.[Phone5Description],
		[Phone5IsPrivate]=src.[Phone5IsPrivate],
		[Phone5Type]=src.[Phone5Type],
		[PhoneFax]=src.[PhoneFax],
		[PhoneFaxDescription]=src.[PhoneFaxDescription],
		[PhoneFaxIsPrivate]=src.[PhoneFaxIsPrivate],
		[PhoneTTY]=src.[PhoneTTY],
		[PhoneTTYDescription]=src.[PhoneTTYDescription],
		[PhoneTTYIsPrivate]=src.[PhoneTTYIsPrivate],
		[PhoneTollFree]=src.[PhoneTollFree],
		[PhoneTollFreeDescription]=src.[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate]=src.[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline]=src.[PhoneNumberHotline],
		[PhoneNumberHotlineDescription]=src.[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate]=src.[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine]=src.[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription]=src.[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate]=src.[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea]=src.[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription]=src.[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate]=src.[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours]=src.[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription]=src.[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate]=src.[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain]=src.[EmailAddressMain],
		[WebsiteAddress]=src.[WebsiteAddress],
		[AgencyStatus]=src.[AgencyStatus],
		[AgencyClassification]=src.[AgencyClassification],
		[CoverageArea]=src.[CoverageArea],
		[CoverageAreaText]=src.[CoverageAreaText],
		[Eligibility]=src.[Eligibility],
		[EligibilityAdult]=src.[EligibilityAdult],
		[EligibilityChild]=src.[EligibilityChild],
		[EligibilityFamily]=src.[EligibilityFamily],
		[EligibilityFemale]=src.[EligibilityFemale],
		[EligibilityMale]=src.[EligibilityMale],
		[EligibilityTeen]=src.[EligibilityTeen],
		[SeniorWorkerName]=src.[SeniorWorkerName],
		[SeniorWorkerTitle]=src.[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress]=src.[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber]=src.[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate]=src.[SeniorWorkerIsPrivate],
		[MainContactName]=src.[MainContactName],
		[MainContactTitle]=src.[MainContactTitle],
		[MainContactEmailAddress]=src.[MainContactEmailAddress],
		[MainContactPhoneNumber]=src.[MainContactPhoneNumber],
		[MainContactType]=src.[MainContactType],
		[MainContactIsPrivate]=src.[MainContactIsPrivate],
		[LicenseAccreditation]=src.[LicenseAccreditation],
		[YearIncorporated]=src.[YearIncorporated],
		[AnnualBudgetTotal]=src.[AnnualBudgetTotal],
		[LegalStatus]=src.[LegalStatus],
		[SourceOfFunds]=src.[SourceOfFunds],
		[ExcludeFromWebsite]=src.[ExcludeFromWebsite],
		[ExcludeFromDirectory]=src.[ExcludeFromDirectory],
		[DisabilitiesAccess]=src.[DisabilitiesAccess],
		[PhysicalLocationDescription]=src.[PhysicalLocationDescription],
		[BusServiceAccess]=src.[BusServiceAccess],
		[PublicAccessTransportation]=src.[PublicAccessTransportation],
		[PaymentMethods]=src.[PaymentMethods],
		[FeeStructureSource]=src.[FeeStructureSource],
		[ApplicationProcess]=src.[ApplicationProcess],
		[ResourceInfo]=src.[ResourceInfo],
		[DocumentsRequired]=src.[DocumentsRequired],
		[LanguagesOffered]=src.[LanguagesOffered],
		[LanguagesOfferedList]=src.[LanguagesOfferedList],
		[AvailabilityNumberOfTimes]=src.[AvailabilityNumberOfTimes],
		[AvailabilityFrequency]=src.[AvailabilityFrequency],
		[AvailabilityPeriod]=src.[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability]=src.[ServiceNotAlwaysAvailability],
		[CapacityType]=src.[CapacityType],
		[ServiceCapacity]=src.[ServiceCapacity],
		[NormalWaitTime]=src.[NormalWaitTime],
		[TemporaryMessage]=src.[TemporaryMessage],
		[TemporaryMessageAppears]=src.[TemporaryMessageAppears],
		[TemporaryMessageExpires]=src.[TemporaryMessageExpires],
		[EnteredOn]=src.[EnteredOn],
		[UpdatedOn]=src.[UpdatedOn],
		[MadeInactiveOn]=src.[MadeInactiveOn],
		[InternalNotes]=src.[InternalNotes],
		[InternalNotesForEditorsAndViewers]=src.[InternalNotesForEditorsAndViewers],
		[HighlightedResource]=src.[HighlightedResource],
		[LastVerifiedOn]=src.[LastVerifiedOn],
		[LastVerifiedByName]=src.[LastVerifiedByName],
		[LastVerifiedByTitle]=src.[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber]=src.[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress]=src.[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy]=src.[LastVerificationApprovedBy],
		[AvailableForDirectory]=src.[AvailableForDirectory],
		[AvailableForReferral]=src.[AvailableForReferral],
		[AvailableForResearch]=src.[AvailableForResearch],
		[PreferredProvider]=src.[PreferredProvider],
		[ConnectsToSiteNum]=src.[ConnectsToSiteNum],
		[ConnectsToProgramNum]=src.[ConnectsToProgramNum],
		[LanguageOfRecord]=src.[LanguageOfRecord],
		[CurrentWorkflowStepCode]=src.[CurrentWorkflowStepCode],
		[VolunteerOpportunities]=src.[VolunteerOpportunities],
		[VolunteerDuties]=src.[VolunteerDuties],
		[IsLinkOnly]=src.[IsLinkOnly],
		[ProgramAgencyNamePublic]=src.[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic]=src.[SiteAgencyNamePublic],
		[Categories]=src.[Categories],
		[TaxonomyTerm]=src.[TaxonomyTerm],
		[TaxonomyTerms]=src.[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated]=src.[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes]=src.[TaxonomyCodes],
		[Coverage]=src.[Coverage],
		[Hours]=src.[Hours],
		[Custom_Public Comments]=src.[Custom_Public Comments],
		[Custom_Former Names]=src.[Custom_Former Names],
		[Custom_Legal Name]=src.[Custom_Legal Name],
		[Custom_Facebook]=src.[Custom_Facebook],
		[Custom_Instagram]=src.[Custom_Instagram],
		[Custom_LinkedIn]=src.[Custom_LinkedIn],
		[Custom_Twitter]=src.[Custom_Twitter],
		[Custom_YouTube]=src.[Custom_YouTube],
		[Custom_Minimum Age]=src.[Custom_Minimum Age],
		[Custom_Maximum Age]=src.[Custom_Maximum Age],
		[dst].[DATE_MODIFIED]=GETDATE(),
		ORG_LEVEL_1=src.ORG_LEVEL_1,
		ORG_DESCRIPTION=src.ORG_DESCRIPTION,
		LOCATION_NAME=src.LOCATION_NAME,
		LOCATION_DESCRIPTION=src.LOCATION_DESCRIPTION,
		SERVICE_NAME_LEVEL_1=src.SERVICE_NAME_LEVEL_1,
		SERVICE_NAME_LEVEL_2=src.SERVICE_NAME_LEVEL_2,
		DESCRIPTION=src.DESCRIPTION,
		dst.ORG_LOCATION_SERVICE='SERVICE',
		dst.DELETION_DATE=src.DELETION_DATE
WHEN NOT MATCHED BY TARGET AND src.TaxonomyLevelName='ProgramAtSite' THEN
	INSERT (
		[ResourceAgencyNum],
		[LangID],
		[PublicName],
		[AlternateName],
		[OfficialName],
		[TaxonomyLevelName],
		[ParentAgency],
		[ParentAgencyNum],
		[RECORD_OWNER],
		[UniqueIDPriorSystem],
		[MailingAttentionName],
		[MailingAddress1],
		[MailingAddress2],
		[MailingCity],
		[MailingStateProvince],
		[MailingPostalCode],
		[MailingCountry],
		[MailingAddressIsPrivate],
		[PhysicalAddress1],
		[PhysicalAddress2],
		[PhysicalCity],
		[PhysicalCounty],
		[PhysicalStateProvince],
		[PhysicalPostalCode],
		[PhysicalCountry],
		[PhysicalAddressIsPrivate],
		[OtherAddress1],
		[OtherAddress2],
		[OtherCity],
		[OtherCounty],
		[OtherStateProvince],
		[OtherPostalCode],
		[OtherCountry],
		[Latitude],
		[Longitude],
		[HoursOfOperation],
		[Phone1Number],
		[Phone1Name],
		[Phone1Description],
		[Phone1IsPrivate],
		[Phone1Type],
		[Phone2Number],
		[Phone2Name],
		[Phone2Description],
		[Phone2IsPrivate],
		[Phone2Type],
		[Phone3Number],
		[Phone3Name],
		[Phone3Description],
		[Phone3IsPrivate],
		[Phone3Type],
		[Phone4Number],
		[Phone4Name],
		[Phone4Description],
		[Phone4IsPrivate],
		[Phone4Type],
		[Phone5Number],
		[Phone5name],
		[Phone5Description],
		[Phone5IsPrivate],
		[Phone5Type],
		[PhoneFax],
		[PhoneFaxDescription],
		[PhoneFaxIsPrivate],
		[PhoneTTY],
		[PhoneTTYDescription],
		[PhoneTTYIsPrivate],
		[PhoneTollFree],
		[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline],
		[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain],
		[WebsiteAddress],
		[AgencyStatus],
		[AgencyClassification],
		[CoverageArea],
		[CoverageAreaText],
		[Eligibility],
		[EligibilityAdult],
		[EligibilityChild],
		[EligibilityFamily],
		[EligibilityFemale],
		[EligibilityMale],
		[EligibilityTeen],
		[SeniorWorkerName],
		[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate],
		[MainContactName],
		[MainContactTitle],
		[MainContactEmailAddress],
		[MainContactPhoneNumber],
		[MainContactType],
		[MainContactIsPrivate],
		[LicenseAccreditation],
		[YearIncorporated],
		[AnnualBudgetTotal],
		[LegalStatus],
		[SourceOfFunds],
		[ExcludeFromWebsite],
		[ExcludeFromDirectory],
		[DisabilitiesAccess],
		[PhysicalLocationDescription],
		[BusServiceAccess],
		[PublicAccessTransportation],
		[PaymentMethods],
		[FeeStructureSource],
		[ApplicationProcess],
		[ResourceInfo],
		[DocumentsRequired],
		[LanguagesOffered],
		[LanguagesOfferedList],
		[AvailabilityNumberOfTimes],
		[AvailabilityFrequency],
		[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability],
		[CapacityType],
		[ServiceCapacity],
		[NormalWaitTime],
		[TemporaryMessage],
		[TemporaryMessageAppears],
		[TemporaryMessageExpires],
		[EnteredOn],
		[UpdatedOn],
		[MadeInactiveOn],
		[InternalNotes],
		[InternalNotesForEditorsAndViewers],
		[HighlightedResource],
		[LastVerifiedOn],
		[LastVerifiedByName],
		[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy],
		[AvailableForDirectory],
		[AvailableForReferral],
		[AvailableForResearch],
		[PreferredProvider],
		[ConnectsToSiteNum],
		[ConnectsToProgramNum],
		[LanguageOfRecord],
		[CurrentWorkflowStepCode],
		[VolunteerOpportunities],
		[VolunteerDuties],
		[IsLinkOnly],
		[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic],
		[Categories],
		[TaxonomyTerm],
		[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes],
		[Coverage],
		[Hours],
		[Custom_Public Comments],
		[Custom_Former Names],
		[Custom_Legal Name],
		[Custom_Facebook],
		[Custom_Instagram],
		[Custom_LinkedIn],
		[Custom_Twitter],
		[Custom_YouTube],
		[Custom_Minimum Age],
		[Custom_Maximum Age],
		[DATE_MODIFIED],
		ORG_LEVEL_1,
		ORG_DESCRIPTION,
		LOCATION_NAME,
		LOCATION_DESCRIPTION,
		SERVICE_NAME_LEVEL_1,
		SERVICE_NAME_LEVEL_2,
		DESCRIPTION,
		ORG_LOCATION_SERVICE,
		DELETION_DATE
	) VALUES (
		src.[ResourceAgencyNum],
		src.LangID,
		src.[PublicName],
		src.[AlternateName],
		src.[OfficialName],
		src.[TaxonomyLevelName],
		src.[ParentAgency],
		src.[ParentAgencyNum],
		src.[RECORD_OWNER],
		src.[UniqueIDPriorSystem],
		src.[MailingAttentionName],
		src.[MailingAddress1],
		src.[MailingAddress2],
		src.[MailingCity],
		src.[MailingStateProvince],
		src.[MailingPostalCode],
		src.[MailingCountry],
		src.[MailingAddressIsPrivate],
		src.[PhysicalAddress1],
		src.[PhysicalAddress2],
		src.[PhysicalCity],
		src.[PhysicalCounty],
		src.[PhysicalStateProvince],
		src.[PhysicalPostalCode],
		src.[PhysicalCountry],
		src.[PhysicalAddressIsPrivate],
		src.[OtherAddress1],
		src.[OtherAddress2],
		src.[OtherCity],
		src.[OtherCounty],
		src.[OtherStateProvince],
		src.[OtherPostalCode],
		src.[OtherCountry],
		src.[Latitude],
		src.[Longitude],
		src.[HoursOfOperation],
		src.[Phone1Number],
		src.[Phone1Name],
		src.[Phone1Description],
		src.[Phone1IsPrivate],
		src.[Phone1Type],
		src.[Phone2Number],
		src.[Phone2Name],
		src.[Phone2Description],
		src.[Phone2IsPrivate],
		src.[Phone2Type],
		src.[Phone3Number],
		src.[Phone3Name],
		src.[Phone3Description],
		src.[Phone3IsPrivate],
		src.[Phone3Type],
		src.[Phone4Number],
		src.[Phone4Name],
		src.[Phone4Description],
		src.[Phone4IsPrivate],
		src.[Phone4Type],
		src.[Phone5Number],
		src.[Phone5name],
		src.[Phone5Description],
		src.[Phone5IsPrivate],
		src.[Phone5Type],
		src.[PhoneFax],
		src.[PhoneFaxDescription],
		src.[PhoneFaxIsPrivate],
		src.[PhoneTTY],
		src.[PhoneTTYDescription],
		src.[PhoneTTYIsPrivate],
		src.[PhoneTollFree],
		src.[PhoneTollFreeDescription],
		src.[PhoneTollFreeIsPrivate],
		src.[PhoneNumberHotline],
		src.[PhoneNumberHotlineDescription],
		src.[PhoneNumberHotlineIsPrivate],
		src.[PhoneNumberBusinessLine],
		src.[PhoneNumberBusinessLineDescription],
		src.[PhoneNumberBusinessLineIsPrivate],
		src.[PhoneNumberOutOfArea],
		src.[PhoneNumberOutOfAreaDescription],
		src.[PhoneNumberOutOfAreaIsPrivate],
		src.[PhoneNumberAfterHours],
		src.[PhoneNumberAfterHoursDescription],
		src.[PhoneNumberAfterHoursIsPrivate],
		src.[EmailAddressMain],
		src.[WebsiteAddress],
		src.[AgencyStatus],
		src.[AgencyClassification],
		src.[CoverageArea],
		src.[CoverageAreaText],
		src.[Eligibility],
		src.[EligibilityAdult],
		src.[EligibilityChild],
		src.[EligibilityFamily],
		src.[EligibilityFemale],
		src.[EligibilityMale],
		src.[EligibilityTeen],
		src.[SeniorWorkerName],
		src.[SeniorWorkerTitle],
		src.[SeniorWorkerEmailAddress],
		src.[SeniorWorkerPhoneNumber],
		src.[SeniorWorkerIsPrivate],
		src.[MainContactName],
		src.[MainContactTitle],
		src.[MainContactEmailAddress],
		src.[MainContactPhoneNumber],
		src.[MainContactType],
		src.[MainContactIsPrivate],
		src.[LicenseAccreditation],
		src.[YearIncorporated],
		src.[AnnualBudgetTotal],
		src.[LegalStatus],
		src.[SourceOfFunds],
		src.[ExcludeFromWebsite],
		src.[ExcludeFromDirectory],
		src.[DisabilitiesAccess],
		src.[PhysicalLocationDescription],
		src.[BusServiceAccess],
		src.[PublicAccessTransportation],
		src.[PaymentMethods],
		src.[FeeStructureSource],
		src.[ApplicationProcess],
		src.[ResourceInfo],
		src.[DocumentsRequired],
		src.[LanguagesOffered],
		src.[LanguagesOfferedList],
		src.[AvailabilityNumberOfTimes],
		src.[AvailabilityFrequency],
		src.[AvailabilityPeriod],
		src.[ServiceNotAlwaysAvailability],
		src.[CapacityType],
		src.[ServiceCapacity],
		src.[NormalWaitTime],
		src.[TemporaryMessage],
		src.[TemporaryMessageAppears],
		src.[TemporaryMessageExpires],
		src.[EnteredOn],
		src.[UpdatedOn],
		src.[MadeInactiveOn],
		src.[InternalNotes],
		src.[InternalNotesForEditorsAndViewers],
		src.[HighlightedResource],
		src.[LastVerifiedOn],
		src.[LastVerifiedByName],
		src.[LastVerifiedByTitle],
		src.[LastVerifiedByPhoneNumber],
		src.[LastVerifiedByEmailAddress],
		src.[LastVerificationApprovedBy],
		src.[AvailableForDirectory],
		src.[AvailableForReferral],
		src.[AvailableForResearch],
		src.[PreferredProvider],
		src.[ConnectsToSiteNum],
		src.[ConnectsToProgramNum],
		src.[LanguageOfRecord],
		src.[CurrentWorkflowStepCode],
		src.[VolunteerOpportunities],
		src.[VolunteerDuties],
		src.[IsLinkOnly],
		src.[ProgramAgencyNamePublic],
		src.[SiteAgencyNamePublic],
		src.[Categories],
		src.[TaxonomyTerm],
		src.[TaxonomyTerms],
		src.[TaxonomyTermsNotDeactivated],
		src.[TaxonomyCodes],
		src.[Coverage],
		src.[Hours],
		src.[Custom_Public Comments],
		src.[Custom_Former Names],
		src.[Custom_Legal Name],
		src.[Custom_Facebook],
		src.[Custom_Instagram],
		src.[Custom_LinkedIn],
		src.[Custom_Twitter],
		src.[Custom_YouTube],
		src.[Custom_Minimum Age],
		src.[Custom_Maximum Age],
		GETDATE(),
		src.ORG_LEVEL_1,
		src.ORG_DESCRIPTION,
		src.LOCATION_NAME,
		src.LOCATION_DESCRIPTION,
		src.SERVICE_NAME_LEVEL_1,
		src.SERVICE_NAME_LEVEL_2,
		src.DESCRIPTION,
		'SERVICE',
		src.DELETION_DATE
	)
OPTION (ROBUST PLAN)
	;

MERGE INTO dbo.CIC_iCarolImportRollup dst
USING (
SELECT 
		(
			SELECT MAX(SYNC_DATE)
			FROM (
				(SELECT SYNC_DATE FROM ( VALUES (s.SYNC_DATE),(a.SYNC_DATE) ) AS i(SYNC_DATE)
				UNION SELECT ISNULL(irr.DELETION_DATE, irr.DATE_MODIFIED) AS SYNC_DATE
				FROM  dbo.CIC_iCarolImportRollup irr WHERE irr.ConnectsToSiteNum=s.ResourceAgencyNum AND irr.TaxonomyLevelName='ProgramAtSite'
				)
			) AS s
		) AS SYNC_DATE,
		COALESCE(s.[ResourceAgencyNum], a.[ResourceAgencyNum]) AS [ResourceAgencyNum],
		COALESCE(s.[LangID], a.[LangID]) AS [LangID],
		COALESCE(s.[PublicName], a.[PublicName]) AS [PublicName],
		COALESCE(s.[AlternateName], a.[AlternateName]) AS [AlternateName],
		COALESCE(s.[OfficialName], a.[OfficialName]) AS [OfficialName],
		COALESCE(s.[TaxonomyLevelName], a.[TaxonomyLevelName]) AS [TaxonomyLevelName],
		COALESCE(s.[ParentAgency], a.[ParentAgency]) AS [ParentAgency],
		COALESCE(s.[ParentAgencyNum], a.[ParentAgencyNum]) AS [ParentAgencyNum],
		s.[Custom_Record Owner (controlled)] AS [RECORD_OWNER],
		COALESCE(s.[UniqueIDPriorSystem], a.[UniqueIDPriorSystem]) AS [UniqueIDPriorSystem],
		CASE WHEN s.[MailingAttentionName] IS NOT NULL THEN s.[MailingAttentionName] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingAttentionName]  IS NOT NULL THEN a.[MailingAttentionName]  ELSE NULL END AS [MailingAttentionName],
		CASE WHEN s.[MailingAddress1] IS NOT NULL THEN s.[MailingAddress1] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingAddress1]  IS NOT NULL THEN a.[MailingAddress1]  ELSE NULL END AS [MailingAddress1],
		CASE WHEN s.[MailingAddress2] IS NOT NULL THEN s.[MailingAddress2] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingAddress2]  IS NOT NULL THEN a.[MailingAddress2]  ELSE NULL END AS [MailingAddress2],
		CASE WHEN s.[MailingCity] IS NOT NULL THEN s.[MailingCity] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingCity]  IS NOT NULL THEN a.[MailingCity]  ELSE NULL END AS [MailingCity],
		CASE WHEN s.[MailingStateProvince] IS NOT NULL THEN s.[MailingStateProvince] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingStateProvince]  IS NOT NULL THEN a.[MailingStateProvince]  ELSE NULL END AS [MailingStateProvince],
		CASE WHEN s.[MailingPostalCode] IS NOT NULL THEN s.[MailingPostalCode] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingPostalCode]  IS NOT NULL THEN a.[MailingPostalCode]  ELSE NULL END AS [MailingPostalCode],
		CASE WHEN s.[MailingCountry] IS NOT NULL THEN s.[MailingCountry] WHEN a.[MailingAddressIsPrivate] = 'Yes' AND a.[MailingCountry]  IS NOT NULL THEN a.[MailingCountry]  ELSE NULL END AS [MailingCountry],
		COALESCE(s.[MailingAddressIsPrivate], a.[MailingAddressIsPrivate]) AS [MailingAddressIsPrivate],
		CASE WHEN s.[PhysicalAddress1] IS NOT NULL THEN s.[PhysicalAddress1] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalAddress1]  IS NOT NULL THEN a.[PhysicalAddress1]  ELSE NULL END AS [PhysicalAddress1],
		CASE WHEN s.[PhysicalAddress2] IS NOT NULL THEN s.[PhysicalAddress2] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalAddress2]  IS NOT NULL THEN a.[PhysicalAddress2]  ELSE NULL END AS [PhysicalAddress2],
		CASE WHEN s.[PhysicalCity] IS NOT NULL THEN s.[PhysicalCity] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalCity]  IS NOT NULL THEN a.[PhysicalCity]  ELSE NULL END AS [PhysicalCity],
		CASE WHEN s.[PhysicalCounty] IS NOT NULL THEN s.[PhysicalCounty] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalCounty]  IS NOT NULL THEN a.[PhysicalCounty]  ELSE NULL END AS [PhysicalCounty],
		CASE WHEN s.[PhysicalStateProvince] IS NOT NULL THEN s.[PhysicalStateProvince] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalStateProvince]  IS NOT NULL THEN a.[PhysicalStateProvince]  ELSE NULL END AS [PhysicalStateProvince],
		CASE WHEN s.[PhysicalPostalCode] IS NOT NULL THEN s.[PhysicalPostalCode] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalPostalCode]  IS NOT NULL THEN a.[PhysicalPostalCode]  ELSE NULL END AS [PhysicalPostalCode],
		CASE WHEN s.[PhysicalCountry] IS NOT NULL THEN s.[PhysicalCountry] WHEN a.[PhysicalAddressIsPrivate] = 'Yes' AND a.[PhysicalCountry]  IS NOT NULL THEN a.[PhysicalCountry]  ELSE NULL END AS [PhysicalCountry],
		COALESCE(s.[PhysicalAddressIsPrivate], a.[PhysicalAddressIsPrivate]) AS [PhysicalAddressIsPrivate],
		COALESCE(s.[OtherAddress1], a.[OtherAddress1]) AS [OtherAddress1],
		COALESCE(s.[OtherAddress2], a.[OtherAddress2]) AS [OtherAddress2],
		COALESCE(s.[OtherCity], a.[OtherCity]) AS [OtherCity],
		COALESCE(s.[OtherCounty], a.[OtherCounty]) AS [OtherCounty],
		COALESCE(s.[OtherStateProvince], a.[OtherStateProvince]) AS [OtherStateProvince],
		COALESCE(s.[OtherPostalCode], a.[OtherPostalCode]) AS [OtherPostalCode],
		COALESCE(s.[OtherCountry], a.[OtherCountry]) AS [OtherCountry],
		COALESCE(CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Latitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Latitude],'0') END) AS [Latitude],
		COALESCE(CASE WHEN s.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(s.[Longitude],'0') END, CASE WHEN a.PhysicalAddressIsPrivate = 'Yes' THEN NULL ELSE NULLIF(a.[Longitude],'0') END) AS [Longitude],
		COALESCE(s.[HoursOfOperation], a.[HoursOfOperation]) AS [HoursOfOperation],
		CASE WHEN s.[Phone1Number] IS NOT NULL THEN s.[Phone1Number] WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Number]  IS NOT NULL THEN a.[Phone1Number]  ELSE NULL END AS [Phone1Number],
		CASE WHEN s.[Phone1Name] IS NOT NULL THEN s.[Phone1Name] WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Name]  IS NOT NULL THEN a.[Phone1Name]  ELSE NULL END AS [Phone1Name],
		CASE WHEN s.[Phone1Description] IS NOT NULL THEN s.[Phone1Description] WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Description]  IS NOT NULL THEN a.[Phone1Description]  ELSE NULL END AS [Phone1Description],
		COALESCE(s.[Phone1IsPrivate], a.[Phone1IsPrivate]) AS [Phone1IsPrivate],
		CASE WHEN s.[Phone1Type] IS NOT NULL THEN s.[Phone1Type] WHEN a.[Phone1IsPrivate] = 'True' AND a.[Phone1Type]  IS NOT NULL THEN a.[Phone1Type]  ELSE NULL END AS [Phone1Type],
		CASE WHEN s.[Phone2Number] IS NOT NULL THEN s.[Phone2Number] WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Number]  IS NOT NULL THEN a.[Phone2Number]  ELSE NULL END AS [Phone2Number],
		CASE WHEN s.[Phone2Name] IS NOT NULL THEN s.[Phone2Name] WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Name]  IS NOT NULL THEN a.[Phone2Name]  ELSE NULL END AS [Phone2Name],
		CASE WHEN s.[Phone2Description] IS NOT NULL THEN s.[Phone2Description] WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Description]  IS NOT NULL THEN a.[Phone2Description]  ELSE NULL END AS [Phone2Description],
		COALESCE(s.[Phone2IsPrivate], a.[Phone2IsPrivate]) AS [Phone2IsPrivate],
		CASE WHEN s.[Phone2Type] IS NOT NULL THEN s.[Phone2Type] WHEN a.[Phone2IsPrivate] = 'True' AND a.[Phone2Type]  IS NOT NULL THEN a.[Phone2Type]  ELSE NULL END AS [Phone2Type],
		CASE WHEN s.[Phone3Number] IS NOT NULL THEN s.[Phone3Number] WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Number]  IS NOT NULL THEN a.[Phone3Number]  ELSE NULL END AS [Phone3Number],
		CASE WHEN s.[Phone3Name] IS NOT NULL THEN s.[Phone3Name] WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Name]  IS NOT NULL THEN a.[Phone3Name]  ELSE NULL END AS [Phone3Name],
		CASE WHEN s.[Phone3Description] IS NOT NULL THEN s.[Phone3Description] WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Description]  IS NOT NULL THEN a.[Phone3Description]  ELSE NULL END AS [Phone3Description],
		COALESCE(s.[Phone3IsPrivate], a.[Phone3IsPrivate]) AS [Phone3IsPrivate],
		CASE WHEN s.[Phone3Type] IS NOT NULL THEN s.[Phone3Type] WHEN a.[Phone3IsPrivate] = 'True' AND a.[Phone3Type]  IS NOT NULL THEN a.[Phone3Type]  ELSE NULL END AS [Phone3Type],
		CASE WHEN s.[Phone4Number] IS NOT NULL THEN s.[Phone4Number] WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Number]  IS NOT NULL THEN a.[Phone4Number]  ELSE NULL END AS [Phone4Number],
		CASE WHEN s.[Phone4Name] IS NOT NULL THEN s.[Phone4Name] WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Name]  IS NOT NULL THEN a.[Phone4Name]  ELSE NULL END AS [Phone4Name],
		CASE WHEN s.[Phone4Description] IS NOT NULL THEN s.[Phone4Description] WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Description]  IS NOT NULL THEN a.[Phone4Description]  ELSE NULL END AS [Phone4Description],
		COALESCE(s.[Phone4IsPrivate], a.[Phone4IsPrivate]) AS [Phone4IsPrivate],
		CASE WHEN s.[Phone4Type] IS NOT NULL THEN s.[Phone4Type] WHEN a.[Phone4IsPrivate] = 'True' AND a.[Phone4Type]  IS NOT NULL THEN a.[Phone4Type]  ELSE NULL END AS [Phone4Type],
		CASE WHEN s.[Phone5Number] IS NOT NULL THEN s.[Phone5Number] WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5Number]  IS NOT NULL THEN a.[Phone5Number]  ELSE NULL END AS [Phone5Number],
		CASE WHEN s.[Phone5name] IS NOT NULL THEN s.[Phone5name] WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5name]  IS NOT NULL THEN a.[Phone5name]  ELSE NULL END AS [Phone5name],
		CASE WHEN s.[Phone5Description] IS NOT NULL THEN s.[Phone5Description] WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5Description]  IS NOT NULL THEN a.[Phone5Description]  ELSE NULL END AS [Phone5Description],
		COALESCE(s.[Phone5IsPrivate], a.[Phone5IsPrivate]) AS [Phone5IsPrivate],
		CASE WHEN s.[Phone5Type] IS NOT NULL THEN s.[Phone5Type] WHEN a.[Phone5IsPrivate] = 'True' AND a.[Phone5Type]  IS NOT NULL THEN a.[Phone5Type]  ELSE NULL END AS [Phone5Type],
		CASE WHEN s.[PhoneFax] IS NOT NULL THEN s.[PhoneFax] WHEN a.[PhoneFaxIsPrivate] = 'True' AND a.[PhoneFax]  IS NOT NULL THEN a.[PhoneFax]  ELSE NULL END AS [PhoneFax],
		CASE WHEN s.[PhoneFaxDescription] IS NOT NULL THEN s.[PhoneFaxDescription] WHEN a.[PhoneFaxIsPrivate] = 'True' AND a.[PhoneFaxDescription]  IS NOT NULL THEN a.[PhoneFaxDescription]  ELSE NULL END AS [PhoneFaxDescription],
		COALESCE(s.[PhoneFaxIsPrivate], a.[PhoneFaxIsPrivate]) AS [PhoneFaxIsPrivate],
		CASE WHEN s.[PhoneTTY] IS NOT NULL THEN s.[PhoneTTY] WHEN a.[PhoneTTYIsPrivate] = 'True' AND a.[PhoneTTY]  IS NOT NULL THEN a.[PhoneTTY]  ELSE NULL END AS [PhoneTTY],
		CASE WHEN s.[PhoneTTYDescription] IS NOT NULL THEN s.[PhoneTTYDescription] WHEN a.[PhoneTTYIsPrivate] = 'True' AND a.[PhoneTTYDescription]  IS NOT NULL THEN a.[PhoneTTYDescription]  ELSE NULL END AS [PhoneTTYDescription],
		COALESCE(s.[PhoneTTYIsPrivate], a.[PhoneTTYIsPrivate]) AS [PhoneTTYIsPrivate],
		CASE WHEN s.[PhoneTollFree] IS NOT NULL THEN s.[PhoneTollFree] WHEN a.[PhoneTollFreeIsPrivate] = 'True' AND a.[PhoneTollFree]  IS NOT NULL THEN a.[PhoneTollFree]  ELSE NULL END AS [PhoneTollFree],
		CASE WHEN s.[PhoneTollFreeDescription] IS NOT NULL THEN s.[PhoneTollFreeDescription] WHEN a.[PhoneTollFreeIsPrivate] = 'True' AND a.[PhoneTollFreeDescription]  IS NOT NULL THEN a.[PhoneTollFreeDescription]  ELSE NULL END AS [PhoneTollFreeDescription],
		COALESCE(s.[PhoneTollFreeIsPrivate], a.[PhoneTollFreeIsPrivate]) AS [PhoneTollFreeIsPrivate],
		CASE WHEN s.[PhoneNumberHotline] IS NOT NULL THEN s.[PhoneNumberHotline] WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' AND a.[PhoneNumberHotline]  IS NOT NULL THEN a.[PhoneNumberHotline]  ELSE NULL END AS [PhoneNumberHotline],
		CASE WHEN s.[PhoneNumberHotlineDescription] IS NOT NULL THEN s.[PhoneNumberHotlineDescription] WHEN a.[PhoneNumberHotlineIsPrivate] = 'True' AND a.[PhoneNumberHotlineDescription]  IS NOT NULL THEN a.[PhoneNumberHotlineDescription]  ELSE NULL END AS [PhoneNumberHotlineDescription],
		COALESCE(s.[PhoneNumberHotlineIsPrivate], a.[PhoneNumberHotlineIsPrivate]) AS [PhoneNumberHotlineIsPrivate],
		CASE WHEN s.[PhoneNumberBusinessLine] IS NOT NULL THEN s.[PhoneNumberBusinessLine] WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' AND a.[PhoneNumberBusinessLine]  IS NOT NULL THEN a.[PhoneNumberBusinessLine]  ELSE NULL END AS [PhoneNumberBusinessLine],
		CASE WHEN s.[PhoneNumberBusinessLineDescription] IS NOT NULL THEN s.[PhoneNumberBusinessLineDescription] WHEN a.[PhoneNumberBusinessLineIsPrivate] = 'True' AND a.[PhoneNumberBusinessLineDescription]  IS NOT NULL THEN a.[PhoneNumberBusinessLineDescription]  ELSE NULL END AS [PhoneNumberBusinessLineDescription],
		COALESCE(s.[PhoneNumberBusinessLineIsPrivate], a.[PhoneNumberBusinessLineIsPrivate]) AS [PhoneNumberBusinessLineIsPrivate],
		CASE WHEN s.[PhoneNumberOutOfArea] IS NOT NULL THEN s.[PhoneNumberOutOfArea] WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND a.[PhoneNumberOutOfArea]  IS NOT NULL THEN a.[PhoneNumberOutOfArea]  ELSE NULL END AS [PhoneNumberOutOfArea],
		CASE WHEN s.[PhoneNumberOutOfAreaDescription] IS NOT NULL THEN s.[PhoneNumberOutOfAreaDescription] WHEN a.[PhoneNumberOutOfAreaIsPrivate] = 'True' AND a.[PhoneNumberOutOfAreaDescription]  IS NOT NULL THEN a.[PhoneNumberOutOfAreaDescription]  ELSE NULL END AS [PhoneNumberOutOfAreaDescription],
		COALESCE(s.[PhoneNumberOutOfAreaIsPrivate], a.[PhoneNumberOutOfAreaIsPrivate]) AS [PhoneNumberOutOfAreaIsPrivate],
		CASE WHEN s.[PhoneNumberAfterHours] IS NOT NULL THEN s.[PhoneNumberAfterHours] WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' AND a.[PhoneNumberAfterHours]  IS NOT NULL THEN a.[PhoneNumberAfterHours]  ELSE NULL END AS [PhoneNumberAfterHours],
		CASE WHEN s.[PhoneNumberAfterHoursDescription] IS NOT NULL THEN s.[PhoneNumberAfterHoursDescription] WHEN a.[PhoneNumberAfterHoursIsPrivate] = 'True' AND a.[PhoneNumberAfterHoursDescription]  IS NOT NULL THEN a.[PhoneNumberAfterHoursDescription]  ELSE NULL END AS [PhoneNumberAfterHoursDescription],
		COALESCE(s.[PhoneNumberAfterHoursIsPrivate], a.[PhoneNumberAfterHoursIsPrivate]) AS [PhoneNumberAfterHoursIsPrivate],
		COALESCE(s.[EmailAddressMain], a.[EmailAddressMain]) AS [EmailAddressMain],
		COALESCE(s.[WebsiteAddress], a.[WebsiteAddress]) AS [WebsiteAddress],
		COALESCE(s.[AgencyStatus], a.[AgencyStatus]) AS [AgencyStatus],
		COALESCE(s.[AgencyClassification], a.[AgencyClassification]) AS [AgencyClassification],
		COALESCE(s.[CoverageArea], a.[CoverageArea]) AS [CoverageArea],
		COALESCE(s.[CoverageAreaText], a.[CoverageAreaText]) AS [CoverageAreaText],
		COALESCE(s.[Eligibility], a.[Eligibility]) AS [Eligibility],
		COALESCE(s.[EligibilityAdult], a.[EligibilityAdult]) AS [EligibilityAdult],
		COALESCE(s.[EligibilityChild], a.[EligibilityChild]) AS [EligibilityChild],
		COALESCE(s.[EligibilityFamily], a.[EligibilityFamily]) AS [EligibilityFamily],
		COALESCE(s.[EligibilityFemale], a.[EligibilityFemale]) AS [EligibilityFemale],
		COALESCE(s.[EligibilityMale], a.[EligibilityMale]) AS [EligibilityMale],
		COALESCE(s.[EligibilityTeen], a.[EligibilityTeen]) AS [EligibilityTeen],
		CASE WHEN s.[SeniorWorkerName] IS NOT NULL THEN s.[SeniorWorkerName] WHEN a.[SeniorWorkerIsPrivate] = 'Yes' AND a.[SeniorWorkerName]  IS NOT NULL THEN a.[SeniorWorkerName]  ELSE NULL END AS [SeniorWorkerName],
		CASE WHEN s.[SeniorWorkerTitle] IS NOT NULL THEN s.[SeniorWorkerTitle] WHEN a.[SeniorWorkerIsPrivate] = 'Yes' AND a.[SeniorWorkerTitle]  IS NOT NULL THEN a.[SeniorWorkerTitle]  ELSE NULL END AS [SeniorWorkerTitle],
		CASE WHEN s.[SeniorWorkerEmailAddress] IS NOT NULL THEN s.[SeniorWorkerEmailAddress] WHEN a.[SeniorWorkerIsPrivate] = 'Yes' AND a.[SeniorWorkerEmailAddress]  IS NOT NULL THEN a.[SeniorWorkerEmailAddress]  ELSE NULL END AS [SeniorWorkerEmailAddress],
		CASE WHEN s.[SeniorWorkerPhoneNumber] IS NOT NULL THEN s.[SeniorWorkerPhoneNumber] WHEN a.[SeniorWorkerIsPrivate] = 'Yes' AND a.[SeniorWorkerPhoneNumber]  IS NOT NULL THEN a.[SeniorWorkerPhoneNumber]  ELSE NULL END AS [SeniorWorkerPhoneNumber],
		COALESCE(s.[SeniorWorkerIsPrivate], a.[SeniorWorkerIsPrivate]) AS [SeniorWorkerIsPrivate],
		CASE WHEN s.[MainContactName] IS NOT NULL THEN s.[MainContactName] WHEN a.[MainContactIsPrivate] = 'Yes' AND a.[MainContactName]  IS NOT NULL THEN a.[MainContactName]  ELSE NULL END AS [MainContactName],
		CASE WHEN s.[MainContactTitle] IS NOT NULL THEN s.[MainContactTitle] WHEN a.[MainContactIsPrivate] = 'Yes' AND a.[MainContactTitle]  IS NOT NULL THEN a.[MainContactTitle]  ELSE NULL END AS [MainContactTitle],
		CASE WHEN s.[MainContactEmailAddress] IS NOT NULL THEN s.[MainContactEmailAddress] WHEN a.[MainContactIsPrivate] = 'Yes' AND a.[MainContactEmailAddress]  IS NOT NULL THEN a.[MainContactEmailAddress]  ELSE NULL END AS [MainContactEmailAddress],
		CASE WHEN s.[MainContactPhoneNumber] IS NOT NULL THEN s.[MainContactPhoneNumber] WHEN a.[MainContactIsPrivate] = 'Yes' AND a.[MainContactPhoneNumber]  IS NOT NULL THEN a.[MainContactPhoneNumber]  ELSE NULL END AS [MainContactPhoneNumber],
		CASE WHEN s.[MainContactType] IS NOT NULL THEN s.[MainContactType] WHEN a.[MainContactIsPrivate] = 'Yes' AND a.[MainContactType]  IS NOT NULL THEN a.[MainContactType]  ELSE NULL END AS [MainContactType],
		COALESCE(s.[MainContactIsPrivate], a.[MainContactIsPrivate]) AS [MainContactIsPrivate],
		COALESCE(s.[LicenseAccreditation], a.[LicenseAccreditation]) AS [LicenseAccreditation],
		COALESCE(s.[YearIncorporated], a.[YearIncorporated]) AS [YearIncorporated],
		COALESCE(s.[AnnualBudgetTotal], a.[AnnualBudgetTotal]) AS [AnnualBudgetTotal],
		COALESCE(s.[LegalStatus], a.[LegalStatus]) AS [LegalStatus],
		COALESCE(s.[SourceOfFunds], a.[SourceOfFunds]) AS [SourceOfFunds],
		COALESCE(s.[ExcludeFromWebsite], a.[ExcludeFromWebsite]) AS [ExcludeFromWebsite],
		COALESCE(s.[ExcludeFromDirectory], a.[ExcludeFromDirectory]) AS [ExcludeFromDirectory],
		COALESCE(s.[DisabilitiesAccess], a.[DisabilitiesAccess]) AS [DisabilitiesAccess],
		COALESCE(s.[PhysicalLocationDescription], a.[PhysicalLocationDescription]) AS [PhysicalLocationDescription],
		COALESCE(s.[BusServiceAccess], a.[BusServiceAccess]) AS [BusServiceAccess],
		COALESCE(s.[PublicAccessTransportation], a.[PublicAccessTransportation]) AS [PublicAccessTransportation],
		COALESCE(s.[PaymentMethods], a.[PaymentMethods]) AS [PaymentMethods],
		COALESCE(s.[FeeStructureSource], a.[FeeStructureSource]) AS [FeeStructureSource],
		COALESCE(s.[ApplicationProcess], a.[ApplicationProcess]) AS [ApplicationProcess],
		COALESCE(s.[ResourceInfo], a.[ResourceInfo]) AS [ResourceInfo],
		COALESCE(s.[DocumentsRequired], a.[DocumentsRequired]) AS [DocumentsRequired],
		COALESCE(s.[LanguagesOffered], a.[LanguagesOffered]) AS [LanguagesOffered],
		COALESCE(s.[LanguagesOfferedList], a.[LanguagesOfferedList]) AS [LanguagesOfferedList],
		COALESCE(s.[AvailabilityNumberOfTimes], a.[AvailabilityNumberOfTimes]) AS [AvailabilityNumberOfTimes],
		COALESCE(s.[AvailabilityFrequency], a.[AvailabilityFrequency]) AS [AvailabilityFrequency],
		COALESCE(s.[AvailabilityPeriod], a.[AvailabilityPeriod]) AS [AvailabilityPeriod],
		COALESCE(s.[ServiceNotAlwaysAvailability], a.[ServiceNotAlwaysAvailability]) AS [ServiceNotAlwaysAvailability],
		COALESCE(s.[CapacityType], a.[CapacityType]) AS [CapacityType],
		COALESCE(s.[ServiceCapacity], a.[ServiceCapacity]) AS [ServiceCapacity],
		COALESCE(s.[NormalWaitTime], a.[NormalWaitTime]) AS [NormalWaitTime],
		COALESCE(s.[TemporaryMessage], a.[TemporaryMessage]) AS [TemporaryMessage],
		COALESCE(s.[TemporaryMessageAppears], a.[TemporaryMessageAppears]) AS [TemporaryMessageAppears],
		COALESCE(s.[TemporaryMessageExpires], a.[TemporaryMessageExpires]) AS [TemporaryMessageExpires],
		COALESCE(s.[EnteredOn], a.[EnteredOn]) AS [EnteredOn],
		COALESCE(s.[UpdatedOn], a.[UpdatedOn]) AS [UpdatedOn],
		COALESCE(s.[MadeInactiveOn], a.[MadeInactiveOn]) AS [MadeInactiveOn],
		s.[InternalNotes] AS [InternalNotes],
		s.[InternalNotesForEditorsAndViewers] AS [InternalNotesForEditorsAndViewers],
		COALESCE(s.[HighlightedResource], a.[HighlightedResource]) AS [HighlightedResource],
		COALESCE(s.[LastVerifiedOn], a.[LastVerifiedOn]) AS [LastVerifiedOn],
		COALESCE(s.[LastVerifiedByName], a.[LastVerifiedByName]) AS [LastVerifiedByName],
		COALESCE(s.[LastVerifiedByTitle], a.[LastVerifiedByTitle]) AS [LastVerifiedByTitle],
		COALESCE(s.[LastVerifiedByPhoneNumber], a.[LastVerifiedByPhoneNumber]) AS [LastVerifiedByPhoneNumber],
		COALESCE(s.[LastVerifiedByEmailAddress], a.[LastVerifiedByEmailAddress]) AS [LastVerifiedByEmailAddress],
		COALESCE(s.[LastVerificationApprovedBy], a.[LastVerificationApprovedBy]) AS [LastVerificationApprovedBy],
		COALESCE(s.[AvailableForDirectory], a.[AvailableForDirectory]) AS [AvailableForDirectory],
		COALESCE(s.[AvailableForReferral], a.[AvailableForReferral]) AS [AvailableForReferral],
		COALESCE(s.[AvailableForResearch], a.[AvailableForResearch]) AS [AvailableForResearch],
		COALESCE(s.[PreferredProvider], a.[PreferredProvider]) AS [PreferredProvider],
		COALESCE(s.[ConnectsToSiteNum], a.[ConnectsToSiteNum]) AS [ConnectsToSiteNum],
		COALESCE(s.[ConnectsToProgramNum], a.[ConnectsToProgramNum]) AS [ConnectsToProgramNum],
		COALESCE(s.[LanguageOfRecord], a.[LanguageOfRecord]) AS [LanguageOfRecord],
		COALESCE(s.[CurrentWorkflowStepCode], a.[CurrentWorkflowStepCode]) AS [CurrentWorkflowStepCode],
		COALESCE(s.[VolunteerOpportunities], a.[VolunteerOpportunities]) AS [VolunteerOpportunities],
		COALESCE(s.[VolunteerDuties], a.[VolunteerDuties]) AS [VolunteerDuties],
		COALESCE(s.[IsLinkOnly], a.[IsLinkOnly]) AS [IsLinkOnly],
		COALESCE(s.[ProgramAgencyNamePublic], a.[ProgramAgencyNamePublic]) AS [ProgramAgencyNamePublic],
		COALESCE(s.[SiteAgencyNamePublic], a.[SiteAgencyNamePublic]) AS [SiteAgencyNamePublic],
		COALESCE(s.[Categories], a.[Categories]) AS [Categories],
		COALESCE(s.[TaxonomyTerm], a.[TaxonomyTerm]) AS [TaxonomyTerm],
		COALESCE(s.[TaxonomyTerms], a.[TaxonomyTerms]) AS [TaxonomyTerms],
		COALESCE(s.[TaxonomyTermsNotDeactivated], a.[TaxonomyTermsNotDeactivated]) AS [TaxonomyTermsNotDeactivated],
		COALESCE(s.[TaxonomyCodes], a.[TaxonomyCodes]) AS [TaxonomyCodes],
		COALESCE(s.[Coverage], a.[Coverage]) AS [Coverage],
		COALESCE(s.[Hours], a.[Hours]) AS [Hours],
		s.[Custom_Public Comments] AS [Custom_Public Comments],
		COALESCE(s.[Custom_Former Names], a.[Custom_Former Names]) AS [Custom_Former Names],
		COALESCE(s.[Custom_Legal Name], a.[Custom_Legal Name]) AS [Custom_Legal Name],
		COALESCE(s.[Custom_Facebook], a.[Custom_Facebook]) AS [Custom_Facebook],
		COALESCE(s.[Custom_Instagram], a.[Custom_Instagram]) AS [Custom_Instagram],
		COALESCE(s.[Custom_LinkedIn], a.[Custom_LinkedIn]) AS [Custom_LinkedIn],
		COALESCE(s.[Custom_Twitter], a.[Custom_Twitter]) AS [Custom_Twitter],
		COALESCE(s.[Custom_YouTube], a.[Custom_YouTube]) AS [Custom_YouTube],
		COALESCE(s.[Custom_Minimum Age], a.[Custom_Minimum Age]) AS [Custom_Minimum Age],
		COALESCE(s.[Custom_Maximum Age], a.[Custom_Maximum Age]) AS [Custom_Maximum Age],
		a.PublicName AS ORG_LEVEL_1,
		a.AgencyDescription AS ORG_DESCRIPTION,
		s.PublicName AS LOCATION_NAME,
		s.AgencyDescription AS LOCATION_DESCRIPTION,
		s.DELETION_DATE
FROM dbo.CIC_iCarolImport AS s
LEFT JOIN dbo.CIC_iCarolImport a
	ON s.ParentAgencyNum=a.ResourceAgencyNum AND a.TaxonomyLevelName='Agency' AND a.LangID=s.LangID
WHERE s.TaxonomyLevelName='Site'
) AS src
ON src.ResourceAgencyNum=dst.ResourceAgencyNum AND src.LangID=dst.LangID AND src.TaxonomyLevelName = 'Site'
WHEN MATCHED AND src.SYNC_DATE > dst.DATE_MODIFIED THEN 
	UPDATE SET 
		[PublicName]=src.[PublicName],
		[AlternateName]=src.[AlternateName],
		[OfficialName]=src.[OfficialName],
		[TaxonomyLevelName]=src.[TaxonomyLevelName],
		[ParentAgency]=src.[ParentAgency],
		[ParentAgencyNum]=src.[ParentAgencyNum],
		[RECORD_OWNER]=src.[RECORD_OWNER],
		[UniqueIDPriorSystem]=src.[UniqueIDPriorSystem],
		[MailingAttentionName]=src.[MailingAttentionName],
		[MailingAddress1]=src.[MailingAddress1],
		[MailingAddress2]=src.[MailingAddress2],
		[MailingCity]=src.[MailingCity],
		[MailingStateProvince]=src.[MailingStateProvince],
		[MailingPostalCode]=src.[MailingPostalCode],
		[MailingCountry]=src.[MailingCountry],
		[MailingAddressIsPrivate]=src.[MailingAddressIsPrivate],
		[PhysicalAddress1]=src.[PhysicalAddress1],
		[PhysicalAddress2]=src.[PhysicalAddress2],
		[PhysicalCity]=src.[PhysicalCity],
		[PhysicalCounty]=src.[PhysicalCounty],
		[PhysicalStateProvince]=src.[PhysicalStateProvince],
		[PhysicalPostalCode]=src.[PhysicalPostalCode],
		[PhysicalCountry]=src.[PhysicalCountry],
		[PhysicalAddressIsPrivate]=src.[PhysicalAddressIsPrivate],
		[OtherAddress1]=src.[OtherAddress1],
		[OtherAddress2]=src.[OtherAddress2],
		[OtherCity]=src.[OtherCity],
		[OtherCounty]=src.[OtherCounty],
		[OtherStateProvince]=src.[OtherStateProvince],
		[OtherPostalCode]=src.[OtherPostalCode],
		[OtherCountry]=src.[OtherCountry],
		[Latitude]=src.[Latitude],
		[Longitude]=src.[Longitude],
		[HoursOfOperation]=src.[HoursOfOperation],
		[Phone1Number]=src.[Phone1Number],
		[Phone1Name]=src.[Phone1Name],
		[Phone1Description]=src.[Phone1Description],
		[Phone1IsPrivate]=src.[Phone1IsPrivate],
		[Phone1Type]=src.[Phone1Type],
		[Phone2Number]=src.[Phone2Number],
		[Phone2Name]=src.[Phone2Name],
		[Phone2Description]=src.[Phone2Description],
		[Phone2IsPrivate]=src.[Phone2IsPrivate],
		[Phone2Type]=src.[Phone2Type],
		[Phone3Number]=src.[Phone3Number],
		[Phone3Name]=src.[Phone3Name],
		[Phone3Description]=src.[Phone3Description],
		[Phone3IsPrivate]=src.[Phone3IsPrivate],
		[Phone3Type]=src.[Phone3Type],
		[Phone4Number]=src.[Phone4Number],
		[Phone4Name]=src.[Phone4Name],
		[Phone4Description]=src.[Phone4Description],
		[Phone4IsPrivate]=src.[Phone4IsPrivate],
		[Phone4Type]=src.[Phone4Type],
		[Phone5Number]=src.[Phone5Number],
		[Phone5name]=src.[Phone5name],
		[Phone5Description]=src.[Phone5Description],
		[Phone5IsPrivate]=src.[Phone5IsPrivate],
		[Phone5Type]=src.[Phone5Type],
		[PhoneFax]=src.[PhoneFax],
		[PhoneFaxDescription]=src.[PhoneFaxDescription],
		[PhoneFaxIsPrivate]=src.[PhoneFaxIsPrivate],
		[PhoneTTY]=src.[PhoneTTY],
		[PhoneTTYDescription]=src.[PhoneTTYDescription],
		[PhoneTTYIsPrivate]=src.[PhoneTTYIsPrivate],
		[PhoneTollFree]=src.[PhoneTollFree],
		[PhoneTollFreeDescription]=src.[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate]=src.[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline]=src.[PhoneNumberHotline],
		[PhoneNumberHotlineDescription]=src.[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate]=src.[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine]=src.[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription]=src.[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate]=src.[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea]=src.[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription]=src.[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate]=src.[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours]=src.[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription]=src.[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate]=src.[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain]=src.[EmailAddressMain],
		[WebsiteAddress]=src.[WebsiteAddress],
		[AgencyStatus]=src.[AgencyStatus],
		[AgencyClassification]=src.[AgencyClassification],
		[CoverageArea]=src.[CoverageArea],
		[CoverageAreaText]=src.[CoverageAreaText],
		[Eligibility]=src.[Eligibility],
		[EligibilityAdult]=src.[EligibilityAdult],
		[EligibilityChild]=src.[EligibilityChild],
		[EligibilityFamily]=src.[EligibilityFamily],
		[EligibilityFemale]=src.[EligibilityFemale],
		[EligibilityMale]=src.[EligibilityMale],
		[EligibilityTeen]=src.[EligibilityTeen],
		[SeniorWorkerName]=src.[SeniorWorkerName],
		[SeniorWorkerTitle]=src.[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress]=src.[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber]=src.[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate]=src.[SeniorWorkerIsPrivate],
		[MainContactName]=src.[MainContactName],
		[MainContactTitle]=src.[MainContactTitle],
		[MainContactEmailAddress]=src.[MainContactEmailAddress],
		[MainContactPhoneNumber]=src.[MainContactPhoneNumber],
		[MainContactType]=src.[MainContactType],
		[MainContactIsPrivate]=src.[MainContactIsPrivate],
		[LicenseAccreditation]=src.[LicenseAccreditation],
		[YearIncorporated]=src.[YearIncorporated],
		[AnnualBudgetTotal]=src.[AnnualBudgetTotal],
		[LegalStatus]=src.[LegalStatus],
		[SourceOfFunds]=src.[SourceOfFunds],
		[ExcludeFromWebsite]=src.[ExcludeFromWebsite],
		[ExcludeFromDirectory]=src.[ExcludeFromDirectory],
		[DisabilitiesAccess]=src.[DisabilitiesAccess],
		[PhysicalLocationDescription]=src.[PhysicalLocationDescription],
		[BusServiceAccess]=src.[BusServiceAccess],
		[PublicAccessTransportation]=src.[PublicAccessTransportation],
		[PaymentMethods]=src.[PaymentMethods],
		[FeeStructureSource]=src.[FeeStructureSource],
		[ApplicationProcess]=src.[ApplicationProcess],
		[ResourceInfo]=src.[ResourceInfo],
		[DocumentsRequired]=src.[DocumentsRequired],
		[LanguagesOffered]=src.[LanguagesOffered],
		[LanguagesOfferedList]=src.[LanguagesOfferedList],
		[AvailabilityNumberOfTimes]=src.[AvailabilityNumberOfTimes],
		[AvailabilityFrequency]=src.[AvailabilityFrequency],
		[AvailabilityPeriod]=src.[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability]=src.[ServiceNotAlwaysAvailability],
		[CapacityType]=src.[CapacityType],
		[ServiceCapacity]=src.[ServiceCapacity],
		[NormalWaitTime]=src.[NormalWaitTime],
		[TemporaryMessage]=src.[TemporaryMessage],
		[TemporaryMessageAppears]=src.[TemporaryMessageAppears],
		[TemporaryMessageExpires]=src.[TemporaryMessageExpires],
		[EnteredOn]=src.[EnteredOn],
		[UpdatedOn]=src.[UpdatedOn],
		[MadeInactiveOn]=src.[MadeInactiveOn],
		[InternalNotes]=src.[InternalNotes],
		[InternalNotesForEditorsAndViewers]=src.[InternalNotesForEditorsAndViewers],
		[HighlightedResource]=src.[HighlightedResource],
		[LastVerifiedOn]=src.[LastVerifiedOn],
		[LastVerifiedByName]=src.[LastVerifiedByName],
		[LastVerifiedByTitle]=src.[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber]=src.[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress]=src.[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy]=src.[LastVerificationApprovedBy],
		[AvailableForDirectory]=src.[AvailableForDirectory],
		[AvailableForReferral]=src.[AvailableForReferral],
		[AvailableForResearch]=src.[AvailableForResearch],
		[PreferredProvider]=src.[PreferredProvider],
		[ConnectsToSiteNum]=src.[ConnectsToSiteNum],
		[ConnectsToProgramNum]=src.[ConnectsToProgramNum],
		[LanguageOfRecord]=src.[LanguageOfRecord],
		[CurrentWorkflowStepCode]=src.[CurrentWorkflowStepCode],
		[VolunteerOpportunities]=src.[VolunteerOpportunities],
		[VolunteerDuties]=src.[VolunteerDuties],
		[IsLinkOnly]=src.[IsLinkOnly],
		[ProgramAgencyNamePublic]=src.[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic]=src.[SiteAgencyNamePublic],
		[Categories]=src.[Categories],
		[TaxonomyTerm]=src.[TaxonomyTerm],
		[TaxonomyTerms]=src.[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated]=src.[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes]=src.[TaxonomyCodes],
		[Coverage]=src.[Coverage],
		[Hours]=src.[Hours],
		[Custom_Public Comments]=src.[Custom_Public Comments],
		[Custom_Former Names]=src.[Custom_Former Names],
		[Custom_Legal Name]=src.[Custom_Legal Name],
		[Custom_Facebook]=src.[Custom_Facebook],
		[Custom_Instagram]=src.[Custom_Instagram],
		[Custom_LinkedIn]=src.[Custom_LinkedIn],
		[Custom_Twitter]=src.[Custom_Twitter],
		[Custom_YouTube]=src.[Custom_YouTube],
		[Custom_Minimum Age]=src.[Custom_Minimum Age],
		[Custom_Maximum Age]=src.[Custom_Maximum Age],
		[dst].[DATE_MODIFIED]=GETDATE(),
		ORG_LEVEL_1=src.ORG_LEVEL_1,
		ORG_DESCRIPTION=src.ORG_DESCRIPTION,
		LOCATION_NAME=src.LOCATION_NAME,
		LOCATION_DESCRIPTION=src.LOCATION_DESCRIPTION,
		dst.ORG_LOCATION_SERVICE='SITE',
		dst.DELETION_DATE=src.DELETION_DATE
WHEN NOT MATCHED BY TARGET AND src.TaxonomyLevelName='Site' THEN
	INSERT (
		[ResourceAgencyNum],
		[LangID],
		[PublicName],
		[AlternateName],
		[OfficialName],
		[TaxonomyLevelName],
		[ParentAgency],
		[ParentAgencyNum],
		[RECORD_OWNER],
		[UniqueIDPriorSystem],
		[MailingAttentionName],
		[MailingAddress1],
		[MailingAddress2],
		[MailingCity],
		[MailingStateProvince],
		[MailingPostalCode],
		[MailingCountry],
		[MailingAddressIsPrivate],
		[PhysicalAddress1],
		[PhysicalAddress2],
		[PhysicalCity],
		[PhysicalCounty],
		[PhysicalStateProvince],
		[PhysicalPostalCode],
		[PhysicalCountry],
		[PhysicalAddressIsPrivate],
		[OtherAddress1],
		[OtherAddress2],
		[OtherCity],
		[OtherCounty],
		[OtherStateProvince],
		[OtherPostalCode],
		[OtherCountry],
		[Latitude],
		[Longitude],
		[HoursOfOperation],
		[Phone1Number],
		[Phone1Name],
		[Phone1Description],
		[Phone1IsPrivate],
		[Phone1Type],
		[Phone2Number],
		[Phone2Name],
		[Phone2Description],
		[Phone2IsPrivate],
		[Phone2Type],
		[Phone3Number],
		[Phone3Name],
		[Phone3Description],
		[Phone3IsPrivate],
		[Phone3Type],
		[Phone4Number],
		[Phone4Name],
		[Phone4Description],
		[Phone4IsPrivate],
		[Phone4Type],
		[Phone5Number],
		[Phone5name],
		[Phone5Description],
		[Phone5IsPrivate],
		[Phone5Type],
		[PhoneFax],
		[PhoneFaxDescription],
		[PhoneFaxIsPrivate],
		[PhoneTTY],
		[PhoneTTYDescription],
		[PhoneTTYIsPrivate],
		[PhoneTollFree],
		[PhoneTollFreeDescription],
		[PhoneTollFreeIsPrivate],
		[PhoneNumberHotline],
		[PhoneNumberHotlineDescription],
		[PhoneNumberHotlineIsPrivate],
		[PhoneNumberBusinessLine],
		[PhoneNumberBusinessLineDescription],
		[PhoneNumberBusinessLineIsPrivate],
		[PhoneNumberOutOfArea],
		[PhoneNumberOutOfAreaDescription],
		[PhoneNumberOutOfAreaIsPrivate],
		[PhoneNumberAfterHours],
		[PhoneNumberAfterHoursDescription],
		[PhoneNumberAfterHoursIsPrivate],
		[EmailAddressMain],
		[WebsiteAddress],
		[AgencyStatus],
		[AgencyClassification],
		[CoverageArea],
		[CoverageAreaText],
		[Eligibility],
		[EligibilityAdult],
		[EligibilityChild],
		[EligibilityFamily],
		[EligibilityFemale],
		[EligibilityMale],
		[EligibilityTeen],
		[SeniorWorkerName],
		[SeniorWorkerTitle],
		[SeniorWorkerEmailAddress],
		[SeniorWorkerPhoneNumber],
		[SeniorWorkerIsPrivate],
		[MainContactName],
		[MainContactTitle],
		[MainContactEmailAddress],
		[MainContactPhoneNumber],
		[MainContactType],
		[MainContactIsPrivate],
		[LicenseAccreditation],
		[YearIncorporated],
		[AnnualBudgetTotal],
		[LegalStatus],
		[SourceOfFunds],
		[ExcludeFromWebsite],
		[ExcludeFromDirectory],
		[DisabilitiesAccess],
		[PhysicalLocationDescription],
		[BusServiceAccess],
		[PublicAccessTransportation],
		[PaymentMethods],
		[FeeStructureSource],
		[ApplicationProcess],
		[ResourceInfo],
		[DocumentsRequired],
		[LanguagesOffered],
		[LanguagesOfferedList],
		[AvailabilityNumberOfTimes],
		[AvailabilityFrequency],
		[AvailabilityPeriod],
		[ServiceNotAlwaysAvailability],
		[CapacityType],
		[ServiceCapacity],
		[NormalWaitTime],
		[TemporaryMessage],
		[TemporaryMessageAppears],
		[TemporaryMessageExpires],
		[EnteredOn],
		[UpdatedOn],
		[MadeInactiveOn],
		[InternalNotes],
		[InternalNotesForEditorsAndViewers],
		[HighlightedResource],
		[LastVerifiedOn],
		[LastVerifiedByName],
		[LastVerifiedByTitle],
		[LastVerifiedByPhoneNumber],
		[LastVerifiedByEmailAddress],
		[LastVerificationApprovedBy],
		[AvailableForDirectory],
		[AvailableForReferral],
		[AvailableForResearch],
		[PreferredProvider],
		[ConnectsToSiteNum],
		[ConnectsToProgramNum],
		[LanguageOfRecord],
		[CurrentWorkflowStepCode],
		[VolunteerOpportunities],
		[VolunteerDuties],
		[IsLinkOnly],
		[ProgramAgencyNamePublic],
		[SiteAgencyNamePublic],
		[Categories],
		[TaxonomyTerm],
		[TaxonomyTerms],
		[TaxonomyTermsNotDeactivated],
		[TaxonomyCodes],
		[Coverage],
		[Hours],
		[Custom_Public Comments],
		[Custom_Former Names],
		[Custom_Legal Name],
		[Custom_Facebook],
		[Custom_Instagram],
		[Custom_LinkedIn],
		[Custom_Twitter],
		[Custom_YouTube],
		[Custom_Minimum Age],
		[Custom_Maximum Age],
		[DATE_MODIFIED],
		ORG_LEVEL_1,
		ORG_DESCRIPTION,
		LOCATION_NAME,
		LOCATION_DESCRIPTION,
		ORG_LOCATION_SERVICE,
		DELETION_DATE
	) VALUES (
		src.[ResourceAgencyNum],
		src.LangID,
		src.[PublicName],
		src.[AlternateName],
		src.[OfficialName],
		src.[TaxonomyLevelName],
		src.[ParentAgency],
		src.[ParentAgencyNum],
		src.[RECORD_OWNER],
		src.[UniqueIDPriorSystem],
		src.[MailingAttentionName],
		src.[MailingAddress1],
		src.[MailingAddress2],
		src.[MailingCity],
		src.[MailingStateProvince],
		src.[MailingPostalCode],
		src.[MailingCountry],
		src.[MailingAddressIsPrivate],
		src.[PhysicalAddress1],
		src.[PhysicalAddress2],
		src.[PhysicalCity],
		src.[PhysicalCounty],
		src.[PhysicalStateProvince],
		src.[PhysicalPostalCode],
		src.[PhysicalCountry],
		src.[PhysicalAddressIsPrivate],
		src.[OtherAddress1],
		src.[OtherAddress2],
		src.[OtherCity],
		src.[OtherCounty],
		src.[OtherStateProvince],
		src.[OtherPostalCode],
		src.[OtherCountry],
		src.[Latitude],
		src.[Longitude],
		src.[HoursOfOperation],
		src.[Phone1Number],
		src.[Phone1Name],
		src.[Phone1Description],
		src.[Phone1IsPrivate],
		src.[Phone1Type],
		src.[Phone2Number],
		src.[Phone2Name],
		src.[Phone2Description],
		src.[Phone2IsPrivate],
		src.[Phone2Type],
		src.[Phone3Number],
		src.[Phone3Name],
		src.[Phone3Description],
		src.[Phone3IsPrivate],
		src.[Phone3Type],
		src.[Phone4Number],
		src.[Phone4Name],
		src.[Phone4Description],
		src.[Phone4IsPrivate],
		src.[Phone4Type],
		src.[Phone5Number],
		src.[Phone5name],
		src.[Phone5Description],
		src.[Phone5IsPrivate],
		src.[Phone5Type],
		src.[PhoneFax],
		src.[PhoneFaxDescription],
		src.[PhoneFaxIsPrivate],
		src.[PhoneTTY],
		src.[PhoneTTYDescription],
		src.[PhoneTTYIsPrivate],
		src.[PhoneTollFree],
		src.[PhoneTollFreeDescription],
		src.[PhoneTollFreeIsPrivate],
		src.[PhoneNumberHotline],
		src.[PhoneNumberHotlineDescription],
		src.[PhoneNumberHotlineIsPrivate],
		src.[PhoneNumberBusinessLine],
		src.[PhoneNumberBusinessLineDescription],
		src.[PhoneNumberBusinessLineIsPrivate],
		src.[PhoneNumberOutOfArea],
		src.[PhoneNumberOutOfAreaDescription],
		src.[PhoneNumberOutOfAreaIsPrivate],
		src.[PhoneNumberAfterHours],
		src.[PhoneNumberAfterHoursDescription],
		src.[PhoneNumberAfterHoursIsPrivate],
		src.[EmailAddressMain],
		src.[WebsiteAddress],
		src.[AgencyStatus],
		src.[AgencyClassification],
		src.[CoverageArea],
		src.[CoverageAreaText],
		src.[Eligibility],
		src.[EligibilityAdult],
		src.[EligibilityChild],
		src.[EligibilityFamily],
		src.[EligibilityFemale],
		src.[EligibilityMale],
		src.[EligibilityTeen],
		src.[SeniorWorkerName],
		src.[SeniorWorkerTitle],
		src.[SeniorWorkerEmailAddress],
		src.[SeniorWorkerPhoneNumber],
		src.[SeniorWorkerIsPrivate],
		src.[MainContactName],
		src.[MainContactTitle],
		src.[MainContactEmailAddress],
		src.[MainContactPhoneNumber],
		src.[MainContactType],
		src.[MainContactIsPrivate],
		src.[LicenseAccreditation],
		src.[YearIncorporated],
		src.[AnnualBudgetTotal],
		src.[LegalStatus],
		src.[SourceOfFunds],
		src.[ExcludeFromWebsite],
		src.[ExcludeFromDirectory],
		src.[DisabilitiesAccess],
		src.[PhysicalLocationDescription],
		src.[BusServiceAccess],
		src.[PublicAccessTransportation],
		src.[PaymentMethods],
		src.[FeeStructureSource],
		src.[ApplicationProcess],
		src.[ResourceInfo],
		src.[DocumentsRequired],
		src.[LanguagesOffered],
		src.[LanguagesOfferedList],
		src.[AvailabilityNumberOfTimes],
		src.[AvailabilityFrequency],
		src.[AvailabilityPeriod],
		src.[ServiceNotAlwaysAvailability],
		src.[CapacityType],
		src.[ServiceCapacity],
		src.[NormalWaitTime],
		src.[TemporaryMessage],
		src.[TemporaryMessageAppears],
		src.[TemporaryMessageExpires],
		src.[EnteredOn],
		src.[UpdatedOn],
		src.[MadeInactiveOn],
		src.[InternalNotes],
		src.[InternalNotesForEditorsAndViewers],
		src.[HighlightedResource],
		src.[LastVerifiedOn],
		src.[LastVerifiedByName],
		src.[LastVerifiedByTitle],
		src.[LastVerifiedByPhoneNumber],
		src.[LastVerifiedByEmailAddress],
		src.[LastVerificationApprovedBy],
		src.[AvailableForDirectory],
		src.[AvailableForReferral],
		src.[AvailableForResearch],
		src.[PreferredProvider],
		src.[ConnectsToSiteNum],
		src.[ConnectsToProgramNum],
		src.[LanguageOfRecord],
		src.[CurrentWorkflowStepCode],
		src.[VolunteerOpportunities],
		src.[VolunteerDuties],
		src.[IsLinkOnly],
		src.[ProgramAgencyNamePublic],
		src.[SiteAgencyNamePublic],
		src.[Categories],
		src.[TaxonomyTerm],
		src.[TaxonomyTerms],
		src.[TaxonomyTermsNotDeactivated],
		src.[TaxonomyCodes],
		src.[Coverage],
		src.[Hours],
		src.[Custom_Public Comments],
		src.[Custom_Former Names],
		src.[Custom_Legal Name],
		src.[Custom_Facebook],
		src.[Custom_Instagram],
		src.[Custom_LinkedIn],
		src.[Custom_Twitter],
		src.[Custom_YouTube],
		src.[Custom_Minimum Age],
		src.[Custom_Maximum Age],
		GETDATE(),
		src.ORG_LEVEL_1,
		src.ORG_DESCRIPTION,
		src.LOCATION_NAME,
		src.LOCATION_DESCRIPTION,
		'SITE',
		src.DELETION_DATE
	)
OPTION (ROBUST PLAN)
	;

SELECT m.MemberID, m.DefaultEmailNameCIC, m.BaseURLCIC, m.ImportNotificationEmailCIC
FROM dbo.STP_Member m WHERE m.Active=1


RETURN @Error

SET NOCOUNT OFF



GO
GRANT EXECUTE ON  [dbo].[sp_CIC_iCarolImport_Rollup] TO [cioc_login_role]
GO
