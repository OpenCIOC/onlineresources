window.CIOC={};
(function(b,e){e.do_drop_down_navigation=function(){for(var d=b.getElementById("ActionList").options,a=0;a<d.length;a++)if(d[a].selected){var c=d[a].getAttribute("href");c&&("undefined"!=typeof d[a].attributes.newwindow?e.open(c):e.location.href=c);break}};jQuery(function(d){d("[data-toggle=dialog]").each(function(){var a=d(this),c=d(a.data("target")),l={autoOpen:!1,title:c.data("title"),modal:c.data("modal")};c.dialog(l);a.click(function(){c.dialog("isOpen")?c.dialog("close"):c.dialog("open")})})})})(document,window);
function CheckAll(b,e){b||="IDList";var d=e;e||(d=document.RecordList);e=d.elements.length;for(var a=0;a<e;a++){var c=d.elements[a];c.name===b&&(c.checked=!0)}}function ClearAll(b,e){b||="IDList";var d=e;e||(d=document.RecordList);e=d.elements.length;for(var a=0;a<e;a++){var c=d.elements[a];c.name===b&&(c.checked=!1)}}function add_class(b,e){b&&!(new RegExp("\\b"+e+"\\b")).test(b.className)&&(b.className&&(e=" "+e),b.className+=e)}
function remove_class(b,e){if(b){for(var d=b.className.split(" "),a=[],c=0;c<d.length;c++){var l=d[c];l!==e&&a.push(l)}b.className=a.join(" ")}}function hide(b){add_class(b,"NotVisible")}function show(b){remove_class(b,"NotVisible")}function openWin(b,e){window.open(b,e,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(b,e){window.open(b,e,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(b,e){window.open(b,e,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(b){var e={sm:openWin,lg:openWinL,xl:openWinXL};b(document).on("click","a.poplink",function(){var d=b(this).data("popargs");(e[d.size||"sm"]||openWin)(this.href,d.name||"popwin");return!1})});
(function(){var b=jQuery,e={},d=function(f){null!==f&&"undefined"!==typeof f?b("#myListCount").text(f):(f=b("#myListCount").text())&&(f=parseInt(f,10));f?e.myListLink.show():e.myListLink.hide()},a=function(f){b.each(f,function(q,t){b("#added_to_list_"+t).show();b("#add_to_list_"+t).hide()})},c=function(f){return function(q){q.fail?alert(q.errinfo):(q.ids?d(b.grep(q.ids,g[e.domain]).length):q.count?d(q.count):d(0),a([f]))}},l=function(f){f=b(f.currentTarget).data("id");b.ajax({success:c(f),dataType:"json",
error:function(){alert("Error")},data:{id:f},type:"POST",url:e.current_list_url})},p=function(f){return function(q){if(q.fail)alert(q.errinfo);else{q=!0;if(f){var t=b("#results_table #remove_from_list_"+f);t.length?t.parent().parent().remove():(q=!1,t=b("#results_container #remove_from_list_"+f),t.parents(".dlist-result").remove())}(q?1!==b("#results_table tr").length:0!==b("#results_container .dlist-result").length)&&f||(b("#records_ui").hide(),b("#no_records_message").show())}}},n=function(f){f=
b(f.currentTarget).data("id");b.ajax({success:p(f),dataType:"json",error:function(){alert("Error")},data:{ID:f,RemoveItem:e.domain},type:"POST",url:e.current_list_url})},k=function(f){b.ajax({success:p(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:e.domain},type:"POST",url:e.current_list_url})},g={CIC:function(f){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(f)},VOL:function(f){return/^[1-9][0-9]*$/.test(f)}},h=function(f){if(f.fail)m();else if(f.inrequest){var q=b.grep(f.ids,
g[e.domain]);a(q);d(q.length);(f=f.previous_ids)&&b.each(f,function(t,w){b("#ct_added_to_previous_request_"+w).show()});b(".ListUI img").prop("src",function(t,w){return w.replace("list","referral")});b("#list_header_text").hide();b("#ct_header_text").show();e.current_list_url=e.ct_update_url;r()}else m()},m=function(){var f=function(){e.list_view_mode||a(e.already_added||[]);e.current_list_url=e.list_view_mode&&"ct"===e.list_view_mode?e.ct_update_url:e.list_update_url;d((e.already_added||[]).length);
r()};e.list_view_mode||e.has_session?f():b.ajax({dataType:"json",error:null,url:e.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(q){q.has_session&&f()}})},r=function(){b(".HideListUI").delegate(".add_to_list","click",l).delegate(".remove_from_list","click",n).removeClass("HideListUI");b("#remove_all_from_list").click(k);b.browser.msie&&"8.0">b.browser.msie&&b(".ListUI").removeClass("FixIE")};window.init_list_adder=function(f){e=f;e.myListLink=b("#myListLink").parent(":hidden").add("#myListLink");
f.in_request?b.ajax({success:h,dataType:"json",error:null,type:"POST",url:f.in_request}):m()}})();this.JSON||(this.JSON={});
(function(){function b(g){return 10>g?"0"+g:g}function e(g){c.lastIndex=0;return c.test(g)?'"'+g.replace(c,function(h){var m=n[h];return"string"===typeof m?m:"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+g+'"'}function d(g,h){var m=l,r=h[g];r&&"object"===typeof r&&"function"===typeof r.toJSON&&(r=r.toJSON(g));"function"===typeof k&&(r=k.call(h,g,r));switch(typeof r){case "string":return e(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);
case "object":if(!r)return"null";l+=p;var f=[];if("[object Array]"===Object.prototype.toString.apply(r)){var q=r.length;for(g=0;g<q;g+=1)f[g]=d(g,r)||"null";h=0===f.length?"[]":l?"[\n"+l+f.join(",\n"+l)+"\n"+m+"]":"["+f.join(",")+"]";l=m;return h}if(k&&"object"===typeof k)for(q=k.length,g=0;g<q;g+=1){var t=k[g];"string"===typeof t&&(h=d(t,r))&&f.push(e(t)+(l?": ":":")+h)}else for(t in r)Object.hasOwnProperty.call(r,t)&&(h=d(t,r))&&f.push(e(t)+(l?": ":":")+h);h=0===f.length?"{}":l?"{\n"+l+f.join(",\n"+
l)+"\n"+m+"}":"{"+f.join(",")+"}";l=m;return h}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(g){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(g){return this.valueOf()});var a=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,p,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof JSON.stringify&&(JSON.stringify=function(g,h,m){var r;p=l="";if("number"===typeof m)for(r=0;r<m;r+=1)p+=" ";else"string"===typeof m&&(p=m);if((k=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))throw Error("JSON.stringify");return d("",{"":g})});
"function"!==typeof JSON.parse&&(JSON.parse=function(g,h){function m(r,f){var q,t=r[f];if(t&&"object"===typeof t)for(q in t)if(Object.hasOwnProperty.call(t,q)){var w=m(t,q);void 0!==w?t[q]=w:delete t[q]}return h.call(r,f,t)}g=String(g);a.lastIndex=0;a.test(g)&&(g=g.replace(a,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(g.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return g=eval("("+g+")"),"function"===typeof h?m({"":g},""):g;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(b){var e={};jQuery(b).find("input,select,textarea").each(function(d){if(this.name)if(e[this.name]||(e[this.name]=[]),"select"===this.nodeName.toLowerCase()){var a=e[this.name];$(this).find("option").each(function(c){this.selected&&a.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&e[this.name].push(this.value||"")});return e};window.restore_form_values=function(b,e){var d=jQuery;d(b).find("input,select,textarea").each(function(a){if(this.name){var c=
e[this.name];"undefined"!=typeof c&&null!==c&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?d(this).find("option").each(function(l){this.selected=1<c.length?0<=d.inArray(this.value,c):0===c.length?!1:this.value===c[0]}):this.value=c.length?c[0]:"":this.checked=1<c.length?0<=d.inArray(this.value,c):0===c.length?!1:this.value===c[0])}})};window.init_cached_state=function(b){var e=jQuery;b=b||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];var d=function(){var a=document.getElementById("cache_form_values");if(a){var c={form_values:get_form_values(b)};e.each(onbeforeunload_fns,function(l,p){p(c)});a.value=JSON.stringify(c)}};document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState&&d()});document.addEventListener("freeze",d);window.addEventListener("pagehide",d);window.cache_register_onbeforeunload=function(a){onbeforeunload_fns.push(a)};window.cache_register_onbeforerestorevalues=
function(a){onbeforerestorevalues_fns.push(a)};window.restore_cached_state=function(){e(window).on("pageshow",function(a){if(!a.originalEvent.persisted&&(a=document.getElementById("cache_form_values"))&&a.value){var c=JSON.parse(a.value);e.each(onbeforerestorevalues_fns,function(l,p){p(c)});restore_form_values(b,c.form_values)}})}}})();
(function(){var b=jQuery,e={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},d={"en-CA":!0,"":!0},a={},c={"fr-CA":"fr","es-MX":"es"},l=function(){var n=b(this),k=n.data("culture"),g=e[k]||b.datepicker.regional[k].dateFormat,h={};n.hasClass("NoYear")&&(g=g.replace(/[\- .\/]*yy[\/]?/,""),h={beforeShow:function(m,
r){r.dpDiv.addClass("NoYearDatePicker")},onClose:function(m,r){r.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});h.dateFormat=g;n.datepicker(b.extend({},b.datepicker.regional[k],h)).prop("autocomplete","off")},p=function(n){b.getScript("https://ajax.googleapis.com/ajax/libs/jqueryui/"+b.ui.version+"/i18n/jquery.ui.datepicker-"+n+".min.js",function(){d[n]=!0;b.each(a[n],function(){l.call(this)});delete a[n]})};b.datepicker.regional["en-CA"]=b.extend({},b.datepicker.regional[""]);b.fn.extend({autodatepicker:function(){return this.each(function(){var n=
b(this);var k=n.parents("[lang]").first().prop("lang")||"en-CA";k=c[k]||k;n.data("culture",k);d[k]?l.call(this):(n=a[k],n||(n=a[k]=[],p(k)),n.push(this))})}});jQuery(function(){b("input.DatePicker").autodatepicker()})})();
(function(){var b=function(a){a=a.toLowerCase();a=a.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");a=a.replace(RegExp("\u00e6","g"),"ae");a=a.replace(RegExp("\u00e7","g"),"c");a=a.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");a=a.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");a=a.replace(RegExp("\u00f1","g"),"n");a=a.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");a=a.replace(RegExp("\u009c","g"),"oe");a=a.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return a=a.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=b;window.slugify=function(a){a=b(a);a=a.replace(/-/g," ").replace(/[^a-z0-9\s]/g,"");a=a.trim();return a.replace(/\s+/g,"-")};var e=function(a,c,l,p,n){l=l||"value";p=p||"";n=n||"";return function(k,g){if(c.term&&(new RegExp(p+a.ui.autocomplete.escapeRegex(c.term)+n,"i")).test(k.term)&&c.content&&13>c.content.length){var h=new RegExp(p+a.ui.autocomplete.escapeRegex(k.term)+n,"i");g(a.grep(c.content,function(m){return h.test(b(m[l]))}));
return!0}return!1}};window.default_cache_search_fn=e;var d=function(a,c,l,p,n){l=l||{};n=n||e(a,l,p||"value");return function(k,g,h){k.term=b(k.term);l.term===k.term&&l.content?g(l.content):n(k,g)||a.ajax({url:h||c,dataType:"json",data:k,cache:!1,success:function(m){l.term=k.term;l.content=m;g(m)}})}};window.create_caching_source_fn=d;window.init_community_autocomplete=function(a,c,l,p,n){var k={};n&&=a(n);n&&!n.length&&(n=null);var g=a("#"+c).autocomplete({focus:function(h,m){return!1},select:function(h,
m){g.data({chkid:m.item.chkid,display:m.item.value})},source:d(a,l,k),minLength:p}).keypress(function(h){"13"==h.keyCode&&(h.preventDefault(),g.autocomplete("close"))});n&&(g.parents("form").on("submit",function(){var h=g.val();if(g.data("display")===h)n.val(g.data("chkid"));else{if(k.content){var m=b(h);h=a.grep(k.content,function(r){return b(r.value)===m});if(1===h.length){n.val(h[0].chkid);g.data({chkid:h[0].chkid,display:h[0].value}).val(h[0].value);return}}n.val("")}}),cache_register_onbeforerestorevalues(function(h){g.length&&
(h=h["autocomplete_data_"+g[0].id])&&g.data(h)}),cache_register_onbeforeunload(function(h){if(g.length){var m=g.data();m.display&&m.chkid&&(h["autocomplete_data_"+g[0].id]={display:m.display,chkid:m.chkid})}}))}})();
(function(){window.entryform=window.entryform||{};window.create_checklist_onbefore_fns=function(d,a,c,l){cache_register_onbeforeunload(function(p){p[a+"_added"]=c});cache_register_onbeforerestorevalues(function(p){(p=p[a+"_added"])&&d.each(p,function(n,k){l(k.chkid,k.display,"")})})};window.basic_chk_add_html=function(d,a){return function(c,l){c=d("<tr>").append(d("<td>").append(d("<input>").prop({id:a+"_ID_"+c,type:"checkbox",checked:!0,defaultChecked:!0,name:a+"_ID",value:c})).append(document.createTextNode(" "+
l))).append(d("<td>").append(d("<input>").prop({id:a+"_NOTES_"+c,name:a+"_NOTES_"+c,size:entryform.chk_notes_size,maxlength:entryform.chk_notes_maxlen})));d("#"+a+"_existing_add_table").append(c);return c.find('input[type="checkbox"]')[0]}};var b={},e=function(d){$("#NEW_"+d).autocomplete(b[d])};window.init_autocomplete_checklist=function(d,a){var c=a.field;if(!b[c]){var l=a.source;a.minLength=a.minLength||1;a.delay=a.delay||300;a.add_new_html=a.add_new_html||basic_chk_add_html(d,c);a.match_prop=
a.match_prop||"value";a.txt_not_found=a.txt_not_found||"Not Found";var p=d(a.delegate_root||document),n=a.added_values||[],k=function(f,q,t){var w=document.getElementById(c+"_ID_"+f);w?(w.checked=!0,a.after_add_new_value&&a.after_add_new_value.call(w)):(n.push({chkid:f,display:q,label:t}),f=a.add_new_html(f,q,t),a.after_add_new_value&&a.after_add_new_value.call(f))};create_checklist_onbefore_fns(d,c,n,k);var g={},h=function(f){d("#NEW_"+c).data({chkid:"",display:"",label:""}).prop("value","").focus();
d("#"+c+"_error").hide("slow",function(){d(this).remove()})},m=null,r=null;(function(f){d.isArray(f)?(r=function(q,t){var w=new RegExp(d.ui.autocomplete.escapeRegex(string_ci_ai(q.term)));t(d.grep(f,function(u){return w.test(string_ci_ai(u[a.match_prop]||u))}))},m=function(q,t){var w=string_ci_ai(q);q=d.grep(f,function(u){return string_ci_ai(string_ci_ai(u[a.match_prop]||u))===w});if(1===q.length)return t(q[0]),!0;t()}):"string"===typeof f?(r=create_caching_source_fn(d,f,g,a.match_prop),m=function(q,
t,w){var u=string_ci_ai(q);if(g.content){var v=d.grep(g.content,function(x){return string_ci_ai(x[a.match_prop])===u});if(1===v.length){t(v[0]);return}}w||string_ci_ai(g.term||"")===u?t():r({term:u},function(x){m(q,t,!0)})}):(r=f,m=a.look_for_fn)})(l);p.on("click","#add_"+c,function(f){f=d("#NEW_"+c);var q=f.data("chkid"),t=f.data("display"),w=f.data("label"),u=f[0].value;if(q&&t&&t==u)return k(q,t,w),h(),!1;m(f[0].value,function(v){v?(k(v.chkid,v.value,v.label),h()):0===d("#"+c+"_error").length&&
(d("#"+c+"_new_input_table").before(d("<p>").hide().addClass("Alert").prop("id",c+"_error").append(document.createTextNode(a.txt_not_found))),d("#"+c+"_error").show("slow"))});return!1});b[c]={focus:function(f,q){return!1},source:r,minLength:a.minLength,delay:a.delay,select:function(f,q){d("#NEW_"+c).data({chkid:q.item.chkid,display:q.item.value,label:q.item.label})}};p.on("keypress","#NEW_"+c,function(f){"13"==f.keyCode&&(f.preventDefault(),d("#NEW_"+c).autocomplete("close"),d("#add_"+c).trigger("click"))})}e(c)};
window.init_languages=function(d,a){var c=null,l=null,p=d("#LN_existing_add_table"),n=function(){var k=d(this).parents(".language-entry").find(".language-details-notes");this.checked?k.slideDown():k.slideUp()};init_autocomplete_checklist(d,{field:"LN",source:entryform.languages_source,txt_not_found:a,after_add_new_value:n,add_new_html:function(k,g){null===c&&(c=d("#add_LN"),l=c.data("newTemplate"));k=l.replace(/LANGNAMELANGNAME/g,g).replace(/IDIDID/g,k);p.append(k)}});p.on("change",".language-primary",
n).uitooltip({items:"[data-help-text]",content:function(){return'<div class="language-help-text">'+d(this).data("helpText")+"</div>"},position:{my:"center bottom-20",at:"center top",using:function(k,g){d(this).css(k);d("<div>").addClass("arrow").addClass(g.vertical).addClass(g.horizontal).appendTo(this)}}});window.languages_check_state=n}})();
(function(){window.only_items_chk_add_html=function(b,e,d){return function(a,c){d&&d();b("#"+e+"_existing_add_container").append(b("<label>").append(b("<input>").prop({id:e+"_ID_"+a,type:"checkbox",checked:!0,defaultChecked:!0,name:e+"_ID",value:a})).append("&nbsp;").append(document.createTextNode(c))).append(" ; ")}};window.init_check_for_autochecklist=function(b){var e=jQuery,d=function(){return e("<li>").append(e("<span>").data("jump_location",this.id).addClass("UnaddedChecklistJump SimulateLink").append(e(this).parentsUntil("td[data-field-display-name]").parent().data("fieldDisplayName")))},
a=e("input[id^=NEW_]");a.length&&(e("#EntryForm").submit(function(c){var l=a.map(function(){return this.value?this:null});if(l.length&&!c.isDefaultPrevented()){if(!confirm(b)){c.preventDefault();e("#SUBMIT_BUTTON").prop("disabled",!1);c=e("#unadded_checklist_error_box");var p=e("#unadded_checklist_error_list");var n=c.is(":visible");n&&p.children("ul:first").hide("slow",function(){e(this).remove()});var k=e("<ul>");n&&k.hide();p.append(k);e.each(l.map(d),function(){k.append(this)});n?k.show("slow"):
c.show("slow")}}else c.isDefaultPrevented()&&(c=e("#unadded_checklist_error_box"),p=e("#unadded_checklist_error_list"),c.hide("slow",function(){p.children().remove()}))}),e(document).on("click",".UnaddedChecklistJump",function(){var c=e(this).data("jump_location");(c=document.getElementById(c))&&c.scrollIntoView(!0)}))};window.init_entryform_items=function(b,e,d){var a=jQuery;b.each(function(){var c=null,l=this,p=a(l),n=1,k=p.find(".EntryFormItemContainerIds")[0];if(k){var g=p.data("maxAdd");g&&=
parseInt(g,10);var h=[];k.value&&(h=a.map(k.value.split(","),function(u){return 0===u.indexOf("NEW")&&0!==u.indexOf("NEWFB")?null:u}));var m={},r=function(){p.find(".EntryFormItemBox").each(function(u){a(this).find(".EntryFormItemCount").text(u+1)})},f=function(u){if(g){var v=p.find(".EntryFormItemContent:hidden").parent().find("button.EntryFormItemDelete").prop("disabled",!u);w.prop("disabled",!u);u?(v.removeClass("ui-state-disabled"),w.removeClass("ui-state-disabled")):(v.addClass("ui-state-disabled"),
w.addClass("ui-state-disabled"))}},q=function(){var u=0,v;for(v in m)u++;return h.length-u},t=function(u){var v=0;if(g&&!u&&(v=q(),v>=g)){alert("over");return}var x=p.data("addTmpl");h.push("NEW"+n++);k.value=h.join(",");x=a(x.replace(/\[COUNT\]/g,h.length).replace(/\[ID\]/g,h[h.length-1]));x.find(".DatePicker").autodatepicker();x.find(".Province").combobox({source:window.cioc_province_source});entryform.service_titles&&x.find(".ServiceTitleField").combobox({source:entryform.service_titles});p.append(x);
c&&(c.sortable("refresh"),r());g&&!u&&v+1===g&&f(!1)},w=p.parent().find(".EntryFormItemAdd").click(function(){t(!1)});p.on("click","button.EntryFormItemDelete",function(){var u=this,v=a(this).parents(".EntryFormItemBox").find(".EntryFormItemContent"),x=this.id.split("_");x=x[x.length-2];if(v.is(":visible"))v.hide("slow",function(){m[x]=get_form_values(v);a(u).text(d);v.find("input,select,textarea").each(function(){"input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?
"select"===this.nodeName.toLowerCase()?a(this).find("option").each(function(){this.selected=!1}):this.value="":this.checked=!1});f(!0)});else{var y=0;if(g&&(y=q(),y>=g)){alert("over");return}var z=m[x];z&&(delete m[x],restore_form_values(v,z),v.show("slow",function(){a(u).text(e)}),g&&y+1===g&&f(!1))}});p.hasClass("sortable")&&(c=p.sortable({items:".EntryFormItemBox"}),c.bind("sortstart",function(u,v){v.helper.bgiframe();p.addClass("sorting")}),c.bind("sortstop",function(){var u=c.sortable("toArray");
h=a.map(u,function(v){v=v.split("_");return v[v.length-2]});k.value=h.join(",");setTimeout(function(){p.removeClass("sorting");r()},1)}));cache_register_onbeforeunload(function(u){u[l.id+"_ids"]=h;u[l.id+"_deletes"]=m;c&&(u[l.id+"_order"]=c.sortable("toArray"))});cache_register_onbeforerestorevalues(function(u){u[l.id+"_ids"]&&a.each(u[l.id+"_ids"],function(v,x){0===x.indexOf("NEW")&&t(!0)});u[l.id+"_deletes"]&&(m=u[l.id+"_deletes"],p.find(".EntryFormItemContent").each(function(){var v=this.id.split("_");
v=v[v.length-2];m[v]&&a(this).hide().parent().find("button.EntryFormItemDelete").text(d)}));g&&q()>=g&&f(!1);c&&(u=u[l.id+"_order"])&&(u.reverse(),a.each(u,function(v,x){a("#"+x).detach().prependTo(p)}),c.sortable("refresh"),r())})}})};window.init_schedule=function(b){var e=function(){var d=b(this).parents(".EntryFormItemBox"),a=this.value;"0"===a?d.find(".recurs-ui").hide():"1"==a?(d.find(".repeat-every-ui, .repeats-on-ui, .recurs-week-label").show(),d.find(".repeat-week-of-month-ui, .repeat-day-of-month-ui, .recurs-month-label").hide()):
"2"==a?(d.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-month-label").show(),d.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-week-label").hide()):(d.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-month-label").show(),d.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-week-label").hide())};b("#ScheduleEditArea").on("change",".recur-type-selector",e).on("click",".schedule-ui-accept-feedback",function(d){var a=b(this);d=a.parents(".EntryFormItemBox");a=a.data("schedule");
var c=d.find(".recur-type-selector");restore_form_values(d,a);e.call(c[0]);return!1}).find(".recur-type-selector").each(e)}})();
(function(){var b=jQuery;window.init_municipality_autocomplete=function(e,d,a){e.each(function(){var c={},l=this,p=this.id.replace("Web",""),n=b("#"+p),k=b(this).data("cm_info",{value:this.value,chkid:n[0].value}).autocomplete({focus:function(h,m){return!1},source:create_caching_source_fn(b,d,c),minLength:1,close:function(){k.is(":focus")||g()}}).keypress(function(h){"13"==h.keyCode&&(h.preventDefault(),k.autocomplete("close"))}),g=function(){var h=k.data("cm_info"),m=l.value;if(m)if(h&&h.chkid&&
h.value&&h.value===m)n[0].value=h.chkid;else{var r=string_ci_ai(m);if(c.content&&(h=b.grep(c.content,function(f){return string_ci_ai(f.value)===r}),1===h.length)){n[0].value=h[0].chkid;k.data("cm_info",h[0]);return}setTimeout(function(){k[0].focus()},1);alert(a)}else n[0].value=""};k.blur(function(){k.autocomplete("widget").is(":visible")||g()})})}})();
(function(){window.init_cm_checklist=function(b,e,d){var a={},c=create_caching_source_fn(b,e,a,"label"),l=d.parent_cmid_input||null,p=9999,n=b("#cm-checklist-template").html(),k=b("#cm-checklist-target");e=l?function(h,m,r){h.parent=l.val();return c(h,m,r)}:c;var g=function(h,m,r){var f=string_ci_ai(h);if(a.content){var q=b.grep(a.content,function(t){return string_ci_ai(t[d.match_prop])===f});if(1===q.length){m(q[0]);return}}r||string_ci_ai(a.term||"")===f?m():c({term:f},function(t){g(h,m,!0)})};
d.parent_cmid_input&&(l=b(d.parent_cmid_input));d.source=e;d.look_for_fn=g;d.add_new_html=function(h,m){to_add=b(n.replace(/\[COUNT\]/g,p++).replace(/\[ID\]/g,h).replace(/\[LABEL\]/g,b("<div>").text(m).html()));k.is(":hidden")?k.removeClass("hidden").append(to_add):k.append(to_add);return!1};init_autocomplete_checklist(b,d)};window.init_community_edit=function(b){var e=9999,d=null,a=null;b("#add-alternate-name").click(function(c){c.preventDefault();d||(d=b("#alt-name-template").html(),a=b("#alt-name-target"));
c=b(d.replace(/\[COUNT\]/g,e++));a.is(":hidden")?a.removeClass("hidden").append(c):a.append(c);return!1})}})();
