/*
 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Version 2.1.2
*/
window.CIOC={};
(function(a,e){e.do_drop_down_navigation=function(){for(var c=a.getElementById("ActionList").options,b=0;b<c.length;b++)if(c[b].selected){var d=c[b].getAttribute("href");d&&("undefined"!=typeof c[b].attributes.newwindow?e.open(d):e.location.href=d);break}};jQuery(function(c){c("[data-toggle=dialog]").each(function(){var b=c(this),d=c(b.data("target")),h={autoOpen:!1,title:d.data("title"),modal:d.data("modal")};d.dialog(h);b.click(function(){d.dialog("isOpen")?d.dialog("close"):d.dialog("open")})})})})(document,window);
function CheckAll(a,e){a||="IDList";var c=e;e||(c=document.RecordList);e=c.elements.length;for(var b=0;b<e;b++){var d=c.elements[b];d.name===a&&(d.checked=!0)}}function ClearAll(a,e){a||="IDList";var c=e;e||(c=document.RecordList);e=c.elements.length;for(var b=0;b<e;b++){var d=c.elements[b];d.name===a&&(d.checked=!1)}}function add_class(a,e){a&&!(new RegExp("\\b"+e+"\\b")).test(a.className)&&(a.className&&(e=" "+e),a.className+=e)}
function remove_class(a,e){if(a){for(var c=a.className.split(" "),b=[],d=0;d<c.length;d++){var h=c[d];h!==e&&b.push(h)}a.className=b.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,e){window.open(a,e,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,e){window.open(a,e,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,e){window.open(a,e,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var e={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var c=a(this).data("popargs");(e[c.size||"sm"]||openWin)(this.href,c.name||"popwin");return!1})});
(function(){var a=jQuery,e={},c=function(f){null!==f&&"undefined"!==typeof f?a("#myListCount").text(f):(f=a("#myListCount").text())&&(f=parseInt(f,10));f?e.myListLink.show():e.myListLink.hide()},b=function(f){a.each(f,function(m,u){a("#added_to_list_"+u).show();a("#add_to_list_"+u).hide()})},d=function(f){return function(m){m.fail?alert(m.errinfo):(m.ids?c(a.grep(m.ids,g[e.domain]).length):m.count?c(m.count):c(0),b([f]))}},h=function(f){f=a(f.currentTarget).data("id");a.ajax({success:d(f),dataType:"json",
error:function(){alert("Error")},data:{id:f},type:"POST",url:e.current_list_url})},n=function(f){return function(m){if(m.fail)alert(m.errinfo);else{m=!0;if(f){var u=a("#results_table #remove_from_list_"+f);u.length?u.parent().parent().remove():(m=!1,u=a("#results_container #remove_from_list_"+f),u.parents(".dlist-result").remove())}(m?1!==a("#results_table tr").length:0!==a("#results_container .dlist-result").length)&&f||(a("#records_ui").hide(),a("#no_records_message").show())}}},r=function(f){f=
a(f.currentTarget).data("id");a.ajax({success:n(f),dataType:"json",error:function(){alert("Error")},data:{ID:f,RemoveItem:e.domain},type:"POST",url:e.current_list_url})},k=function(f){a.ajax({success:n(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:e.domain},type:"POST",url:e.current_list_url})},g={CIC:function(f){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(f)},VOL:function(f){return/^[1-9][0-9]*$/.test(f)}},q=function(f){if(f.fail)w();else if(f.inrequest){var m=a.grep(f.ids,
g[e.domain]);b(m);c(m.length);(f=f.previous_ids)&&a.each(f,function(u,y){a("#ct_added_to_previous_request_"+y).show()});a(".ListUI img").prop("src",function(u,y){return y.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();e.current_list_url=e.ct_update_url;l()}else w()},w=function(){var f=function(){e.list_view_mode||b(e.already_added||[]);e.current_list_url=e.list_view_mode&&"ct"===e.list_view_mode?e.ct_update_url:e.list_update_url;c((e.already_added||[]).length);
l()};e.list_view_mode||e.has_session?f():a.ajax({dataType:"json",error:null,url:e.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(m){m.has_session&&f()}})},l=function(){a(".HideListUI").delegate(".add_to_list","click",h).delegate(".remove_from_list","click",r).removeClass("HideListUI");a("#remove_all_from_list").click(k);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(f){e=f;e.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
f.in_request?a.ajax({success:q,dataType:"json",error:null,type:"POST",url:f.in_request}):w()}})();this.JSON||(this.JSON={});
(function(){function a(g){return 10>g?"0"+g:g}function e(g){d.lastIndex=0;return d.test(g)?'"'+g.replace(d,function(q){var w=r[q];return"string"===typeof w?w:"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+g+'"'}function c(g,q){var w=h,l=q[g];l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(g));"function"===typeof k&&(l=k.call(q,g,l));switch(typeof l){case "string":return e(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);
case "object":if(!l)return"null";h+=n;var f=[];if("[object Array]"===Object.prototype.toString.apply(l)){var m=l.length;for(g=0;g<m;g+=1)f[g]=c(g,l)||"null";q=0===f.length?"[]":h?"[\n"+h+f.join(",\n"+h)+"\n"+w+"]":"["+f.join(",")+"]";h=w;return q}if(k&&"object"===typeof k)for(m=k.length,g=0;g<m;g+=1){var u=k[g];"string"===typeof u&&(q=c(u,l))&&f.push(e(u)+(h?": ":":")+q)}else for(u in l)Object.hasOwnProperty.call(l,u)&&(q=c(u,l))&&f.push(e(u)+(h?": ":":")+q);q=0===f.length?"{}":h?"{\n"+h+f.join(",\n"+
h)+"\n"+w+"}":"{"+f.join(",")+"}";h=w;return q}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(g){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(g){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,n,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof JSON.stringify&&(JSON.stringify=function(g,q,w){var l;n=h="";if("number"===typeof w)for(l=0;l<w;l+=1)n+=" ";else"string"===typeof w&&(n=w);if((k=q)&&"function"!==typeof q&&("object"!==typeof q||"number"!==typeof q.length))throw Error("JSON.stringify");return c("",{"":g})});
"function"!==typeof JSON.parse&&(JSON.parse=function(g,q){function w(l,f){var m,u=l[f];if(u&&"object"===typeof u)for(m in u)if(Object.hasOwnProperty.call(u,m)){var y=w(u,m);void 0!==y?u[m]=y:delete u[m]}return q.call(l,f,u)}g=String(g);b.lastIndex=0;b.test(g)&&(g=g.replace(b,function(l){return"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(g.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return g=eval("("+g+")"),"function"===typeof q?w({"":g},""):g;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var e={};jQuery(a).find("input,select,textarea").each(function(c){if(this.name)if(e[this.name]||(e[this.name]=[]),"select"===this.nodeName.toLowerCase()){var b=e[this.name];$(this).find("option").each(function(d){this.selected&&b.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&e[this.name].push(this.value||"")});return e};window.restore_form_values=function(a,e){var c=jQuery;c(a).find("input,select,textarea").each(function(b){if(this.name){var d=
e[this.name];"undefined"!=typeof d&&null!==d&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?c(this).find("option").each(function(h){this.selected=1<d.length?0<=c.inArray(this.value,d):0===d.length?!1:this.value===d[0]}):this.value=d.length?d[0]:"":this.checked=1<d.length?0<=c.inArray(this.value,d):0===d.length?!1:this.value===d[0])}})};window.init_cached_state=function(a){var e=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];e(window).on("beforeunload",function(){var c={form_values:get_form_values(a)};e.each(onbeforeunload_fns,function(b,d){d(c)});document.getElementById("cache_form_values").value=JSON.stringify(c)});window.cache_register_onbeforeunload=function(c){onbeforeunload_fns.push(c)};window.cache_register_onbeforerestorevalues=function(c){onbeforerestorevalues_fns.push(c)};window.restore_cached_state=function(){var c=document.getElementById("cache_form_values");if(c&&c.value){var b=
JSON.parse(c.value);e.each(onbeforerestorevalues_fns,function(d,h){h(b)});restore_form_values(a,b.form_values)}}}})();
(function(){var a=jQuery,e={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},c={"en-CA":!0,"":!0},b={},d={"fr-CA":"fr","es-MX":"es"},h=function(){var r=a(this),k=r.data("culture"),g=e[k]||a.datepicker.regional[k].dateFormat,q={};r.hasClass("NoYear")&&(g=g.replace(/[\- .\/]*yy[\/]?/,""),q={beforeShow:function(w,
l){l.dpDiv.addClass("NoYearDatePicker")},onClose:function(w,l){l.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});q.dateFormat=g;r.datepicker(a.extend({},a.datepicker.regional[k],q)).prop("autocomplete","off")},n=function(r){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+r+".min.js",function(){c[r]=!0;a.each(b[r],function(){h.call(this)});delete b[r]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var r=
a(this);var k=r.parents("[lang]").first().prop("lang")||"en-CA";k=d[k]||k;r.data("culture",k);c[k]?h.call(this):(r=b[k],r||(r=b[k]=[],n(k)),r.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(a){function e(c){return c&&c.constructor===Number?c+"px":c}a.fn.bgiframe=a.browser.msie&&/msie 6\.0/i.test(navigator.userAgent)?function(c){c=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;"},c);var b='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+c.src+'"style="display:block;position:absolute;z-index:-1;'+(!1!==c.opacity?"filter:Alpha(Opacity='0');":"")+"top:"+("auto"==c.top?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":
e(c.top))+";left:"+("auto"==c.left?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":e(c.left))+";width:"+("auto"==c.width?"expression(this.parentNode.offsetWidth+'px')":e(c.width))+";height:"+("auto"==c.height?"expression(this.parentNode.offsetHeight+'px')":e(c.height))+';"/>';return this.each(function(){0===a(this).children("iframe.bgiframe").length&&this.insertBefore(document.createElement(b),this.firstChild)})}:function(){return this};a.fn.bgIframe=a.fn.bgiframe})(jQuery);
(function(a){a.widget("ui.combobox",{options:{source:null},_create:function(){var e=this.element;this.options.source&&(a(e).autocomplete({focus:function(c,b){return!1},source:this.options.source,delay:0,minLength:0}),a("<span>").insertAfter(e).addClass("SmallButton DownButton").css("margin-left","1px").click(function(c){e.autocomplete("widget").is(":visible")?e.autocomplete("close"):(e.autocomplete("search",""),e.focus())}))}})})(jQuery);
(function(){window.init_history_dialog=function(a,e){var c=!1,b=null,d=null,h=null,n=function(l){l.fail?a("#HistoryFieldContent").html("<em>"+l.errinfo+"</em>"):l.compare?(null===b&&(b=new diff_match_patch),l=b.diff_main(l.text2,l.text1),b.diff_cleanupSemantic(l),l=b.diff_prettyHtml(l),a("#HistoryFieldContent").html(l)):a("#HistoryFieldContent").html(l.text1)},r=function(l,f,m){return function(){var u=a("#HistoryLanguage").prop("value"),y=a("#HistoryRevision").prop("value"),v=a("#HistoryCompare").prop("value");
if(v===h||!(""===h&&v===y||""===v&&h===d)){var p=v;if(""===v||v===y)p="";a.getJSON(e.fielddiff_url.replace("[ID]",m).replace("[LANG]",u).replace("[FIELD]",l).replace("[REV]",y).replace("[COMP]",p),n)}d=y;h=v}},k=null,g=function(l,f,m,u){a("select.HistorySelect").unbind("change");a("#HistoryLanguage").unbind("change");a("#field_history").html('<p class="Info">'+e.txt_loading+"</p>").dialog("close").dialog("open").dialog("option","title",e.txt_fielddifftitle+m+" ("+f+")").load(e.fielddiffui_url.replace("[ID]",
m).replace("[FIELD]",l).replace("[LANG]",u),k(l,f,m))},q=function(l,f,m){return function(){var u=a(this).prop("value");g(l,f,m,u)}};k=function(l,f,m){return function(){a("select.HistorySelect").change(r(l,f,m));a("#HistoryLanguage").change(q(l,f,m));d=a("#HistoryRevision").prop("value");h=a("#HistoryCompare").prop("value")}};a(".ShowVersions").click(function(){var l=a(this).data("ciocfield"),f=a(this).data("ciocfielddisplay"),m=a(this).data("ciocid");c||(c=!0,a.getScript(e.path_to_start+"scripts/diff_match_patch.min.js"));
g(l,f,m,"")});a(document).on("click",".FieldHistoryJump",function(l){l=a(l.currentTarget).data("fieldname");(l=document.getElementById("FIELD_"+l))&&l.scrollIntoView(!0)});a(document).on("click",".HistoryFieldsToggle",function(l){a(l.currentTarget).parent().children("ul").toggle("fast")});var w=function(){a(".HistoryFieldsToggle").parent().children("ul").hide()};a(".HistorySummary").click(function(){var l=a(this).data("cioclang"),f=a(this).data("ciocid");a("#revision_history").html("Loading...").load(e.revhistory_url.replace("[ID]",
f).replace("[LANG]",l),w).dialog("open")});a("#revision_history").dialog({autoOpen:!1,width:330,height:280,position:["right","top"],resizable:!1,dialogClass:"RevHistory"});a("#field_history").dialog({autoOpen:!1,width:620,height:280,position:["right","bottom"]});a(".RevHistory.ui-dialog").css({position:"fixed"})}})();
(function(){var a=function(b){b=b.toLowerCase();b=b.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");b=b.replace(RegExp("\u00e6","g"),"ae");b=b.replace(RegExp("\u00e7","g"),"c");b=b.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");b=b.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");b=b.replace(RegExp("\u00f1","g"),"n");b=b.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");b=b.replace(RegExp("\u009c","g"),"oe");b=b.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return b=b.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;var e=function(b,d,h,n,r){h=h||"value";n=n||"";r=r||"";return function(k,g){if(d.term&&(new RegExp(n+b.ui.autocomplete.escapeRegex(d.term)+r,"i")).test(k.term)&&d.content&&13>d.content.length){var q=new RegExp(n+b.ui.autocomplete.escapeRegex(k.term)+r,"i");g(b.grep(d.content,function(w){return q.test(a(w[h]))}));return!0}return!1}};window.default_cache_search_fn=e;var c=function(b,d,h,n,r){h=h||{};r=r||e(b,h,n||"value");
return function(k,g,q){k.term=a(k.term);h.term===k.term&&h.content?g(h.content):r(k,g)||b.ajax({url:q||d,dataType:"json",data:k,cache:!1,success:function(w){h.term=k.term;h.content=w;g(w)}})}};window.create_caching_source_fn=c;window.init_community_autocomplete=function(b,d,h,n,r){var k={};r&&=b(r);r&&!r.length&&(r=null);var g=b("#"+d).autocomplete({focus:function(q,w){return!1},select:function(q,w){g.data({chkid:w.item.chkid,display:w.item.value})},source:c(b,h,k),minLength:n}).keypress(function(q){"13"==
q.keyCode&&(q.preventDefault(),g.autocomplete("close"))});r&&(g.parents("form").on("submit",function(){var q=g.val();if(g.data("display")===q)r.val(g.data("chkid"));else{if(k.content){var w=a(q);q=b.grep(k.content,function(l){return a(l.value)===w});if(1===q.length){r.val(q[0].chkid);g.data({chkid:q[0].chkid,display:q[0].value}).val(q[0].value);return}}r.val("")}}),cache_register_onbeforerestorevalues(function(q){g.length&&(q=q["autocomplete_data_"+g[0].id])&&g.data(q)}),cache_register_onbeforeunload(function(q){if(g.length){var w=
g.data();w.display&&w.chkid&&(q["autocomplete_data_"+g[0].id]={display:w.display,chkid:w.chkid})}}))}})();
(function(){window.entryform=window.entryform||{};window.create_checklist_onbefore_fns=function(c,b,d,h){cache_register_onbeforeunload(function(n){n[b+"_added"]=d});cache_register_onbeforerestorevalues(function(n){(n=n[b+"_added"])&&c.each(n,function(r,k){h(k.chkid,k.display,"")})})};window.basic_chk_add_html=function(c,b){return function(d,h){d=c("<tr>").append(c("<td>").append(c("<input>").prop({id:b+"_ID_"+d,type:"checkbox",checked:!0,defaultChecked:!0,name:b+"_ID",value:d})).append(document.createTextNode(" "+
h))).append(c("<td>").append(c("<input>").prop({id:b+"_NOTES_"+d,name:b+"_NOTES_"+d,size:entryform.chk_notes_size,maxlength:entryform.chk_notes_maxlen})));c("#"+b+"_existing_add_table").append(d);return d.find('input[type="checkbox"]')[0]}};var a={},e=function(c){$("#NEW_"+c).autocomplete(a[c])};window.init_autocomplete_checklist=function(c,b){var d=b.field;if(!a[d]){var h=b.source;b.minLength=b.minLength||1;b.delay=b.delay||300;b.add_new_html=b.add_new_html||basic_chk_add_html(c,d);b.match_prop=
b.match_prop||"value";b.txt_not_found=b.txt_not_found||"Not Found";var n=c(b.delegate_root||document),r=b.added_values||[],k=function(f,m,u){var y=document.getElementById(d+"_ID_"+f);y?(y.checked=!0,b.after_add_new_value&&b.after_add_new_value.call(y)):(r.push({chkid:f,display:m,label:u}),f=b.add_new_html(f,m,u),b.after_add_new_value&&b.after_add_new_value.call(f))};create_checklist_onbefore_fns(c,d,r,k);var g={},q=function(f){c("#NEW_"+d).data({chkid:"",display:"",label:""}).prop("value","").focus();
c("#"+d+"_error").hide("slow",function(){c(this).remove()})},w=null,l=null;(function(f){c.isArray(f)?(l=function(m,u){var y=new RegExp(c.ui.autocomplete.escapeRegex(string_ci_ai(m.term)));u(c.grep(f,function(v){return y.test(string_ci_ai(v[b.match_prop]||v))}))},w=function(m,u){var y=string_ci_ai(m);m=c.grep(f,function(v){return string_ci_ai(string_ci_ai(v[b.match_prop]||v))===y});if(1===m.length)return u(m[0]),!0;u()}):"string"===typeof f?(l=create_caching_source_fn(c,f,g,b.match_prop),w=function(m,
u,y){var v=string_ci_ai(m);if(g.content){var p=c.grep(g.content,function(x){return string_ci_ai(x[b.match_prop])===v});if(1===p.length){u(p[0]);return}}y||string_ci_ai(g.term||"")===v?u():l({term:v},function(x){w(m,u,!0)})}):(l=f,w=b.look_for_fn)})(h);n.on("click","#add_"+d,function(f){f=c("#NEW_"+d);var m=f.data("chkid"),u=f.data("display"),y=f.data("label"),v=f[0].value;if(m&&u&&u==v)return k(m,u,y),q(),!1;w(f[0].value,function(p){p?(k(p.chkid,p.value,p.label),q()):0===c("#"+d+"_error").length&&
(c("#"+d+"_new_input_table").before(c("<p>").hide().addClass("Alert").prop("id",d+"_error").append(document.createTextNode(b.txt_not_found))),c("#"+d+"_error").show("slow"))});return!1});a[d]={focus:function(f,m){return!1},source:l,minLength:b.minLength,delay:b.delay,select:function(f,m){c("#NEW_"+d).data({chkid:m.item.chkid,display:m.item.value,label:m.item.label})}};n.on("keypress","#NEW_"+d,function(f){"13"==f.keyCode&&(f.preventDefault(),c("#NEW_"+d).autocomplete("close"),c("#add_"+d).trigger("click"))})}e(d)};
window.init_languages=function(c,b){var d=null,h=null,n=c("#LN_existing_add_table"),r=function(){var k=c(this).parents(".language-entry").find(".language-details-notes");this.checked?k.slideDown():k.slideUp()};init_autocomplete_checklist(c,{field:"LN",source:entryform.languages_source,txt_not_found:b,after_add_new_value:r,add_new_html:function(k,g){null===d&&(d=c("#add_LN"),h=d.data("newTemplate"));k=h.replace(/LANGNAMELANGNAME/g,g).replace(/IDIDID/g,k);n.append(k)}});n.on("change",".language-primary",
r).uitooltip({items:"[data-help-text]",content:function(){return'<div class="language-help-text">'+c(this).data("helpText")+"</div>"},position:{my:"center bottom-20",at:"center top",using:function(k,g){c(this).css(k);c("<div>").addClass("arrow").addClass(g.vertical).addClass(g.horizontal).appendTo(this)}}});window.languages_check_state=r}})();
(function(){var a=jQuery;window.configure_entry_form_button=function(){a("#SUBMIT_BUTTON").click(function(e){e=a("#SUBMIT_BUTTON");e.prop("disabled")||(e.prop("disabled",!0),setTimeout(function(){a("#EntryForm").submit()},1))});a(document).bind("keydown",function(e){if(e.ctrlKey&&"s"===String.fromCharCode(e.which).toLowerCase())return setTimeout(function(){a("#SUBMIT_BUTTON").click()},1),e.preventDefault(),e.stopPropagation(),!1});a("#SUBMIT_BUTTON").prop("disabled",!1)};window.configure_feedback_submit_button=
function(){var e=a("#SUBMIT_BUTTON").prop("value");a("#SUBMIT_BUTTON").replaceWith(a('<input type="button" class="btn btn-default" id="SUBMIT_BUTTON">').prop("value",e));a("#EntryForm").submit(function(){var c=validateForm();!1===c&&a("#SUBMIT_BUTTON").prop("disabled",!1);return c})}})();
(function(){window.only_items_chk_add_html=function(a,e,c){return function(b,d){c&&c();a("#"+e+"_existing_add_container").append(a("<label>").append(a("<input>").prop({id:e+"_ID_"+b,type:"checkbox",checked:!0,defaultChecked:!0,name:e+"_ID",value:b})).append("&nbsp;").append(document.createTextNode(d))).append(" ; ")}};window.init_check_for_autochecklist=function(a){var e=jQuery,c=function(){return e("<li>").append(e("<span>").data("jump_location",this.id).addClass("UnaddedChecklistJump SimulateLink").append(e(this).parentsUntil("td[data-field-display-name]").parent().data("fieldDisplayName")))},
b=e("input[id^=NEW_]");b.length&&(e("#EntryForm").submit(function(d){var h=b.map(function(){return this.value?this:null});if(h.length&&!d.isDefaultPrevented()){if(!confirm(a)){d.preventDefault();e("#SUBMIT_BUTTON").prop("disabled",!1);d=e("#unadded_checklist_error_box");var n=e("#unadded_checklist_error_list");var r=d.is(":visible");r&&n.children("ul:first").hide("slow",function(){e(this).remove()});var k=e("<ul>");r&&k.hide();n.append(k);e.each(h.map(c),function(){k.append(this)});r?k.show("slow"):
d.show("slow")}}else d.isDefaultPrevented()&&(d=e("#unadded_checklist_error_box"),n=e("#unadded_checklist_error_list"),d.hide("slow",function(){n.children().remove()}))}),e(document).on("click",".UnaddedChecklistJump",function(){var d=e(this).data("jump_location");(d=document.getElementById(d))&&d.scrollIntoView(!0)}))};window.init_entryform_items=function(a,e,c){var b=jQuery;a.each(function(){var d=null,h=this,n=b(h),r=1,k=n.find(".EntryFormItemContainerIds")[0];if(k){var g=n.data("maxAdd");g&&=
parseInt(g,10);var q=[];k.value&&(q=b.map(k.value.split(","),function(v){return 0===v.indexOf("NEW")&&0!==v.indexOf("NEWFB")?null:v}));var w={},l=function(){n.find(".EntryFormItemBox").each(function(v){b(this).find(".EntryFormItemCount").text(v+1)})},f=function(v){if(g){var p=n.find(".EntryFormItemContent:hidden").parent().find("button.EntryFormItemDelete").prop("disabled",!v);y.prop("disabled",!v);v?(p.removeClass("ui-state-disabled"),y.removeClass("ui-state-disabled")):(p.addClass("ui-state-disabled"),
y.addClass("ui-state-disabled"))}},m=function(){var v=0,p;for(p in w)v++;return q.length-v},u=function(v){var p=0;if(g&&!v&&(p=m(),p>=g)){alert("over");return}var x=n.data("addTmpl");q.push("NEW"+r++);k.value=q.join(",");x=b(x.replace(/\[COUNT\]/g,q.length).replace(/\[ID\]/g,q[q.length-1]));x.find(".DatePicker").autodatepicker();x.find(".Province").combobox({source:window.cioc_province_source});entryform.service_titles&&x.find(".ServiceTitleField").combobox({source:entryform.service_titles});n.append(x);
d&&(d.sortable("refresh"),l());g&&!v&&p+1===g&&f(!1)},y=n.parent().find(".EntryFormItemAdd").click(function(){u(!1)});n.on("click","button.EntryFormItemDelete",function(){var v=this,p=b(this).parents(".EntryFormItemBox").find(".EntryFormItemContent"),x=this.id.split("_");x=x[x.length-2];if(p.is(":visible"))p.hide("slow",function(){w[x]=get_form_values(p);b(v).text(c);p.find("input,select,textarea").each(function(){"input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?
"select"===this.nodeName.toLowerCase()?b(this).find("option").each(function(){this.selected=!1}):this.value="":this.checked=!1});f(!0)});else{var A=0;if(g&&(A=m(),A>=g)){alert("over");return}var B=w[x];B&&(delete w[x],restore_form_values(p,B),p.show("slow",function(){b(v).text(e)}),g&&A+1===g&&f(!1))}});n.hasClass("sortable")&&(d=n.sortable({items:".EntryFormItemBox"}),d.bind("sortstart",function(v,p){p.helper.bgiframe();n.addClass("sorting")}),d.bind("sortstop",function(){var v=d.sortable("toArray");
q=b.map(v,function(p){p=p.split("_");return p[p.length-2]});k.value=q.join(",");setTimeout(function(){n.removeClass("sorting");l()},1)}));cache_register_onbeforeunload(function(v){v[h.id+"_ids"]=q;v[h.id+"_deletes"]=w;d&&(v[h.id+"_order"]=d.sortable("toArray"))});cache_register_onbeforerestorevalues(function(v){v[h.id+"_ids"]&&b.each(v[h.id+"_ids"],function(p,x){0===x.indexOf("NEW")&&u(!0)});v[h.id+"_deletes"]&&(w=v[h.id+"_deletes"],n.find(".EntryFormItemContent").each(function(){var p=this.id.split("_");
p=p[p.length-2];w[p]&&b(this).hide().parent().find("button.EntryFormItemDelete").text(c)}));g&&m()>=g&&f(!1);d&&(v=v[h.id+"_order"])&&(v.reverse(),b.each(v,function(p,x){b("#"+x).detach().prependTo(n)}),d.sortable("refresh"),l())})}})};window.init_schedule=function(a){var e=function(){var c=a(this).parents(".EntryFormItemBox"),b=this.value;"0"===b?c.find(".recurs-ui").hide():"1"==b?(c.find(".repeat-every-ui, .repeats-on-ui, .recurs-week-label").show(),c.find(".repeat-week-of-month-ui, .repeat-day-of-month-ui, .recurs-month-label").hide()):
"2"==b?(c.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-month-label").show(),c.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-week-label").hide()):(c.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-month-label").show(),c.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-week-label").hide())};a("#ScheduleEditArea").on("change",".recur-type-selector",e).on("click",".schedule-ui-accept-feedback",function(c){var b=a(this);c=b.parents(".EntryFormItemBox");b=b.data("schedule");
var d=c.find(".recur-type-selector");restore_form_values(c,b);e.call(d[0]);return!1}).find(".recur-type-selector").each(e)}})();
(function(){window.changeAutoAssign=function(h,n,r){h.checked?(n.value="",n.disabled=!0,r.disabled=!0):(n.disabled=!1,r.disabled=!1)};var a=jQuery,e=function(h){h.find(":input").not('input[type="hidden"]').filter("[name]").addClass("require-group")},c=function(h){h.find(":input").not('input[type="hidden"]').filter("[name]").removeClass("require-group")};window.make_required_group=e;window.remove_required_group=c;var b=function(h,n){var r=h.parent().find("td[data-field-display-name]"),k=r.data("fieldDisplayName");
n?(h.text(k).append(' <span class="Alert">*</span>'),e(r)):(h.text(k),c(r))},d=function(){var h=a("#FIELD_ORG_LEVEL_2");if(h.length){var n=a("#RECORD_TYPE").find(":selected").data("progorbranch");b(h,n)}};window.update_form_make_required_org_level=function(){for(var h,n=0;6>n;n++)if(h=a("#FIELD_ORG_LEVEL_"+n),h.length){b(h,!0);break}};window.init_client_validation=function(h,n){var r=a(h),k=r.prop("lang")||r.parents("[lang]").first().prop("lang")||"en-CA",g=function(p){var x=!1;try{p.each(function(){if(this.name)if(/radio|checkbox/i.test(this.type)){if(this.checked&&
this.value)throw x=!0,{name:"StopIteration",message:"StopIteration"};}else if(a.trim(this.value))throw x=!0,{name:"StopIteration",message:"StopIteration"};})}catch(A){if("StopIteration"!==A.name)throw A;}return x},q=null;a.validator.addMethod("email",function(p,x){q||=RegExp("^((([A-Za-z0-9!#-'\\*\\+\\-/=\\?\\^_`\\{-~]+(\\.[A-Za-z0-9!#-'\\*\\+\\-/=\\?\\^_`\\{-~]+)*@[A-Za-z0-9!#-'\\*\\+\\-/=\\?\\^_`\\{-~]+(\\.[A-Za-z0-9!#-'\\*\\+\\-/=\\?\\^_`\\{-~]+)*)(\\s*,*\\s*))*)$");return this.optional(x)||q.test(p)});
var w=null;a.validator.addMethod("url",function(p,x){w||=/^((\d{1,3}(\.\d{1,3}){3})|([\w_\-]+(\.[\w\._\-]+)*)(:[0-9]+)?((\/|\?)[^\s]*)?)$/;return this.optional(x)||w.test(p)});var l=null;a.validator.addMethod("protourl",function(p,x){l||=/^(https?:\/\/)?((\d{1,3}(\.\d{1,3}){3})|([\w_\-]+(\.[\w\._\-]+)*)(:[0-9]+)?((\/|\?)[^\s]*)?)$/;return this.optional(x)||l.test(p)});var f=null;a.validator.addMethod("posint",function(p,x){f||=/^\d+$/;return this.optional(x)||f.test(p)});var m=null;a.validator.addMethod("posdbl",
function(p,x){if(!m){var A="\\.";"fr-CA"===k&&(A=",");m=new RegExp("^((\\d+)|(\\d*"+A+"\\d+))$")}return this.optional(x)||m.test(p)});var u=null;a.validator.addMethod("record-num",function(p,x){u||=/^[A-Z]{3}[0-9]{4,5}$/;return this.optional(x)||u.test(p)});a.validator.addMethod("unique",function(p,x,A){if(!p)return!0;p=string_ci_ai(p);x=jQuery.validator.format("[name!='{0}'][unique='{1}']",x.name,A);var B=[];a(x).each(function(G,E){p==string_ci_ai(a(E).val())&&B.push(E)});return 0==B.length},"A unique value is required.");
a.validator.addMethod("require-group",function(p,x){p=a(x).parents("td[data-field-display-name]");x=p.parent().children("td:first").prop("id");x=x.slice(-(x.length-6));var A=p.find(":input").not("[type=hidden]").not("button");console.log("About to tinymce check",x);if(window.tinymce){var B=p.find(".WYSIWYG").prop("id");console.log("in tinymce check",B);B&&(B=window.tinymce.get(B))&&(B.save(),console.log("did save"))}switch(x){case "ACCESSIBILITY":case "AREAS_SERVED":case "LANGUAGES":case "FUNDING":case "SCHOOL_ESCORT":case "SCHOOLS_IN_AREA":case "TYPE_OF_CARE":A=
A.not("input:text");break;case "ALT_ORG":case "LEGAL_ORG":A=A.not("input:checkbox");break;case "FORMER_ORG":A=A.not("input:checkbox").not("[name^=FORMER_ORG_DATE]");break;case "FEES":A=A.not("input:text").add("#FEE_ASSISTANCE_FOR, #FEE_ASSISTANCE_FROM");break;case "VACANCY_INFO":A=A.filter("[name!=VUT_ID]")}(x=g(A))&&p.children("div.required-notice").hide();return x},"Field Required");var y=a('<div id="a_test"></div>').dialog({autoOpen:!1,title:n,closeOnEscape:!1,position:["right","bottom"],resizable:!1,
dialogClass:"ValidationErrors"}),v=a("#validation_error_box");a(document).on("click",".FieldErrorJump",function(p){p=a(p.currentTarget).prop("fieldname");(p=document.getElementById(p))&&p.scrollIntoView(!0)});a(".ValidationErrors.ui-dialog").css({position:"fixed"}).position({my:"right bottom",at:"right bottom",of:window});e(a(h).find("td[data-field-required]"));h=a(h).validate({ignore:"input[type=hidden]",ignoreTitle:!0,errorPlacement:function(p,x){var A=[],B=x[0];if(x.hasClass("require-group")){var G=
x.parents("td[data-field-display-name]");A=G.children("div.required-notice");var E=!1;/radio|checkbox/i.test(B.type)?B.checked&&B.value||(E=!0):a.trim(B.value)||(E=!0);if(E){A.length?(A.empty(),A.show(),A.append(p)):(p.removeAttr("for"),G.prepend(a('<div class="required-notice"></div>').append(p)));return}}A.length&&A.hide();p.insertAfter(x)},showErrors:function(p,x){this.defaultShowErrors();if(0===x.length)y.dialog("close"),v.hide("slow");else{var A={},B=a("<ul>");jQuery.each(x,function(G,E){E=E.element;
G=a(E).parents("td[data-field-display-name]");E=G.parent().children("td:first").prop("id");A[E]||(A[E]=!0,B.append(a("<li>").append(a("<span>").prop({fieldname:E,className:"FieldErrorJump SimulateLink"}).text(G.data("fieldDisplayName")))))});y.empty().append(B);y.dialog("open");v.show("slow");a("#SUBMIT_BUTTON").prop("disabled",!1)}},focusInvalid:!1,onfocusout:!1,onkeyup:!1,onclick:!1});"fr-CA"===k?jQuery.extend(jQuery.validator.messages,{required:"Ce champ est requis.",remote:"Veuillez remplir ce champ pour continuer.",
email:"Veuillez entrer une adresse email valide.",url:"Veuillez entrer une URL valide.",date:"Veuillez entrer une date valide.",dateISO:"Veuillez entrer une date valide (ISO).",number:"Veuillez entrer un nombre valide.",digits:"Veuillez entrer (seulement) une valeur num\u00e9rique.",creditcard:"Veuillez entrer un num\u00e9ro de carte de cr\u00e9dit valide.",equalTo:"Veuillez entrer une nouvelle fois la m\u00eame valeur.",accept:"Veuillez entrer une valeur avec une extension valide.",maxlength:jQuery.validator.format("Veuillez ne pas entrer plus de {0} caract\u00e8res."),
minlength:jQuery.validator.format("Veuillez entrer au moins {0} caract\u00e8res."),rangelength:jQuery.validator.format("Veuillez entrer entre {0} et {1} caract\u00e8res."),range:jQuery.validator.format("Veuillez entrer une valeur entre {0} et {1}."),max:jQuery.validator.format("Veuillez entrer une valeur inf\u00e9rieure ou \u00e9gale \u00e0 {0}."),min:jQuery.validator.format("Veuillez entrer une valeur sup\u00e9rieure ou \u00e9gale \u00e0 {0}."),protourl:"Veuillez entrer une URL valide.",posint:"Veuillez entrer un nombre positif.",
posdbl:"Veuillez entrer un nombre positif.","record-num":"Please enter a valid record number.","require-group":"Ce champ est requis.",unique:"Une valeur unique est requise."}):jQuery.extend(jQuery.validator.messages,{protourl:"Please enter a valid URL.",posint:"Please enter a positive number.",posdbl:"Please enter a positive number.","record-num":"Please enter a valid record number.","require-group":"Field Required.",unique:"A unique value is required."});return h};window.init_record_type_form=function(h,
n,r){var k=null,g=null,q={},w="ORG_LEVEL_1 ORG_LEVEL_2 ORG_LEVEL_3 ORG_LEVEL_4 ORG_LEVEL_5 LOCATION_NAME SERVICE_NAME_LEVEL_1 SERVICE_NAME_LEVEL_2".split(" "),l=function(){a("#RecordTypeName").html(g);a.each(w,function(m){var u=r[m],y=a("#"+m);y.length&&(y[0].value=u)&&(a("#"+m+"_DISPLAY").text(u),a("#HIDDEN_"+y).prop("value",u))});a("#RECORD_TYPE").prop("value",k[0].value);d()},f=function(){var m=k[0].value;k.data("hasform")||(m=null);k=a(this).find("option:selected");var u=k[0].value;k.data("hasform")||
(u=null);u!==m?(q[m]=a("#copyFieldsForm").contents().detach(),q[u]?(a("#copyFieldsForm").append(q[u]),a("#RECORD_TYPE").prop("value",k[0].value)):a("#copyFieldsForm").load(n+" #copyFieldsInner",{NUM:h,RT:u||k[0].value},l)):d()};jQuery(function(){g=a("#RecordTypeName").html();var m=a("#RECORD_TYPE");a(document).on("change","#RECORD_TYPE",f);k=m.find("option:selected");d()})};window.init_validate_duplicate_org_names=function(h){var n=a.extend({selector:"#EntryForm",fields:"#ORG_LEVEL_1,#ORG_LEVEL_2,#ORG_LEVEL_3,#ORG_LEVEL_4,#ORG_LEVEL_5,#LOCATION_NAME,#SERVICE_NAME_LEVEL_1,#SERVICE_NAME_LEVEL_2,#OLS_SELECT input,#ORG_NUM",
only_warn:!0,num:null,org_levels:[],url:null},h),r=[],k=null!==n.num,g=[],q=a(n.selector).submit(function(w){var l,f=!1,m=a(n.fields).serializeArray();n.num&&m.push({name:"NUM",value:n.num});if(m.length!==r.length)f=!0;else for(l=0;l<m.length;l++){var u=m[l];if(u.name!==r[l].name||u.value!==r[l].value){f=!0;break}}if(!f&&k)return!0;var y=function(){n.only_warn&&confirm(n.confirm_string)?(k=!0,a("#duplicate_name_error_box").hide(),q.submit()):(a("#SUBMIT_BUTTON").prop("disabled",!1),a("#duplicate_name_error_box").show())};
w.stopPropagation();w.preventDefault();if(!f)return y(),!1;a.ajax({url:n.url,dataType:"json",method:"get",data:m,success:function(v){k=!0;g=[];for(var p=0;p<v.length;p++)k&=0===v[p].count,0!==v[p].count&&g.push(v[p].type);r=m;k?(a("#duplicate_name_error_box").hide(),q.submit()):y()}});return!1})}})();
(function(){var a=jQuery,e=function(c,b){a("#CM_existing_add_table").removeClass("NotVisible").append(a("<tr>").append(a("<td>").append(a("<input>").prop({id:"CM_ID_"+c,type:"checkbox",checked:!0,defaultChecked:!0,name:"CM_ID",value:c}))).append(a("<td>").addClass("FieldLabelLeftClr").append(document.createTextNode(" "+b))).append(a("<td>").prop("align","center").append(a("<input>").prop({id:"CM_NUM_NEEDED_"+c,name:"CM_NUM_NEEDED_"+c,size:3,maxlength:3}))))};window.init_num_needed=function(c){init_autocomplete_checklist(a,
{field:"CM",source:entryform.community_complete_url,add_new_html:e,minLength:3,txt_not_found:c})};window.init_interests=function(c){var b=[],d=only_items_chk_add_html(a,"AI");init_autocomplete_checklist(a,{field:"AI",source:entryform.interest_complete_url,add_new_html:d,added_values:b,txt_not_found:c});var h=function(r){var k=a("#AreaOfInterestList");k.length&&k.prop("id","AreaOfInterestListOld");a("<ul>").hide().insertAfter(n).prop("id","AreaOfInterestList").append(a(a.map(r,function(g,q){return a("<li>").append(a("<input>").prop({type:"checkbox",
value:g.chkid}).data("cioc_chk_display",g.value)).append(document.createTextNode(" "+g.value))[0]}))).show("slow");k.length&&k.hide("slow",function(){k.remove()})};var n=a("#InterestGroup").change(function(){a.getJSON(entryform.interest_complete_url,{IGID:n.prop("value")},h)});a("#FIELD_INTERESTS").next().on("click","#AreaOfInterestList input:checkbox",{added_values:b,add_item_fn:d},function(r){var k=a(this),g=document.getElementById("AI_ID_"+this.value);g?g.checked=!0:(g=k.data("cioc_chk_display"),
r.data.added_values.push({chkid:this.value,display:g}),r.data.add_item_fn(this.value,g));k.parent().hide("slow",function(){k.remove()})})}})();
(function(){window.init_entryform_notes=function(a,e,c){var b=jQuery;a.each(function(){var d=this,h=b(d),n=h.parent(),r=1,k=h.find(".EntryFormNotesUpdateIds")[0];if(k){var g=h.find(".EntryFormNotesDeleteIds")[0],q=h.find(".EntryFormNotesCancelIds")[0],w=h.find(".EntryFormNotesRestoreIds")[0],l=[],f=[],m=[],u={},y=[],v=function(t,z){l.push(t.id);k.value=l.join(",");var C=h.find(".EntryFormItemBox").length+1;template=h.data("addTmpl");new_item=b(template.replace(/\[COUNT\]/g,C).replace(/\[ID\]/g,t.id).replace(/\[MODIFIED_DATE\]/g,
t.modified_date||"").replace(/\[MODIFIED_BY\]/g,t.modified_by||"").replace(/\[CREATED_DATE\]/g,t.created_date||"").replace(/\[CREATED_BY\]/g,t.created_by||"").replace(/\[NOTE_VALUE\]/g,t.note_value||""));t.note_type&&new_item.find("option[value='"+t.note_type+"']").prop("selected",!0);t.created_date&&new_item.find("tr.CreatedField").show();!t.modified_date||t.modified_date===t.created_date&&t.modified_by===t.created_by||new_item.find("tr.ModifiedField").show();z&&new_item.find(".NewFlag").show();
h.append(new_item)};n.find(".EntryFormItemAdd").click(function(){var t="NEW"+r++;v({id:t},!0)});var p=function(t){var z=t.id.split("_");t=b(t);var C=t.parents(".EntryFormNotesItem");C.find(".EntryFormItemContent").css("text-decoration","line-through");f.push(z[z.length-2]);g.value=f.join(",");C.data("actionToRestore","delete");t.parent().hide().prev().show()},x=function(t,z){var C=t.id.split("_"),F=b(t),D=F.parents(".EntryFormNotesItem"),H=D.find(".EntryFormItemContent"),I=t.id.lastIndexOf("_");t=
t.id.substring(0,I)+"_CANCEL_REASON";C=C[C.length-2];H.prepend(z.data("cancelTemplate"));m.push(C);q.value=m.join(",");u[C]=z.data("cancelType");h.append(b("<input>").prop({type:"hidden",id:t,name:t,value:z.data("cancelType")}));D.data("actionToRestore","cancel");F.parent().hide().prev().show()},A={update:function(t){t=b(t).parents(".EntryFormNotesItem");var z=t.find(".EntryFormItemContent");v(z.data("formValues"));t.hide()},"delete":p,cancel:x},B=n.find(".EntryFormItemActionMenu").menu({select:function(t,
z){b(this).hide();A[z.item.data("action")](B.data("activeButton"),z.item)}}).hide().css({position:"absolute",zIndex:1});n.on("click",".EntryFormItemAction",function(t){B.data("activeButton",this);if(B.is(":visible"))return B.hide(),!1;B.menu("blur").show();B.position({my:"right top",at:"right bottom",of:this});b(document).one("click",function(){B.hide()});return!1});n.find(".EntryFormItemViewHidden").click(function(t){t=b(this);var z=t.next();z.is(":visible")?(t.text(e),z.hide()):(t.text(c),z.show())});
var G={"delete":function(t,z,C,F){F.css("text-decoration","none");f=b.grep(f,function(D){return D!==t});g.value=f.join(",");z.parent().hide().next().show()},cancel:function(t,z,C,F){C=z[0];var D=C.id.lastIndexOf("_");C=C.id.substring(0,D)+"_CANCEL_REASON";F.find(".EntryFormItemCancelledDetails").remove();m=b.grep(m,function(H){return H!==t});q.value=m.join(",");delete u[t];b("#"+C).remove();z.parent().hide().next().show()}};n.on("click",".EntryFormItemRestoreAction",function(t){t=this.id.split("_");
var z=b(this),C=z.parents(".EntryFormNotesItem"),F=C.find(".EntryFormItemContent");G[C.data("actionToRestore")](t[t.length-2],z,C,F)});var E=function(t){t=this.id.split("_");var z=b(this);z.parents(".EntryFormNotesItem").find(".EntryFormItemCancelledDetails").css("text-decoration","line-through");z.parent().hide().prev().show();y.push(t[t.length-2]);w.value=y.join(",")};n.on("click",".EntryFormItemRestoreCancel",E);n.on("click",".EntryFormItemDontRestoreCancel",function(t){var z=this.id.split("_");
t=b(this);t.parents(".EntryFormNotesItem").find(".EntryFormItemCancelledDetails").css("text-decoration","none");t.parent().hide().next().show();z=z[z.length-2];y=b.grep(y,function(C){return C!==z});w.value=y.join(",")});cache_register_onbeforeunload(function(t){t[d.id+"_updates"]=l;t[d.id+"_deletes"]=f;t[d.id+"_restores"]=y;t[d.id+"_cancels"]=m;t[d.id+"_cancel_reason"]=u});cache_register_onbeforerestorevalues(function(t){var z=d.id.substring(0,d.id.lastIndexOf("_"))+"_";t[d.id+"_updates"]&&b.each(t[d.id+
"_updates"],function(F,D){0===D.indexOf("NEW")?(r++,v({id:D},!0)):(F=b("#"+z+D+"_DISPLAY"),v(F.data("formValues")),b("#"+z+D+"_CONTAINER").hide())});t[d.id+"_deletes"]&&b.each(t[d.id+"_deletes"],function(F,D){p(document.getElementById(z+D+"_ACTION"))});t[d.id+"_restores"]&&(b.each(t[d.id+"_restores"],function(F,D){E.call(document.getElementById(z+D+"_RESTORECANCEL"))}),n.find(".EntryFormItemViewHidden").click());if(t[d.id+"_cancels"]){var C=t[d.id+"_cancel_reason"];b.each(t[d.id+"_cancels"],function(F,
D){x(document.getElementById(z+D+"_ACTION"),B.find("li[data-cancel-type='"+C[D]+"']"))})}})}})}})();
