window.CIOC={};
(function(a,d){d.do_drop_down_navigation=function(){for(var k=a.getElementById("ActionList").options,c=0;c<k.length;c++)if(k[c].selected){var g=k[c].getAttribute("href");g&&("undefined"!=typeof k[c].attributes.newwindow?d.open(g):d.location.href=g);break}};jQuery(function(k){k("[data-toggle=dialog]").each(function(){var c=k(this),g=k(c.data("target")),p={autoOpen:!1,title:g.data("title"),modal:g.data("modal")};g.dialog(p);c.click(function(){g.dialog("isOpen")?g.dialog("close"):g.dialog("open")})})})})(document,window);
function CheckAll(a,d){a||="IDList";var k=d;d||(k=document.RecordList);d=k.elements.length;for(var c=0;c<d;c++){var g=k.elements[c];g.name===a&&(g.checked=!0)}}function ClearAll(a,d){a||="IDList";var k=d;d||(k=document.RecordList);d=k.elements.length;for(var c=0;c<d;c++){var g=k.elements[c];g.name===a&&(g.checked=!1)}}function add_class(a,d){a&&!(new RegExp("\\b"+d+"\\b")).test(a.className)&&(a.className&&(d=" "+d),a.className+=d)}
function remove_class(a,d){if(a){for(var k=a.className.split(" "),c=[],g=0;g<k.length;g++){var p=k[g];p!==d&&c.push(p)}a.className=c.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,d){window.open(a,d,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,d){window.open(a,d,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,d){window.open(a,d,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var d={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var k=a(this).data("popargs");(d[k.size||"sm"]||openWin)(this.href,k.name||"popwin");return!1})});
(function(){var a=jQuery,d={},k=function(f){null!==f&&"undefined"!==typeof f?a("#myListCount").text(f):(f=a("#myListCount").text())&&(f=parseInt(f,10));f?d.myListLink.show():d.myListLink.hide()},c=function(f){a.each(f,function(m,l){a("#added_to_list_"+l).show();a("#add_to_list_"+l).hide()})},g=function(f){return function(m){m.fail?alert(m.errinfo):(m.ids?k(a.grep(m.ids,b[d.domain]).length):m.count?k(m.count):k(0),c([f]))}},p=function(f){f=a(f.currentTarget).data("id");a.ajax({success:g(f),dataType:"json",
error:function(){alert("Error")},data:{id:f},type:"POST",url:d.current_list_url})},t=function(f){return function(m){if(m.fail)alert(m.errinfo);else{m=!0;if(f){var l=a("#results_table #remove_from_list_"+f);l.length?l.parent().parent().remove():(m=!1,l=a("#results_container #remove_from_list_"+f),l.parents(".dlist-result").remove())}(m?1!==a("#results_table tr").length:0!==a("#results_container .dlist-result").length)&&f||(a("#records_ui").hide(),a("#no_records_message").show())}}},q=function(f){f=
a(f.currentTarget).data("id");a.ajax({success:t(f),dataType:"json",error:function(){alert("Error")},data:{ID:f,RemoveItem:d.domain},type:"POST",url:d.current_list_url})},r=function(f){a.ajax({success:t(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:d.domain},type:"POST",url:d.current_list_url})},b={CIC:function(f){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(f)},VOL:function(f){return/^[1-9][0-9]*$/.test(f)}},e=function(f){if(f.fail)h();else if(f.inrequest){var m=a.grep(f.ids,
b[d.domain]);c(m);k(m.length);(f=f.previous_ids)&&a.each(f,function(l,u){a("#ct_added_to_previous_request_"+u).show()});a(".ListUI img").prop("src",function(l,u){return u.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();d.current_list_url=d.ct_update_url;n()}else h()},h=function(){var f=function(){d.list_view_mode||c(d.already_added||[]);d.current_list_url=d.list_view_mode&&"ct"===d.list_view_mode?d.ct_update_url:d.list_update_url;k((d.already_added||[]).length);
n()};d.list_view_mode||d.has_session?f():a.ajax({dataType:"json",error:null,url:d.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(m){m.has_session&&f()}})},n=function(){a(".HideListUI").delegate(".add_to_list","click",p).delegate(".remove_from_list","click",q).removeClass("HideListUI");a("#remove_all_from_list").click(r);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(f){d=f;d.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
f.in_request?a.ajax({success:e,dataType:"json",error:null,type:"POST",url:f.in_request}):h()}})();this.JSON||(this.JSON={});
(function(){function a(b){return 10>b?"0"+b:b}function d(b){g.lastIndex=0;return g.test(b)?'"'+b.replace(g,function(e){var h=q[e];return"string"===typeof h?h:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function k(b,e){var h=p,n=e[b];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(b));"function"===typeof r&&(n=r.call(e,b,n));switch(typeof n){case "string":return d(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";p+=t;var f=[];if("[object Array]"===Object.prototype.toString.apply(n)){var m=n.length;for(b=0;b<m;b+=1)f[b]=k(b,n)||"null";e=0===f.length?"[]":p?"[\n"+p+f.join(",\n"+p)+"\n"+h+"]":"["+f.join(",")+"]";p=h;return e}if(r&&"object"===typeof r)for(m=r.length,b=0;b<m;b+=1){var l=r[b];"string"===typeof l&&(e=k(l,n))&&f.push(d(l)+(p?": ":":")+e)}else for(l in n)Object.hasOwnProperty.call(n,l)&&(e=k(l,n))&&f.push(d(l)+(p?": ":":")+e);e=0===f.length?"{}":p?"{\n"+p+f.join(",\n"+
p)+"\n"+h+"}":"{"+f.join(",")+"}";p=h;return e}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(b){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
g=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p,t,q={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},r;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,e,h){var n;t=p="";if("number"===typeof h)for(n=0;n<h;n+=1)t+=" ";else"string"===typeof h&&(t=h);if((r=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return k("",{"":b})});
"function"!==typeof JSON.parse&&(JSON.parse=function(b,e){function h(n,f){var m,l=n[f];if(l&&"object"===typeof l)for(m in l)if(Object.hasOwnProperty.call(l,m)){var u=h(l,m);void 0!==u?l[m]=u:delete l[m]}return e.call(n,f,l)}b=String(b);c.lastIndex=0;c.test(b)&&(b=b.replace(c,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+b+")"),"function"===typeof e?h({"":b},""):b;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var d={};jQuery(a).find("input,select,textarea").each(function(k){if(this.name)if(d[this.name]||(d[this.name]=[]),"select"===this.nodeName.toLowerCase()){var c=d[this.name];$(this).find("option").each(function(g){this.selected&&c.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&d[this.name].push(this.value||"")});return d};window.restore_form_values=function(a,d){var k=jQuery;k(a).find("input,select,textarea").each(function(c){if(this.name){var g=
d[this.name];"undefined"!=typeof g&&null!==g&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?k(this).find("option").each(function(p){this.selected=1<g.length?0<=k.inArray(this.value,g):0===g.length?!1:this.value===g[0]}):this.value=g.length?g[0]:"":this.checked=1<g.length?0<=k.inArray(this.value,g):0===g.length?!1:this.value===g[0])}})};window.init_cached_state=function(a){var d=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];var k=function(){var c=document.getElementById("cache_form_values");if(c){var g={form_values:get_form_values(a)};d.each(onbeforeunload_fns,function(p,t){t(g)});c.value=JSON.stringify(g)}};document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState&&k()});document.addEventListener("freeze",k);window.addEventListener("pagehide",k);window.cache_register_onbeforeunload=function(c){onbeforeunload_fns.push(c)};window.cache_register_onbeforerestorevalues=
function(c){onbeforerestorevalues_fns.push(c)};window.restore_cached_state=function(){d(window).on("pageshow",function(c){if(!c.originalEvent.persisted&&(c=document.getElementById("cache_form_values"))&&c.value){var g=JSON.parse(c.value);d.each(onbeforerestorevalues_fns,function(p,t){t(g)});restore_form_values(a,g.form_values)}})}}})();
(function(){var a=jQuery,d={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},k={"en-CA":!0,"":!0},c={},g={"fr-CA":"fr","es-MX":"es"},p=function(){var q=a(this),r=q.data("culture"),b=d[r]||a.datepicker.regional[r].dateFormat,e={};q.hasClass("NoYear")&&(b=b.replace(/[\- .\/]*yy[\/]?/,""),e={beforeShow:function(h,
n){n.dpDiv.addClass("NoYearDatePicker")},onClose:function(h,n){n.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});e.dateFormat=b;q.datepicker(a.extend({},a.datepicker.regional[r],e)).prop("autocomplete","off")},t=function(q){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+q+".min.js",function(){k[q]=!0;a.each(c[q],function(){p.call(this)});delete c[q]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var q=
a(this);var r=q.parents("[lang]").first().prop("lang")||"en-CA";r=g[r]||r;q.data("culture",r);k[r]?p.call(this):(q=c[r],q||(q=c[r]=[],t(r)),q.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(){var a=function(c){c=c.toLowerCase();c=c.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");c=c.replace(RegExp("\u00e6","g"),"ae");c=c.replace(RegExp("\u00e7","g"),"c");c=c.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");c=c.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");c=c.replace(RegExp("\u00f1","g"),"n");c=c.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");c=c.replace(RegExp("\u009c","g"),"oe");c=c.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return c=c.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;window.slugify=function(c){c=a(c);c=c.replace(/-/g," ").replace(/[^a-z0-9\s]/g,"");c=c.trim();return c.replace(/\s+/g,"-")};var d=function(c,g,p,t,q){p=p||"value";t=t||"";q=q||"";return function(r,b){if(g.term&&(new RegExp(t+c.ui.autocomplete.escapeRegex(g.term)+q,"i")).test(r.term)&&g.content&&13>g.content.length){var e=new RegExp(t+c.ui.autocomplete.escapeRegex(r.term)+q,"i");b(c.grep(g.content,function(h){return e.test(a(h[p]))}));
return!0}return!1}};window.default_cache_search_fn=d;var k=function(c,g,p,t,q){p=p||{};q=q||d(c,p,t||"value");return function(r,b,e){r.term=a(r.term);p.term===r.term&&p.content?b(p.content):q(r,b)||c.ajax({url:e||g,dataType:"json",data:r,cache:!1,success:function(h){p.term=r.term;p.content=h;b(h)}})}};window.create_caching_source_fn=k;window.init_community_autocomplete=function(c,g,p,t,q){var r={};q&&=c(q);q&&!q.length&&(q=null);var b=c("#"+g).autocomplete({focus:function(e,h){return!1},select:function(e,
h){b.data({chkid:h.item.chkid,display:h.item.value})},source:k(c,p,r),minLength:t}).keypress(function(e){"13"==e.keyCode&&(e.preventDefault(),b.autocomplete("close"))});q&&(b.parents("form").on("submit",function(){var e=b.val();if(b.data("display")===e)q.val(b.data("chkid"));else{if(r.content){var h=a(e);e=c.grep(r.content,function(n){return a(n.value)===h});if(1===e.length){q.val(e[0].chkid);b.data({chkid:e[0].chkid,display:e[0].value}).val(e[0].value);return}}q.val("")}}),cache_register_onbeforerestorevalues(function(e){b.length&&
(e=e["autocomplete_data_"+b[0].id])&&b.data(e)}),cache_register_onbeforeunload(function(e){if(b.length){var h=b.data();h.display&&h.chkid&&(e["autocomplete_data_"+b[0].id]={display:h.display,chkid:h.chkid})}}))}})();
(function(){var a=jQuery,d=function(b){return function(e){b.after(e.join(""))}},k=function(b){b=a(this);var e=b.parents("tr").first();if(b.data("closed")){var h=b.data("url");a.ajax({success:d(e),data:{LV:b.data("level")+1},dataType:"json",url:h});b.data("closed",!1);b.find("img").prop("src",function(n,f){return f.replace("plus","minus")})}else{parent_classes=[".TaxRowLevel"+b.data("level")];for(h=1;h<b.data("level");h++)parent_classes.push(".TaxRowLevel"+h);e.nextUntil(parent_classes.join(",")).remove();
b.data("closed",!0);b.find("img").prop("src",function(n,f){return f.replace("minus","plus")})}},c=function(b){return function(e){e&&b.html('<div class="MoreTermInfo">'+e[0]+"</div>")}},g=function(b){b=a(this);var e=b.parents("td").first().find(".taxDetail");if(b.data("closed")){var h=b.data("url");a.ajax({success:c(e),dataType:"json",url:h});b.data("closed",!1)}else e.empty(),b.data("closed",!0)},p=function(b){b=a(this);var e=b.data("which"),h=1,n="up";"up"===b.data("state")&&(h=-1,n="down");b.parents("tr").first().find("img").prop("src",
function(m,l){var u=l.substring(0,l.lastIndexOf("/")+1);l=l.substring(l.lastIndexOf("."));return m===e?u+n+l:u+"noplusminus"+l});b.parents("tr").first().find(".taxHeaderSort").each(function(m,l){m===e?a(l).data("state",n):a(l).data("state","noplusminus")});var f=b.parents("table").first().find("tbody");b=f.find("tr").get();b.sort(function(m,l){m=a(m).data("sortkey")[e].toUpperCase();l=a(l).data("sortkey")[e].toUpperCase();return m<l?-1*h:m>l?1*h:0});a.each(b,function(m,l){f.append(l)})},t=null,q=
{},r=function(b){null===t&&(t=a("#activations-table").data("url"),q=a("#activations-table").data("paramBase"));return function(){var e=a(this),h=e.parent().find("span:first"),n=h.data("taxcode");a.ajax({url:t,type:"POST",dataType:"json",data:a.extend({},q,{TC:n,action:e.data("action"),LV:h.data("level")+1}),success:function(f){f.buttonstates&&a.each(f.buttonstates,function(m,l){m=a("#tax-code-"+l.code.replace(/\./,"-"));var u=m.find(".taxExpandTerm").first();null===l.active?m.find(".rollup-indicator").removeClass("hidden"):
m.find(".rollup-indicator").addClass("hidden");l.active?(u.removeClass("TaxLinkInactive"),u.addClass("TaxLink")):(u.addClass("TaxLinkInactive"),u.removeClass("TaxLink"));l.activate?m.find(".activate").removeClass("hidden"):m.find(".activate").addClass("hidden");l.deactivate?m.find(".deactivate").removeClass("hidden"):m.find(".deactivate").addClass("hidden");l.rollup?m.find(".rollup").removeClass("hidden"):m.find(".rollup").addClass("hidden")})},failure:function(){}})}};a(function(){a("#page_content").on("click",
"span.taxPlusMinus",k).on("click","span.taxExpandTerm",g).on("click",".taxHeaderSort",p).on("click",".activate",r("activate")).on("click",".deactivate",r("deactivate")).on("click",".rollup",r("rollup"))});window.init_taxcode_autocomplete=function(b){a("#TC").autocomplete({focus:function(e,h){return!1},source:create_caching_source_fn(a,b,"value"),minLength:1}).data("autocomplete")._renderItem=function(e,h){return a("<li></li>").data("item.autocomplete",h).append(a("<a></a>").text(h.value+" - "+h.label)).appendTo(e)}}})();
