function initialize_maps(e){function B(){e("#GEOCODE_TYPE_SITE_REFRESH, #GEOCODE_TYPE_INTERSECTION_REFRESH").addClass("NotVisible");e("#GEOCODE_TYPE_MANUAL").prop("checked",true);var a=this.getPoint().toUrlValue().split(",");h.apply(null,a)}function j(a,b){var c=new google.maps.LatLng(a,b);p?g.setCenter(c,14):g.panTo(c);p=false;c=new google.maps.Marker(c,{clickable:false,draggable:true});var d=google.maps.Event.addListener(c,"dragend",B);g.addOverlay(c);q();k=c;r=d}function C(a,b){return function(c){if(!c||
c.Status.code!=200){if(c){if(c.Status.code==602&&!b&&document.getElementById("GEOCODE_TYPE_SITE").checked){l(a,true);return}var d=null;switch(c.Status.code){case 602:d=pageconstants.txt_geocode_unknown_address;break;case 610:d=pageconstants.txt_geocode_map_key_fail;break;case 620:d=pageconstants.txt_geocode_too_many_queries;break;default:d=pageconstants.txt_geocode_unknown_error+c.Status.code.toString()}}alert(d);a(null)}else{b&&show(document.getElementById("geocode_no_postal_code"));a(c.Placemark[0])}}}
function t(a){var b=document.getElementById("EntryForm"),c=[];if(!b.SITE_STREET_NUMBER)return null;var d=[b.SITE_STREET_NUMBER.value,b.SITE_STREET.value,b.SITE_STREET_TYPE.value,b.SITE_STREET_DIR.value].join(" ");d=d.replace(/^\s+/g,"");(d=d.replace(/\s+$/g,""))&&c.push(d);var f=["SITE_CITY","SITE_PROVINCE"];a||f.push("SITE_POSTAL_CODE");for(a=0;a<f.length;a++)(d=b[f[a]].value)&&c.push(d);(d=b.SITE_COUNTRY.value)?c.push(d):c.push("Canada");b=c.join(", ");if(!b||b=="Canada")return null;return b}function u(){var a=
document.EntryForm,b=[];if(!a.INTERSECTION&&!a.INTERSECTION.value)return null;for(var c=["INTERSECTION","SITE_CITY","SITE_PROVINCE"],d=0;d<c.length;d++){var f=a[c[d]].value;f&&b.push(f)}(f=a.SITE_COUNTRY.value)?b.push(f):b.push("Canada");return b.join(", ")}function v(a,b,c){if(m=a){hide(document.getElementById("geocode_no_postal_code"));w.getLocations(a,C(b,c))}else{q();h("","");b(null)}}function l(a,b){var c=t(b);v(c,a,b)}function s(a){var b=u();v(b,a)}function h(a,b){var c=document.EntryForm;c.LATITUDE.value=
a.toString();c.LONGITUDE.value=b.toString()}function i(a){if(a){n=m;h(a.Point.coordinates[1],a.Point.coordinates[0]);j(a.Point.coordinates[1],a.Point.coordinates[0])}}function x(a){i(a)}function y(){g.setCenter(new google.maps.LatLng(z[0],z[1]),2)}function q(){if(k){g.removeOverlay(k);google.maps.Event.removeListener(r)}r=k=null}function A(a){o(false);e("#GEOCODE_TYPE_SITE_REFRESH,#GEOCODE_TYPE_INTERSECTION_REFRESH").addClass("NotVisible");!k&&!a&&l(function(b){if(b)i(b);else{p=false;b=g.getCenter();
b=b.toUrlValue().split(",");h.apply(null,b);j.apply(null,b);m=n=null}})}function o(a){var b=document.getElementById("map_refresh_ui_area");if(b){document.getElementById("LONGITUDE").readOnly=a;document.getElementById("LATITUDE").readOnly=a;(a?hide:show)(b)}}var w=null,g=null,k=null,r=null,p=true,n=null,m=null;window.store_and_map_coordinates=function(a,b){if(typeof a!="undefined"&&a!==null&&typeof b!="undefined"&&b!==null){n=m;h(a,b);j(a,b)}};var z=[59.888937,-101.601562];window.do_geocode_type_manual=
A;google.load("maps","2.s",{other_params:"sensor=false",language:pageconstants.culture,callback:function(){window.onUnload=google.maps.Unload;if(google.maps.BrowserIsCompatible()){g=new google.maps.Map2(document.getElementById("map_canvas"));y();g.setUIToDefault();w=new google.maps.ClientGeocoder;e("#GEOCODE_TYPE_SITE").click(function(){e("#GEOCODE_TYPE_INTERSECTION_REFRESH").addClass("NotVisible");e("#GEOCODE_TYPE_SITE_REFRESH").removeClass("NotVisible");o(true);l(i)});e("#GEOCODE_TYPE_INTERSECTION").click(function(){e("#GEOCODE_TYPE_INTERSECTION_REFRESH").removeClass("NotVisible");
e("#GEOCODE_TYPE_SITE_REFRESH").addClass("NotVisible");o(true);s(i)});e("#GEOCODE_TYPE_MANUAL").click(function(){A(false)});e("#GEOCODE_TYPE_BLANK").click(function(){e("#GEOCODE_TYPE_SITE_REFRESH,#GEOCODE_TYPE_INTERSECTION_REFRESH").addClass("NotVisible");o(true);q();y();p=true;hide(document.getElementById("geocode_no_postal_code"));h("","");n=m=null});e("#GEOCODE_TYPE_SITE_REFRESH").click(function(){l(i)});e("#GEOCODE_TYPE_INTERSECTION_REFRESH").click(function(){s(i)});var a=document.EntryForm,b=
document.getElementById("map_refresh");b&&e(b).click(function(){j(a.LATITUDE.value,a.LONGITUDE.value)});a.LATITUDE.value&&a.LONGITUDE.value&&j(a.LATITUDE.value,a.LONGITUDE.value);if(a.SITE_STREET_NUMBER){if(document.getElementById("GEOCODE_TYPE_SITE").checked){l(x);e("#GEOCODE_TYPE_SITE_REFRESH").removeClass("NotVisible")}}else{a.GEOCODE_TYPE_SITE.disabled=true;hide(document.getElementById("GEOCODE_TYPE_SITE_REFRESH"))}if(a.INTERSECTION){if(document.getElementById("GEOCODE_TYPE_INTERSECTION").checked){s(x);
e("#GEOCODE_TYPE_INTERSECTION_REFRESH").removeClass("NotVisible")}}else{a.GEOCODE_TYPE_INTERSECTION.disabled=true;hide(document.getElementById("GEOCODE_TYPE_SITE_REFRESH"))}o(!a.GEOCODE_TYPE_MANUAL.checked);e(a).submit(function(c){var d=null,f=null;if(document.getElementById("GEOCODE_TYPE_SITE").checked){d=t();f=pageconstants.txt_geocode_address_changed}else if(document.getElementById("GEOCODE_TYPE_INTERSECTION").checked){d=u();f=pageconstants.txt_geocode_intersection_change}if(f&&d!=n)if(!confirm(f)){document.getElementById("map_canvas").scrollIntoView(true);
document.documentElement.scrollTop-=10;c.preventDefault();c.stopImmediatePropagation();e("#SUBMIT_BUTTON").prop("disabled",false)}})}}})};
