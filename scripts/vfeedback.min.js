/*
 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Version 2.1.2
*/
window.CIOC={};
(function(a,d){d.do_drop_down_navigation=function(){for(var b=a.getElementById("ActionList").options,c=0;c<b.length;c++)if(b[c].selected){var e=b[c].getAttribute("href");e&&("undefined"!=typeof b[c].attributes.newwindow?d.open(e):d.location.href=e);break}};jQuery(function(b){b("[data-toggle=dialog]").each(function(){var c=b(this),e=b(c.data("target")),k={autoOpen:!1,title:e.data("title"),modal:e.data("modal")};e.dialog(k);c.click(function(){e.dialog("isOpen")?e.dialog("close"):e.dialog("open")})})})})(document,window);
function CheckAll(a,d){a||="IDList";var b=d;d||(b=document.RecordList);d=b.elements.length;for(var c=0;c<d;c++){var e=b.elements[c];e.name===a&&(e.checked=!0)}}function ClearAll(a,d){a||="IDList";var b=d;d||(b=document.RecordList);d=b.elements.length;for(var c=0;c<d;c++){var e=b.elements[c];e.name===a&&(e.checked=!1)}}function add_class(a,d){a&&!(new RegExp("\\b"+d+"\\b")).test(a.className)&&(a.className&&(d=" "+d),a.className+=d)}
function remove_class(a,d){if(a){for(var b=a.className.split(" "),c=[],e=0;e<b.length;e++){var k=b[e];k!==d&&c.push(k)}a.className=c.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,d){window.open(a,d,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,d){window.open(a,d,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,d){window.open(a,d,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var d={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var b=a(this).data("popargs");(d[b.size||"sm"]||openWin)(this.href,b.name||"popwin");return!1})});
(function(){var a=jQuery,d={},b=function(g){null!==g&&"undefined"!==typeof g?a("#myListCount").text(g):(g=a("#myListCount").text())&&(g=parseInt(g,10));g?d.myListLink.show():d.myListLink.hide()},c=function(g){a.each(g,function(n,u){a("#added_to_list_"+u).show();a("#add_to_list_"+u).hide()})},e=function(g){return function(n){n.fail?alert(n.errinfo):(n.ids?b(a.grep(n.ids,f[d.domain]).length):n.count?b(n.count):b(0),c([g]))}},k=function(g){g=a(g.currentTarget).data("id");a.ajax({success:e(g),dataType:"json",
error:function(){alert("Error")},data:{id:g},type:"POST",url:d.current_list_url})},p=function(g){return function(n){if(n.fail)alert(n.errinfo);else{n=!0;if(g){var u=a("#results_table #remove_from_list_"+g);u.length?u.parent().parent().remove():(n=!1,u=a("#results_container #remove_from_list_"+g),u.parents(".dlist-result").remove())}(n?1!==a("#results_table tr").length:0!==a("#results_container .dlist-result").length)&&g||(a("#records_ui").hide(),a("#no_records_message").show())}}},m=function(g){g=
a(g.currentTarget).data("id");a.ajax({success:p(g),dataType:"json",error:function(){alert("Error")},data:{ID:g,RemoveItem:d.domain},type:"POST",url:d.current_list_url})},h=function(g){a.ajax({success:p(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:d.domain},type:"POST",url:d.current_list_url})},f={CIC:function(g){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(g)},VOL:function(g){return/^[1-9][0-9]*$/.test(g)}},l=function(g){if(g.fail)q();else if(g.inrequest){var n=a.grep(g.ids,
f[d.domain]);c(n);b(n.length);(g=g.previous_ids)&&a.each(g,function(u,w){a("#ct_added_to_previous_request_"+w).show()});a(".ListUI img").prop("src",function(u,w){return w.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();d.current_list_url=d.ct_update_url;r()}else q()},q=function(){var g=function(){d.list_view_mode||c(d.already_added||[]);d.current_list_url=d.list_view_mode&&"ct"===d.list_view_mode?d.ct_update_url:d.list_update_url;b((d.already_added||[]).length);
r()};d.list_view_mode||d.has_session?g():a.ajax({dataType:"json",error:null,url:d.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(n){n.has_session&&g()}})},r=function(){a(".HideListUI").delegate(".add_to_list","click",k).delegate(".remove_from_list","click",m).removeClass("HideListUI");a("#remove_all_from_list").click(h);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(g){d=g;d.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
g.in_request?a.ajax({success:l,dataType:"json",error:null,type:"POST",url:g.in_request}):q()}})();this.JSON||(this.JSON={});
(function(){function a(f){return 10>f?"0"+f:f}function d(f){e.lastIndex=0;return e.test(f)?'"'+f.replace(e,function(l){var q=m[l];return"string"===typeof q?q:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function b(f,l){var q=k,r=l[f];r&&"object"===typeof r&&"function"===typeof r.toJSON&&(r=r.toJSON(f));"function"===typeof h&&(r=h.call(l,f,r));switch(typeof r){case "string":return d(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);
case "object":if(!r)return"null";k+=p;var g=[];if("[object Array]"===Object.prototype.toString.apply(r)){var n=r.length;for(f=0;f<n;f+=1)g[f]=b(f,r)||"null";l=0===g.length?"[]":k?"[\n"+k+g.join(",\n"+k)+"\n"+q+"]":"["+g.join(",")+"]";k=q;return l}if(h&&"object"===typeof h)for(n=h.length,f=0;f<n;f+=1){var u=h[f];"string"===typeof u&&(l=b(u,r))&&g.push(d(u)+(k?": ":":")+l)}else for(u in r)Object.hasOwnProperty.call(r,u)&&(l=b(u,r))&&g.push(d(u)+(k?": ":":")+l);l=0===g.length?"{}":k?"{\n"+k+g.join(",\n"+
k)+"\n"+q+"}":"{"+g.join(",")+"}";k=q;return l}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(f){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(f){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k,p,m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;"function"!==typeof JSON.stringify&&(JSON.stringify=function(f,l,q){var r;p=k="";if("number"===typeof q)for(r=0;r<q;r+=1)p+=" ";else"string"===typeof q&&(p=q);if((h=l)&&"function"!==typeof l&&("object"!==typeof l||"number"!==typeof l.length))throw Error("JSON.stringify");return b("",{"":f})});
"function"!==typeof JSON.parse&&(JSON.parse=function(f,l){function q(r,g){var n,u=r[g];if(u&&"object"===typeof u)for(n in u)if(Object.hasOwnProperty.call(u,n)){var w=q(u,n);void 0!==w?u[n]=w:delete u[n]}return l.call(r,g,u)}f=String(f);c.lastIndex=0;c.test(f)&&(f=f.replace(c,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+f+")"),"function"===typeof l?q({"":f},""):f;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var d={};jQuery(a).find("input,select,textarea").each(function(b){if(this.name)if(d[this.name]||(d[this.name]=[]),"select"===this.nodeName.toLowerCase()){var c=d[this.name];$(this).find("option").each(function(e){this.selected&&c.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&d[this.name].push(this.value||"")});return d};window.restore_form_values=function(a,d){var b=jQuery;b(a).find("input,select,textarea").each(function(c){if(this.name){var e=
d[this.name];"undefined"!=typeof e&&null!==e&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?b(this).find("option").each(function(k){this.selected=1<e.length?0<=b.inArray(this.value,e):0===e.length?!1:this.value===e[0]}):this.value=e.length?e[0]:"":this.checked=1<e.length?0<=b.inArray(this.value,e):0===e.length?!1:this.value===e[0])}})};window.init_cached_state=function(a){var d=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];d(window).on("beforeunload",function(){var b={form_values:get_form_values(a)};d.each(onbeforeunload_fns,function(c,e){e(b)});document.getElementById("cache_form_values").value=JSON.stringify(b)});window.cache_register_onbeforeunload=function(b){onbeforeunload_fns.push(b)};window.cache_register_onbeforerestorevalues=function(b){onbeforerestorevalues_fns.push(b)};window.restore_cached_state=function(){var b=document.getElementById("cache_form_values");if(b&&b.value){var c=
JSON.parse(b.value);d.each(onbeforerestorevalues_fns,function(e,k){k(c)});restore_form_values(a,c.form_values)}}}})();
(function(){var a=jQuery,d={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},b={"en-CA":!0,"":!0},c={},e={"fr-CA":"fr","es-MX":"es"},k=function(){var m=a(this),h=m.data("culture"),f=d[h]||a.datepicker.regional[h].dateFormat,l={};m.hasClass("NoYear")&&(f=f.replace(/[\- .\/]*yy[\/]?/,""),l={beforeShow:function(q,
r){r.dpDiv.addClass("NoYearDatePicker")},onClose:function(q,r){r.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});l.dateFormat=f;m.datepicker(a.extend({},a.datepicker.regional[h],l)).prop("autocomplete","off")},p=function(m){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+m+".min.js",function(){b[m]=!0;a.each(c[m],function(){k.call(this)});delete c[m]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var m=
a(this);var h=m.parents("[lang]").first().prop("lang")||"en-CA";h=e[h]||h;m.data("culture",h);b[h]?k.call(this):(m=c[h],m||(m=c[h]=[],p(h)),m.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(a){a.widget("ui.combobox",{options:{source:null},_create:function(){var d=this.element;this.options.source&&(a(d).autocomplete({focus:function(b,c){return!1},source:this.options.source,delay:0,minLength:0}),a("<span>").insertAfter(d).addClass("SmallButton DownButton").css("margin-left","1px").click(function(b){d.autocomplete("widget").is(":visible")?d.autocomplete("close"):(d.autocomplete("search",""),d.focus())}))}})})(jQuery);
(function(a){function d(b){return b&&b.constructor===Number?b+"px":b}a.fn.bgiframe=a.browser.msie&&/msie 6\.0/i.test(navigator.userAgent)?function(b){b=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;"},b);var c='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+b.src+'"style="display:block;position:absolute;z-index:-1;'+(!1!==b.opacity?"filter:Alpha(Opacity='0');":"")+"top:"+("auto"==b.top?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":
d(b.top))+";left:"+("auto"==b.left?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":d(b.left))+";width:"+("auto"==b.width?"expression(this.parentNode.offsetWidth+'px')":d(b.width))+";height:"+("auto"==b.height?"expression(this.parentNode.offsetHeight+'px')":d(b.height))+';"/>';return this.each(function(){0===a(this).children("iframe.bgiframe").length&&this.insertBefore(document.createElement(c),this.firstChild)})}:function(){return this};a.fn.bgIframe=a.fn.bgiframe})(jQuery);
(function(){var a=function(c){c=c.toLowerCase();c=c.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");c=c.replace(RegExp("\u00e6","g"),"ae");c=c.replace(RegExp("\u00e7","g"),"c");c=c.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");c=c.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");c=c.replace(RegExp("\u00f1","g"),"n");c=c.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");c=c.replace(RegExp("\u009c","g"),"oe");c=c.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return c=c.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;var d=function(c,e,k,p,m){k=k||"value";p=p||"";m=m||"";return function(h,f){if(e.term&&(new RegExp(p+c.ui.autocomplete.escapeRegex(e.term)+m,"i")).test(h.term)&&e.content&&13>e.content.length){var l=new RegExp(p+c.ui.autocomplete.escapeRegex(h.term)+m,"i");f(c.grep(e.content,function(q){return l.test(a(q[k]))}));return!0}return!1}};window.default_cache_search_fn=d;var b=function(c,e,k,p,m){k=k||{};m=m||d(c,k,p||"value");
return function(h,f,l){h.term=a(h.term);k.term===h.term&&k.content?f(k.content):m(h,f)||c.ajax({url:l||e,dataType:"json",data:h,cache:!1,success:function(q){k.term=h.term;k.content=q;f(q)}})}};window.create_caching_source_fn=b;window.init_community_autocomplete=function(c,e,k,p,m){var h={};m&&=c(m);m&&!m.length&&(m=null);var f=c("#"+e).autocomplete({focus:function(l,q){return!1},select:function(l,q){f.data({chkid:q.item.chkid,display:q.item.value})},source:b(c,k,h),minLength:p}).keypress(function(l){"13"==
l.keyCode&&(l.preventDefault(),f.autocomplete("close"))});m&&(f.parents("form").on("submit",function(){var l=f.val();if(f.data("display")===l)m.val(f.data("chkid"));else{if(h.content){var q=a(l);l=c.grep(h.content,function(r){return a(r.value)===q});if(1===l.length){m.val(l[0].chkid);f.data({chkid:l[0].chkid,display:l[0].value}).val(l[0].value);return}}m.val("")}}),cache_register_onbeforerestorevalues(function(l){f.length&&(l=l["autocomplete_data_"+f[0].id])&&f.data(l)}),cache_register_onbeforeunload(function(l){if(f.length){var q=
f.data();q.display&&q.chkid&&(l["autocomplete_data_"+f[0].id]={display:q.display,chkid:q.chkid})}}))}})();
(function(){window.entryform=window.entryform||{};window.create_checklist_onbefore_fns=function(b,c,e,k){cache_register_onbeforeunload(function(p){p[c+"_added"]=e});cache_register_onbeforerestorevalues(function(p){(p=p[c+"_added"])&&b.each(p,function(m,h){k(h.chkid,h.display,"")})})};window.basic_chk_add_html=function(b,c){return function(e,k){e=b("<tr>").append(b("<td>").append(b("<input>").prop({id:c+"_ID_"+e,type:"checkbox",checked:!0,defaultChecked:!0,name:c+"_ID",value:e})).append(document.createTextNode(" "+
k))).append(b("<td>").append(b("<input>").prop({id:c+"_NOTES_"+e,name:c+"_NOTES_"+e,size:entryform.chk_notes_size,maxlength:entryform.chk_notes_maxlen})));b("#"+c+"_existing_add_table").append(e);return e.find('input[type="checkbox"]')[0]}};var a={},d=function(b){$("#NEW_"+b).autocomplete(a[b])};window.init_autocomplete_checklist=function(b,c){var e=c.field;if(!a[e]){var k=c.source;c.minLength=c.minLength||1;c.delay=c.delay||300;c.add_new_html=c.add_new_html||basic_chk_add_html(b,e);c.match_prop=
c.match_prop||"value";c.txt_not_found=c.txt_not_found||"Not Found";var p=b(c.delegate_root||document),m=c.added_values||[],h=function(g,n,u){var w=document.getElementById(e+"_ID_"+g);w?(w.checked=!0,c.after_add_new_value&&c.after_add_new_value.call(w)):(m.push({chkid:g,display:n,label:u}),g=c.add_new_html(g,n,u),c.after_add_new_value&&c.after_add_new_value.call(g))};create_checklist_onbefore_fns(b,e,m,h);var f={},l=function(g){b("#NEW_"+e).data({chkid:"",display:"",label:""}).prop("value","").focus();
b("#"+e+"_error").hide("slow",function(){b(this).remove()})},q=null,r=null;(function(g){b.isArray(g)?(r=function(n,u){var w=new RegExp(b.ui.autocomplete.escapeRegex(string_ci_ai(n.term)));u(b.grep(g,function(t){return w.test(string_ci_ai(t[c.match_prop]||t))}))},q=function(n,u){var w=string_ci_ai(n);n=b.grep(g,function(t){return string_ci_ai(string_ci_ai(t[c.match_prop]||t))===w});if(1===n.length)return u(n[0]),!0;u()}):"string"===typeof g?(r=create_caching_source_fn(b,g,f,c.match_prop),q=function(n,
u,w){var t=string_ci_ai(n);if(f.content){var v=b.grep(f.content,function(x){return string_ci_ai(x[c.match_prop])===t});if(1===v.length){u(v[0]);return}}w||string_ci_ai(f.term||"")===t?u():r({term:t},function(x){q(n,u,!0)})}):(r=g,q=c.look_for_fn)})(k);p.on("click","#add_"+e,function(g){g=b("#NEW_"+e);var n=g.data("chkid"),u=g.data("display"),w=g.data("label"),t=g[0].value;if(n&&u&&u==t)return h(n,u,w),l(),!1;q(g[0].value,function(v){v?(h(v.chkid,v.value,v.label),l()):0===b("#"+e+"_error").length&&
(b("#"+e+"_new_input_table").before(b("<p>").hide().addClass("Alert").prop("id",e+"_error").append(document.createTextNode(c.txt_not_found))),b("#"+e+"_error").show("slow"))});return!1});a[e]={focus:function(g,n){return!1},source:r,minLength:c.minLength,delay:c.delay,select:function(g,n){b("#NEW_"+e).data({chkid:n.item.chkid,display:n.item.value,label:n.item.label})}};p.on("keypress","#NEW_"+e,function(g){"13"==g.keyCode&&(g.preventDefault(),b("#NEW_"+e).autocomplete("close"),b("#add_"+e).trigger("click"))})}d(e)};
window.init_languages=function(b,c){var e=null,k=null,p=b("#LN_existing_add_table"),m=function(){var h=b(this).parents(".language-entry").find(".language-details-notes");this.checked?h.slideDown():h.slideUp()};init_autocomplete_checklist(b,{field:"LN",source:entryform.languages_source,txt_not_found:c,after_add_new_value:m,add_new_html:function(h,f){null===e&&(e=b("#add_LN"),k=e.data("newTemplate"));h=k.replace(/LANGNAMELANGNAME/g,f).replace(/IDIDID/g,h);p.append(h)}});p.on("change",".language-primary",
m).uitooltip({items:"[data-help-text]",content:function(){return'<div class="language-help-text">'+b(this).data("helpText")+"</div>"},position:{my:"center bottom-20",at:"center top",using:function(h,f){b(this).css(h);b("<div>").addClass("arrow").addClass(f.vertical).addClass(f.horizontal).appendTo(this)}}});window.languages_check_state=m}})();
(function(){var a=jQuery;window.configure_entry_form_button=function(){a("#SUBMIT_BUTTON").click(function(d){d=a("#SUBMIT_BUTTON");d.prop("disabled")||(d.prop("disabled",!0),setTimeout(function(){a("#EntryForm").submit()},1))});a(document).bind("keydown",function(d){if(d.ctrlKey&&"s"===String.fromCharCode(d.which).toLowerCase())return setTimeout(function(){a("#SUBMIT_BUTTON").click()},1),d.preventDefault(),d.stopPropagation(),!1});a("#SUBMIT_BUTTON").prop("disabled",!1)};window.configure_feedback_submit_button=
function(){var d=a("#SUBMIT_BUTTON").prop("value");a("#SUBMIT_BUTTON").replaceWith(a('<input type="button" class="btn btn-default" id="SUBMIT_BUTTON">').prop("value",d));a("#EntryForm").submit(function(){var b=validateForm();!1===b&&a("#SUBMIT_BUTTON").prop("disabled",!1);return b})}})();
(function(){window.only_items_chk_add_html=function(a,d,b){return function(c,e){b&&b();a("#"+d+"_existing_add_container").append(a("<label>").append(a("<input>").prop({id:d+"_ID_"+c,type:"checkbox",checked:!0,defaultChecked:!0,name:d+"_ID",value:c})).append("&nbsp;").append(document.createTextNode(e))).append(" ; ")}};window.init_check_for_autochecklist=function(a){var d=jQuery,b=function(){return d("<li>").append(d("<span>").data("jump_location",this.id).addClass("UnaddedChecklistJump SimulateLink").append(d(this).parentsUntil("td[data-field-display-name]").parent().data("fieldDisplayName")))},
c=d("input[id^=NEW_]");c.length&&(d("#EntryForm").submit(function(e){var k=c.map(function(){return this.value?this:null});if(k.length&&!e.isDefaultPrevented()){if(!confirm(a)){e.preventDefault();d("#SUBMIT_BUTTON").prop("disabled",!1);e=d("#unadded_checklist_error_box");var p=d("#unadded_checklist_error_list");var m=e.is(":visible");m&&p.children("ul:first").hide("slow",function(){d(this).remove()});var h=d("<ul>");m&&h.hide();p.append(h);d.each(k.map(b),function(){h.append(this)});m?h.show("slow"):
e.show("slow")}}else e.isDefaultPrevented()&&(e=d("#unadded_checklist_error_box"),p=d("#unadded_checklist_error_list"),e.hide("slow",function(){p.children().remove()}))}),d(document).on("click",".UnaddedChecklistJump",function(){var e=d(this).data("jump_location");(e=document.getElementById(e))&&e.scrollIntoView(!0)}))};window.init_entryform_items=function(a,d,b){var c=jQuery;a.each(function(){var e=null,k=this,p=c(k),m=1,h=p.find(".EntryFormItemContainerIds")[0];if(h){var f=p.data("maxAdd");f&&=
parseInt(f,10);var l=[];h.value&&(l=c.map(h.value.split(","),function(t){return 0===t.indexOf("NEW")&&0!==t.indexOf("NEWFB")?null:t}));var q={},r=function(){p.find(".EntryFormItemBox").each(function(t){c(this).find(".EntryFormItemCount").text(t+1)})},g=function(t){if(f){var v=p.find(".EntryFormItemContent:hidden").parent().find("button.EntryFormItemDelete").prop("disabled",!t);w.prop("disabled",!t);t?(v.removeClass("ui-state-disabled"),w.removeClass("ui-state-disabled")):(v.addClass("ui-state-disabled"),
w.addClass("ui-state-disabled"))}},n=function(){var t=0,v;for(v in q)t++;return l.length-t},u=function(t){var v=0;if(f&&!t&&(v=n(),v>=f)){alert("over");return}var x=p.data("addTmpl");l.push("NEW"+m++);h.value=l.join(",");x=c(x.replace(/\[COUNT\]/g,l.length).replace(/\[ID\]/g,l[l.length-1]));x.find(".DatePicker").autodatepicker();x.find(".Province").combobox({source:window.cioc_province_source});entryform.service_titles&&x.find(".ServiceTitleField").combobox({source:entryform.service_titles});p.append(x);
e&&(e.sortable("refresh"),r());f&&!t&&v+1===f&&g(!1)},w=p.parent().find(".EntryFormItemAdd").click(function(){u(!1)});p.on("click","button.EntryFormItemDelete",function(){var t=this,v=c(this).parents(".EntryFormItemBox").find(".EntryFormItemContent"),x=this.id.split("_");x=x[x.length-2];if(v.is(":visible"))v.hide("slow",function(){q[x]=get_form_values(v);c(t).text(b);v.find("input,select,textarea").each(function(){"input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?
"select"===this.nodeName.toLowerCase()?c(this).find("option").each(function(){this.selected=!1}):this.value="":this.checked=!1});g(!0)});else{var y=0;if(f&&(y=n(),y>=f)){alert("over");return}var z=q[x];z&&(delete q[x],restore_form_values(v,z),v.show("slow",function(){c(t).text(d)}),f&&y+1===f&&g(!1))}});p.hasClass("sortable")&&(e=p.sortable({items:".EntryFormItemBox"}),e.bind("sortstart",function(t,v){v.helper.bgiframe();p.addClass("sorting")}),e.bind("sortstop",function(){var t=e.sortable("toArray");
l=c.map(t,function(v){v=v.split("_");return v[v.length-2]});h.value=l.join(",");setTimeout(function(){p.removeClass("sorting");r()},1)}));cache_register_onbeforeunload(function(t){t[k.id+"_ids"]=l;t[k.id+"_deletes"]=q;e&&(t[k.id+"_order"]=e.sortable("toArray"))});cache_register_onbeforerestorevalues(function(t){t[k.id+"_ids"]&&c.each(t[k.id+"_ids"],function(v,x){0===x.indexOf("NEW")&&u(!0)});t[k.id+"_deletes"]&&(q=t[k.id+"_deletes"],p.find(".EntryFormItemContent").each(function(){var v=this.id.split("_");
v=v[v.length-2];q[v]&&c(this).hide().parent().find("button.EntryFormItemDelete").text(b)}));f&&n()>=f&&g(!1);e&&(t=t[k.id+"_order"])&&(t.reverse(),c.each(t,function(v,x){c("#"+x).detach().prependTo(p)}),e.sortable("refresh"),r())})}})};window.init_schedule=function(a){var d=function(){var b=a(this).parents(".EntryFormItemBox"),c=this.value;"0"===c?b.find(".recurs-ui").hide():"1"==c?(b.find(".repeat-every-ui, .repeats-on-ui, .recurs-week-label").show(),b.find(".repeat-week-of-month-ui, .repeat-day-of-month-ui, .recurs-month-label").hide()):
"2"==c?(b.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-month-label").show(),b.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-week-label").hide()):(b.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-month-label").show(),b.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-week-label").hide())};a("#ScheduleEditArea").on("change",".recur-type-selector",d).on("click",".schedule-ui-accept-feedback",function(b){var c=a(this);b=c.parents(".EntryFormItemBox");c=c.data("schedule");
var e=b.find(".recur-type-selector");restore_form_values(b,c);d.call(e[0]);return!1}).find(".recur-type-selector").each(d)}})();
(function(){var a=jQuery,d=function(b,c){var e=a("#CM_existing_add_container"),k=e.data("addonLabel");e.append(a("<div>").addClass("row-border-bottom").append(a("<div>").addClass("row form-group").append(a("<label>").addClass("control-label control-label-left col-md-4").prop({for:"CM_ID_"+b}).append(a("<input>").prop({id:"CM_ID_"+b,type:"checkbox",checked:!0,defaultChecked:!0,name:"CM_ID",value:b})).append(document.createTextNode(" "+c))).append(a("<div>").addClass("col-md-8 form-inline").append(a("<div>").addClass("input-group").append(a("<input>").addClass("form-control").prop({id:"CM_NUM_NEEDED_"+
b,name:"CM_NUM_NEEDED_"+b,size:3,maxlength:3})).append(a("<span>").addClass("input-group-addon").text(k))))))};window.init_num_needed=function(b){init_autocomplete_checklist(a,{field:"CM",source:entryform.community_complete_url,add_new_html:d,minLength:3,txt_not_found:b})};window.init_interests=function(b){var c=[],e=only_items_chk_add_html(a,"AI");init_autocomplete_checklist(a,{field:"AI",source:entryform.interest_complete_url,add_new_html:e,added_values:c,txt_not_found:b});var k=function(m){var h=
a("#AreaOfInterestList");h.length&&h.prop("id","AreaOfInterestListOld");a("<ul>").hide().insertAfter(p).prop("id","AreaOfInterestList").append(a(a.map(m,function(f,l){return a("<li>").append(a("<label>").append(a("<input>").prop({type:"checkbox",value:f.chkid}).data("cioc_chk_display",f.value)).append(document.createTextNode(" "+f.value)))[0]}))).show("slow");h.length&&h.hide("slow",function(){h.remove()})};var p=a("#InterestGroup").change(function(){a.getJSON(entryform.interest_complete_url,{IGID:p.prop("value")},
k)});a("#FIELD_INTERESTS").next().on("click","#AreaOfInterestList input:checkbox",{added_values:c,add_item_fn:e},function(m){var h=a(this),f=document.getElementById("AI_ID_"+this.value);f?f.checked=!0:(f=h.data("cioc_chk_display"),m.data.added_values.push({chkid:this.value,display:f}),m.data.add_item_fn(this.value,f));h.parent().parent().hide("slow",function(){h.remove()})})}})();
