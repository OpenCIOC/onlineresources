window.CIOC={};
(function(a,c){c.do_drop_down_navigation=function(){for(var d=a.getElementById("ActionList").options,b=0;b<d.length;b++)if(d[b].selected){var f=d[b].getAttribute("href");f&&("undefined"!=typeof d[b].attributes.newwindow?c.open(f):c.location.href=f);break}};jQuery(function(a){a("[data-toggle=dialog]").each(function(){var b=a(this),c=a(b.data("target")),e={autoOpen:!1,title:c.data("title"),modal:c.data("modal")};c.dialog(e);b.click(function(){c.dialog("isOpen")?c.dialog("close"):c.dialog("open")})})})})(document,window);
function CheckAll(a,c){a||(a="IDList");var d=c;c||(d=document.RecordList);for(var b=d.elements.length,f=0;f<b;f++){var e=d.elements[f];e.name===a&&(e.checked=!0)}}function ClearAll(a,c){a||(a="IDList");var d=c;c||(d=document.RecordList);for(var b=d.elements.length,f=0;f<b;f++){var e=d.elements[f];e.name===a&&(e.checked=!1)}}function add_class(a,c){a&&!(new RegExp("\\b"+c+"\\b")).test(a.className)&&(a.className&&(c=" "+c),a.className+=c)}
function remove_class(a,c){if(a){for(var d=a.className.split(" "),b=[],f=0;f<d.length;f++){var e=d[f];e!==c&&b.push(e)}a.className=b.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,c){window.open(a,c,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,c){window.open(a,c,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,c){window.open(a,c,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var c={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var d=a(this).data("popargs");(c[d.size||"sm"]||openWin)(this.href,d.name||"popwin");return!1})});
(function(){var a=jQuery,c={},d=function(b){null!==b&&"undefined"!==typeof b?a("#myListCount").text(b):(b=a("#myListCount").text())&&(b=parseInt(b,10));b?c.myListLink.show():c.myListLink.hide()},b=function(b){a.each(b,function(b,c){a("#added_to_list_"+c).show();a("#add_to_list_"+c).hide()})},f=function(f){return function(e){e.fail?alert(e.errinfo):(e.ids?d(a.grep(e.ids,k[c.domain]).length):e.count?d(e.count):d(0),b([f]))}},e=function(b){b=a(b.currentTarget).data("id");a.ajax({success:f(b),dataType:"json",
error:function(){alert("Error")},data:{id:b},type:"POST",url:c.current_list_url})},g=function(b){return function(c){if(c.fail)alert(c.errinfo);else{c=!0;if(b){var d=a("#results_table #remove_from_list_"+b);d.length?d.parent().parent().remove():(c=!1,d=a("#results_container #remove_from_list_"+b),d.parents(".dlist-result").remove())}d=!1;if((d=c?1===a("#results_table tr").length:0===a("#results_container .dlist-result").length)||!b)a("#records_ui").hide(),a("#no_records_message").show()}}},h=function(b){b=
a(b.currentTarget).data("id");a.ajax({success:g(b),dataType:"json",error:function(){alert("Error")},data:{ID:b,RemoveItem:c.domain},type:"POST",url:c.current_list_url})},l=function(b){a.ajax({success:g(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:c.domain},type:"POST",url:c.current_list_url})},k={CIC:function(b){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(b)},VOL:function(b){return/^[1-9][0-9]*$/.test(b)}},n=function(f){if(f.fail)p();else if(f.inrequest){var e=a.grep(f.ids,
k[c.domain]);b(e);d(e.length);(f=f.previous_ids)&&a.each(f,function(b,c){a("#ct_added_to_previous_request_"+c).show()});a(".ListUI img").prop("src",function(b,a){return a.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();c.current_list_url=c.ct_update_url;s()}else p()},p=function(){var f=function(){c.list_view_mode||b(c.already_added||[]);c.current_list_url=c.list_view_mode&&"ct"===c.list_view_mode?c.ct_update_url:c.list_update_url;d((c.already_added||[]).length);
s()};c.list_view_mode||c.has_session?f():a.ajax({dataType:"json",error:null,url:c.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(b){b.has_session&&f()}})},s=function(){a(".HideListUI").delegate(".add_to_list","click",e).delegate(".remove_from_list","click",h).removeClass("HideListUI");a("#remove_all_from_list").click(l);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(b){c=b;c.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
b.in_request?a.ajax({success:n,dataType:"json",error:null,type:"POST",url:b.in_request}):p()}})();this.JSON||(this.JSON={});
(function(){function a(b){return 10>b?"0"+b:b}function c(b){f.lastIndex=0;return f.test(b)?'"'+b.replace(f,function(b){var a=h[b];return"string"===typeof a?a:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function d(b,a){var f,h,r,t,u=e,q,m=a[b];m&&"object"===typeof m&&"function"===typeof m.toJSON&&(m=m.toJSON(b));"function"===typeof l&&(m=l.call(a,b,m));switch(typeof m){case "string":return c(m);case "number":return isFinite(m)?String(m):"null";case "boolean":case "null":return String(m);
case "object":if(!m)return"null";e+=g;q=[];if("[object Array]"===Object.prototype.toString.apply(m)){t=m.length;for(f=0;f<t;f+=1)q[f]=d(f,m)||"null";r=0===q.length?"[]":e?"[\n"+e+q.join(",\n"+e)+"\n"+u+"]":"["+q.join(",")+"]";e=u;return r}if(l&&"object"===typeof l)for(t=l.length,f=0;f<t;f+=1)h=l[f],"string"===typeof h&&(r=d(h,m))&&q.push(c(h)+(e?": ":":")+r);else for(h in m)Object.hasOwnProperty.call(m,h)&&(r=d(h,m))&&q.push(c(h)+(e?": ":":")+r);r=0===q.length?"{}":e?"{\n"+e+q.join(",\n"+e)+"\n"+
u+"}":"{"+q.join(",")+"}";e=u;return r}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(b){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,a,c){var f;g=e="";if("number"===typeof c)for(f=0;f<c;f+=1)g+=" ";else"string"===typeof c&&(g=c);if((l=a)&&"function"!==typeof a&&("object"!==typeof a||"number"!==typeof a.length))throw Error("JSON.stringify");return d("",{"":b})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,c){function f(b,a){var d,e,m=b[a];if(m&&"object"===typeof m)for(d in m)Object.hasOwnProperty.call(m,d)&&(e=f(m,d),void 0!==e?m[d]=e:delete m[d]);return c.call(b,a,m)}var d;a=String(a);b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"===typeof c?f({"":d},""):d;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var c={};jQuery(a).find("input,select,textarea").each(function(a){if(this.name)if(c[this.name]||(c[this.name]=[]),"select"===this.nodeName.toLowerCase()){var b=c[this.name];$(this).find("option").each(function(a){this.selected&&b.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&c[this.name].push(this.value||"")});return c};window.restore_form_values=function(a,c){var d=jQuery;d(a).find("input,select,textarea").each(function(b){if(this.name){var a=
c[this.name];"undefined"!=typeof a&&null!==a&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?d(this).find("option").each(function(b){this.selected=1<a.length?0<=d.inArray(this.value,a):0===a.length?!1:this.value===a[0]}):this.value=a.length?a[0]:"":this.checked=1<a.length?0<=d.inArray(this.value,a):0===a.length?!1:this.value===a[0])}})};window.init_cached_state=function(a){var c=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];c(window).on("beforeunload",function(){var d={form_values:get_form_values(a)};c.each(onbeforeunload_fns,function(b,a){a(d)});document.getElementById("cache_form_values").value=JSON.stringify(d)});window.cache_register_onbeforeunload=function(a){onbeforeunload_fns.push(a)};window.cache_register_onbeforerestorevalues=function(a){onbeforerestorevalues_fns.push(a)};window.restore_cached_state=function(){var d=document.getElementById("cache_form_values");if(d&&d.value){var b=
JSON.parse(d.value);c.each(onbeforerestorevalues_fns,function(a,c){c(b)});restore_form_values(a,b.form_values)}}}})();
(function(){var a=jQuery,c={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},d={"en-CA":!0,"":!0},b={},f={"fr-CA":"fr","es-MX":"es"},e=function(){var b=a(this),d=b.data("culture"),f=c[d]||a.datepicker.regional[d].dateFormat,e={};b.hasClass("NoYear")&&(f=f.replace(/[\- .\/]*yy[\/]?/,""),e={beforeShow:function(b,
a){a.dpDiv.addClass("NoYearDatePicker")},onClose:function(b,a){a.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});e.dateFormat=f;b.datepicker(a.extend({},a.datepicker.regional[d],e)).prop("autocomplete","off")},g=function(c){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+c+".min.js",function(){d[c]=!0;a.each(b[c],function(){e.call(this)});delete b[c]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var c=
a(this),l;l=c.parents("[lang]").first().prop("lang")||"en-CA";l=f[l]||l;c.data("culture",l);d[l]?e.call(this):(c=b[l],c||(c=b[l]=[],g(l)),c.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(a){a.widget("ui.combobox",{options:{source:null},_create:function(){var c=this.element;this.options.source&&(a(c).autocomplete({focus:function(a,b){return!1},source:this.options.source,delay:0,minLength:0}),a("<span>").insertAfter(c).addClass("SmallButton DownButton").css("margin-left","1px").click(function(a){c.autocomplete("widget").is(":visible")?c.autocomplete("close"):(c.autocomplete("search",""),c.focus())}))}})})(jQuery);
(function(){var a=function(b){b=b.toLowerCase();b=b.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");b=b.replace(RegExp("\u00e6","g"),"ae");b=b.replace(RegExp("\u00e7","g"),"c");b=b.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");b=b.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");b=b.replace(RegExp("\u00f1","g"),"n");b=b.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");b=b.replace(RegExp("\u009c","g"),"oe");b=b.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return b=b.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;var c=function(b,c,d,g,h){d=d||"value";g=g||"";h=h||"";return function(l,k){if(c.term&&(new RegExp(g+b.ui.autocomplete.escapeRegex(c.term)+h,"i")).test(l.term)&&c.content&&13>c.content.length){var n=new RegExp(g+b.ui.autocomplete.escapeRegex(l.term)+h,"i");k(b.grep(c.content,function(b){return n.test(a(b[d]))}));return!0}return!1}};window.default_cache_search_fn=c;var d=function(b,d,e,g,h){e=e||{};h=h||c(b,e,g||"value");
return function(c,g,n){c.term=a(c.term);e.term===c.term&&e.content?g(e.content):h(c,g)||b.ajax({url:n||d,dataType:"json",data:c,cache:!1,success:function(b){e.term=c.term;e.content=b;g(b)}})}};window.create_caching_source_fn=d;window.init_community_autocomplete=function(b,c,e,g,h){var l={};h&&(h=b(h));h&&!h.length&&(h=null);var k=b("#"+c).autocomplete({focus:function(b,a){return!1},select:function(b,a){k.data({chkid:a.item.chkid,display:a.item.value})},source:d(b,e,l),minLength:g}).keypress(function(b){"13"==
b.keyCode&&(b.preventDefault(),k.autocomplete("close"))});h&&(k.parents("form").on("submit",function(){var c=k.val();if(k.data("display")===c)h.val(k.data("chkid"));else{if(l.content){var d=a(c),c=b.grep(l.content,function(b){return a(b.value)===d});if(1===c.length){h.val(c[0].chkid);k.data({chkid:c[0].chkid,display:c[0].value}).val(c[0].value);return}}h.val("")}}),cache_register_onbeforerestorevalues(function(b){k.length&&(b=b["autocomplete_data_"+k[0].id])&&k.data(b)}),cache_register_onbeforeunload(function(b){if(k.length){var a=
k.data();a.display&&a.chkid&&(b["autocomplete_data_"+k[0].id]={display:a.display,chkid:a.chkid})}}))}})();
(function(){window.entryform=window.entryform||{};window.create_checklist_onbefore_fns=function(a,b,c,e){cache_register_onbeforeunload(function(a){a[b+"_added"]=c});cache_register_onbeforerestorevalues(function(c){(c=c[b+"_added"])&&a.each(c,function(b,a){e(a.chkid,a.display,"")})})};window.basic_chk_add_html=function(a,b){return function(c,e){var g=a("<tr>").append(a("<td>").append(a("<input>").prop({id:b+"_ID_"+c,type:"checkbox",checked:!0,defaultChecked:!0,name:b+"_ID",value:c})).append(document.createTextNode(" "+
e))).append(a("<td>").append(a("<input>").prop({id:b+"_NOTES_"+c,name:b+"_NOTES_"+c,size:entryform.chk_notes_size,maxlength:entryform.chk_notes_maxlen})));a("#"+b+"_existing_add_table").append(g);return g.find('input[type="checkbox"]')[0]}};var a={},c=function(c){$("#NEW_"+c).autocomplete(a[c])};window.init_autocomplete_checklist=function(d,b){var f=b.field;if(!a[f]){var e=b.source;b.minLength=b.minLength||1;b.delay=b.delay||300;b.add_new_html=b.add_new_html||basic_chk_add_html(d,f);b.match_prop=
b.match_prop||"value";b.txt_not_found=b.txt_not_found||"Not Found";var g=d(b.delegate_root||document),h=b.added_values||[],l=function(a,c,d){var e=document.getElementById(f+"_ID_"+a);e?(e.checked=!0,b.after_add_new_value&&b.after_add_new_value.call(e)):(h.push({chkid:a,display:c,label:d}),a=b.add_new_html(a,c,d),b.after_add_new_value&&b.after_add_new_value.call(a))};create_checklist_onbefore_fns(d,f,h,l);var k={},n=function(b){d("#NEW_"+f).data({chkid:"",display:"",label:""}).prop("value","").focus();
d("#"+f+"_error").hide("slow",function(){d(this).remove()})},p=null,s=null;(function(a){d.isArray(a)?(s=function(c,f){var e=new RegExp(d.ui.autocomplete.escapeRegex(string_ci_ai(c.term)));f(d.grep(a,function(a){return e.test(string_ci_ai(a[b.match_prop]||a))}))},p=function(c,f){var e=string_ci_ai(c),m=d.grep(a,function(a){return string_ci_ai(string_ci_ai(a[b.match_prop]||a))===e});if(1===m.length)return f(m[0]),!0;f()}):"string"===typeof a?(s=create_caching_source_fn(d,a,k,b.match_prop),p=function(a,
c,f){var e=string_ci_ai(a);if(k.content){var g=d.grep(k.content,function(a){return string_ci_ai(a[b.match_prop])===e});if(1===g.length){c(g[0]);return}}f||string_ci_ai(k.term||"")===e?c():s({term:e},function(b){p(a,c,!0)})}):(s=a,p=b.look_for_fn)})(e);g.on("click","#add_"+f,function(a){a=d("#NEW_"+f);var c=a.data("chkid"),e=a.data("display"),g=a.data("label"),m=a[0].value;if(c&&e&&e==m)return l(c,e,g),n(),!1;p(a[0].value,function(a){a?(l(a.chkid,a.value,a.label),n()):0===d("#"+f+"_error").length&&
(d("#"+f+"_new_input_table").before(d("<p>").hide().addClass("Alert").prop("id",f+"_error").append(document.createTextNode(b.txt_not_found))),d("#"+f+"_error").show("slow"))});return!1});a[f]={focus:function(a,b){return!1},source:s,minLength:b.minLength,delay:b.delay,select:function(a,b){d("#NEW_"+f).data({chkid:b.item.chkid,display:b.item.value,label:b.item.label})}};g.on("keypress","#NEW_"+f,function(a){"13"==a.keyCode&&(a.preventDefault(),d("#NEW_"+f).autocomplete("close"),d("#add_"+f).trigger("click"))})}c(f)};
window.init_languages=function(a,b){var c=null,e=null,g=a("#LN_existing_add_table"),h=function(){var b=a(this).parents(".language-entry").find(".language-details-notes");this.checked?b.slideDown():b.slideUp()};init_autocomplete_checklist(a,{field:"LN",source:entryform.languages_source,txt_not_found:b,after_add_new_value:h,add_new_html:function(b,k){null===c&&(c=a("#add_LN"),e=c.data("newTemplate"));var h=e.replace(/LANGNAMELANGNAME/g,k).replace(/IDIDID/g,b);g.append(h)}});g.on("change",".language-primary",
h).uitooltip({items:"[data-help-text]",content:function(){return'<div class="language-help-text">'+a(this).data("helpText")+"</div>"},position:{my:"center bottom-20",at:"center top",using:function(b,c){a(this).css(b);a("<div>").addClass("arrow").addClass(c.vertical).addClass(c.horizontal).appendTo(this)}}});window.languages_check_state=h}})();
(function(){window.only_items_chk_add_html=function(a,c,d){return function(b,f){d&&d();a("#"+c+"_existing_add_container").append(a("<label>").append(a("<input>").prop({id:c+"_ID_"+b,type:"checkbox",checked:!0,defaultChecked:!0,name:c+"_ID",value:b})).append("&nbsp;").append(document.createTextNode(f))).append(" ; ")}};window.init_check_for_autochecklist=function(a){var c=jQuery,d=function(){var a=c(this).data("jump_location");(a=document.getElementById(a))&&a.scrollIntoView(!0)},b=function(){return c("<li>").append(c("<span>").data("jump_location",
this.id).addClass("UnaddedChecklistJump SimulateLink").append(c(this).parentsUntil("td[data-field-display-name]").parent().data("fieldDisplayName")))},f=c("input[id^=NEW_]");f.length&&(c("#EntryForm").submit(function(d){var g=f.map(function(){return this.value?this:null}),h;if(g.length&&!d.isDefaultPrevented()){if(!confirm(a)){d.preventDefault();c("#SUBMIT_BUTTON").prop("disabled",!1);d=c("#unadded_checklist_error_box");h=c("#unadded_checklist_error_list");var l=d.is(":visible");l&&h.children("ul:first").hide("slow",
function(){c(this).remove()});var k=c("<ul>");l&&k.hide();h.append(k);c.each(g.map(b),function(){k.append(this)});l?k.show("slow"):d.show("slow")}}else d.isDefaultPrevented()&&(d=c("#unadded_checklist_error_box"),h=c("#unadded_checklist_error_list"),d.hide("slow",function(){h.children().remove()}))}),c(document).on("click",".UnaddedChecklistJump",d))};window.init_entryform_items=function(a,c,d){var b=jQuery;a.each(function(){var a=null,e=this,g=b(e),h=1,l=g.find(".EntryFormItemContainerIds")[0];if(l){var k=
g.data("maxAdd");k&&(k=parseInt(k,10));var n=[];l.value&&(n=b.map(l.value.split(","),function(a){return 0===a.indexOf("NEW")&&0!==a.indexOf("NEWFB")?null:a}));var p={},s=function(){g.find(".EntryFormItemBox").each(function(a){b(this).find(".EntryFormItemCount").text(a+1)})},r=function(a){if(k){var b=g.find(".EntryFormItemContent:hidden").parent().find("button.EntryFormItemDelete").prop("disabled",!a);q.prop("disabled",!a);a?(b.removeClass("ui-state-disabled"),q.removeClass("ui-state-disabled")):(b.addClass("ui-state-disabled"),
q.addClass("ui-state-disabled"))}},t=function(){var a=0,b;for(b in p)a++;return n.length-a},u=function(c){var d=0;if(k&&!c&&(d=t(),d>=k)){alert("over");return}var e=g.data("addTmpl");n.push("NEW"+h++);l.value=n.join(",");e=b(e.replace(/\[COUNT\]/g,n.length).replace(/\[ID\]/g,n[n.length-1]));e.find(".DatePicker").autodatepicker();e.find(".Province").combobox({source:window.cioc_province_source});entryform.service_titles&&e.find(".ServiceTitleField").combobox({source:entryform.service_titles});g.append(e);
a&&(a.sortable("refresh"),s());k&&!c&&d+1===k&&r(!1)},q=g.parent().find(".EntryFormItemAdd").click(function(){u(!1)});g.on("click","button.EntryFormItemDelete",function(){var a=this,e=b(this).parents(".EntryFormItemBox").find(".EntryFormItemContent"),f=this.id.split("_"),f=f[f.length-2];if(e.is(":visible"))e.hide("slow",function(){p[f]=get_form_values(e);b(a).text(d);e.find("input,select,textarea").each(function(){"input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?
"select"===this.nodeName.toLowerCase()?b(this).find("option").each(function(){this.selected=!1}):this.value="":this.checked=!1});r(!0)});else{var g=0;if(k&&(g=t(),g>=k)){alert("over");return}var h=p[f];h&&(delete p[f],restore_form_values(e,h),e.show("slow",function(){b(a).text(c)}),k&&g+1===k&&r(!1))}});g.hasClass("sortable")&&(a=g.sortable({items:".EntryFormItemBox"}),a.bind("sortstart",function(a,b){b.helper.bgiframe();g.addClass("sorting")}),a.bind("sortstop",function(){var c=a.sortable("toArray");
n=b.map(c,function(a){a=a.split("_");return a[a.length-2]});l.value=n.join(",");setTimeout(function(){g.removeClass("sorting");s()},1)}));cache_register_onbeforeunload(function(b){b[e.id+"_ids"]=n;b[e.id+"_deletes"]=p;a&&(b[e.id+"_order"]=a.sortable("toArray"))});cache_register_onbeforerestorevalues(function(c){c[e.id+"_ids"]&&b.each(c[e.id+"_ids"],function(a,b){0===b.indexOf("NEW")&&u(!0)});c[e.id+"_deletes"]&&(p=c[e.id+"_deletes"],g.find(".EntryFormItemContent").each(function(){var a=this.id.split("_"),
a=a[a.length-2];p[a]&&b(this).hide().parent().find("button.EntryFormItemDelete").text(d)}));k&&t()>=k&&r(!1);a&&(c=c[e.id+"_order"])&&(c.reverse(),b.each(c,function(a,c){b("#"+c).detach().prependTo(g)}),a.sortable("refresh"),s())})}})};window.init_schedule=function(a){var c=function(){var c=a(this).parents(".EntryFormItemBox"),b=this.value;"0"===b?c.find(".recurs-ui").hide():"1"==b?(c.find(".repeat-every-ui, .repeats-on-ui, .recurs-week-label").show(),c.find(".repeat-week-of-month-ui, .repeat-day-of-month-ui, .recurs-month-label").hide()):
"2"==b?(c.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-month-label").show(),c.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-week-label").hide()):(c.find(".repeat-week-of-month-ui, .repeats-on-ui, .recurs-month-label").show(),c.find(".repeat-every-ui, .repeat-day-of-month-ui, .recurs-week-label").hide())};a("#ScheduleEditArea").on("change",".recur-type-selector",c).on("click",".schedule-ui-accept-feedback",function(d){var b=a(this);d=b.parents(".EntryFormItemBox");var b=b.data("schedule"),
f=d.find(".recur-type-selector");restore_form_values(d,b);c.call(f[0]);return!1}).find(".recur-type-selector").each(c)}})();
(function(){var a=jQuery;window.configure_entry_form_button=function(){a("#SUBMIT_BUTTON").click(function(c){c=a("#SUBMIT_BUTTON");c.prop("disabled")||(c.prop("disabled",!0),setTimeout(function(){a("#EntryForm").submit()},1))});a(document).bind("keydown",function(c){if(c.ctrlKey&&"s"===String.fromCharCode(c.which).toLowerCase())return setTimeout(function(){a("#SUBMIT_BUTTON").click()},1),c.preventDefault(),c.stopPropagation(),!1});a("#SUBMIT_BUTTON").prop("disabled",!1)};window.configure_feedback_submit_button=
function(){var c=a("#SUBMIT_BUTTON").prop("value");a("#SUBMIT_BUTTON").replaceWith(a('<input type="button" class="btn btn-default" id="SUBMIT_BUTTON">').prop("value",c));a("#EntryForm").submit(function(){var c=validateForm();!1===c&&a("#SUBMIT_BUTTON").prop("disabled",!1);return c})}})();
