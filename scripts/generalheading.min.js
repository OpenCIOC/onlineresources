window.CIOC={};
(function(a,c){c.do_drop_down_navigation=function(){for(var k=a.getElementById("ActionList").options,b=0;b<k.length;b++)if(k[b].selected){var e=k[b].getAttribute("href");e&&("undefined"!=typeof k[b].attributes.newwindow?c.open(e):c.location.href=e);break}};jQuery(function(k){k("[data-toggle=dialog]").each(function(){var b=k(this),e=k(b.data("target")),p={autoOpen:!1,title:e.data("title"),modal:e.data("modal")};e.dialog(p);b.click(function(){e.dialog("isOpen")?e.dialog("close"):e.dialog("open")})})})})(document,window);
function CheckAll(a,c){a||="IDList";var k=c;c||(k=document.RecordList);c=k.elements.length;for(var b=0;b<c;b++){var e=k.elements[b];e.name===a&&(e.checked=!0)}}function ClearAll(a,c){a||="IDList";var k=c;c||(k=document.RecordList);c=k.elements.length;for(var b=0;b<c;b++){var e=k.elements[b];e.name===a&&(e.checked=!1)}}function add_class(a,c){a&&!(new RegExp("\\b"+c+"\\b")).test(a.className)&&(a.className&&(c=" "+c),a.className+=c)}
function remove_class(a,c){if(a){for(var k=a.className.split(" "),b=[],e=0;e<k.length;e++){var p=k[e];p!==c&&b.push(p)}a.className=b.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,c){window.open(a,c,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,c){window.open(a,c,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,c){window.open(a,c,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var c={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var k=a(this).data("popargs");(c[k.size||"sm"]||openWin)(this.href,k.name||"popwin");return!1})});
(function(){var a=jQuery,c={},k=function(d){null!==d&&"undefined"!==typeof d?a("#myListCount").text(d):(d=a("#myListCount").text())&&(d=parseInt(d,10));d?c.myListLink.show():c.myListLink.hide()},b=function(d){a.each(d,function(m,q){a("#added_to_list_"+q).show();a("#add_to_list_"+q).hide()})},e=function(d){return function(m){m.fail?alert(m.errinfo):(m.ids?k(a.grep(m.ids,f[c.domain]).length):m.count?k(m.count):k(0),b([d]))}},p=function(d){d=a(d.currentTarget).data("id");a.ajax({success:e(d),dataType:"json",
error:function(){alert("Error")},data:{id:d},type:"POST",url:c.current_list_url})},t=function(d){return function(m){if(m.fail)alert(m.errinfo);else{m=!0;if(d){var q=a("#results_table #remove_from_list_"+d);q.length?q.parent().parent().remove():(m=!1,q=a("#results_container #remove_from_list_"+d),q.parents(".dlist-result").remove())}(m?1!==a("#results_table tr").length:0!==a("#results_container .dlist-result").length)&&d||(a("#records_ui").hide(),a("#no_records_message").show())}}},r=function(d){d=
a(d.currentTarget).data("id");a.ajax({success:t(d),dataType:"json",error:function(){alert("Error")},data:{ID:d,RemoveItem:c.domain},type:"POST",url:c.current_list_url})},n=function(d){a.ajax({success:t(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:c.domain},type:"POST",url:c.current_list_url})},f={CIC:function(d){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(d)},VOL:function(d){return/^[1-9][0-9]*$/.test(d)}},l=function(d){if(d.fail)g();else if(d.inrequest){var m=a.grep(d.ids,
f[c.domain]);b(m);k(m.length);(d=d.previous_ids)&&a.each(d,function(q,u){a("#ct_added_to_previous_request_"+u).show()});a(".ListUI img").prop("src",function(q,u){return u.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();c.current_list_url=c.ct_update_url;h()}else g()},g=function(){var d=function(){c.list_view_mode||b(c.already_added||[]);c.current_list_url=c.list_view_mode&&"ct"===c.list_view_mode?c.ct_update_url:c.list_update_url;k((c.already_added||[]).length);
h()};c.list_view_mode||c.has_session?d():a.ajax({dataType:"json",error:null,url:c.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(m){m.has_session&&d()}})},h=function(){a(".HideListUI").delegate(".add_to_list","click",p).delegate(".remove_from_list","click",r).removeClass("HideListUI");a("#remove_all_from_list").click(n);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(d){c=d;c.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
d.in_request?a.ajax({success:l,dataType:"json",error:null,type:"POST",url:d.in_request}):g()}})();this.JSON||(this.JSON={});
(function(){function a(f){return 10>f?"0"+f:f}function c(f){e.lastIndex=0;return e.test(f)?'"'+f.replace(e,function(l){var g=r[l];return"string"===typeof g?g:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function k(f,l){var g=p,h=l[f];h&&"object"===typeof h&&"function"===typeof h.toJSON&&(h=h.toJSON(f));"function"===typeof n&&(h=n.call(l,f,h));switch(typeof h){case "string":return c(h);case "number":return isFinite(h)?String(h):"null";case "boolean":case "null":return String(h);
case "object":if(!h)return"null";p+=t;var d=[];if("[object Array]"===Object.prototype.toString.apply(h)){var m=h.length;for(f=0;f<m;f+=1)d[f]=k(f,h)||"null";l=0===d.length?"[]":p?"[\n"+p+d.join(",\n"+p)+"\n"+g+"]":"["+d.join(",")+"]";p=g;return l}if(n&&"object"===typeof n)for(m=n.length,f=0;f<m;f+=1){var q=n[f];"string"===typeof q&&(l=k(q,h))&&d.push(c(q)+(p?": ":":")+l)}else for(q in h)Object.hasOwnProperty.call(h,q)&&(l=k(q,h))&&d.push(c(q)+(p?": ":":")+l);l=0===d.length?"{}":p?"{\n"+p+d.join(",\n"+
p)+"\n"+g+"}":"{"+d.join(",")+"}";p=g;return l}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(f){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(f){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p,t,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;"function"!==typeof JSON.stringify&&(JSON.stringify=function(f,l,g){var h;t=p="";if("number"===typeof g)for(h=0;h<g;h+=1)t+=" ";else"string"===typeof g&&(t=g);if((n=l)&&"function"!==typeof l&&("object"!==typeof l||"number"!==typeof l.length))throw Error("JSON.stringify");return k("",{"":f})});
"function"!==typeof JSON.parse&&(JSON.parse=function(f,l){function g(h,d){var m,q=h[d];if(q&&"object"===typeof q)for(m in q)if(Object.hasOwnProperty.call(q,m)){var u=g(q,m);void 0!==u?q[m]=u:delete q[m]}return l.call(h,d,q)}f=String(f);b.lastIndex=0;b.test(f)&&(f=f.replace(b,function(h){return"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+f+")"),"function"===typeof l?g({"":f},""):f;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var c={};jQuery(a).find("input,select,textarea").each(function(k){if(this.name)if(c[this.name]||(c[this.name]=[]),"select"===this.nodeName.toLowerCase()){var b=c[this.name];$(this).find("option").each(function(e){this.selected&&b.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&c[this.name].push(this.value||"")});return c};window.restore_form_values=function(a,c){var k=jQuery;k(a).find("input,select,textarea").each(function(b){if(this.name){var e=
c[this.name];"undefined"!=typeof e&&null!==e&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?k(this).find("option").each(function(p){this.selected=1<e.length?0<=k.inArray(this.value,e):0===e.length?!1:this.value===e[0]}):this.value=e.length?e[0]:"":this.checked=1<e.length?0<=k.inArray(this.value,e):0===e.length?!1:this.value===e[0])}})};window.init_cached_state=function(a){var c=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];var k=function(){var b=document.getElementById("cache_form_values");if(b){var e={form_values:get_form_values(a)};c.each(onbeforeunload_fns,function(p,t){t(e)});b.value=JSON.stringify(e)}};document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState&&k()});document.addEventListener("freeze",k);window.addEventListener("pagehide",k);window.cache_register_onbeforeunload=function(b){onbeforeunload_fns.push(b)};window.cache_register_onbeforerestorevalues=
function(b){onbeforerestorevalues_fns.push(b)};window.restore_cached_state=function(){c(window).on("pageshow",function(b){if(!b.originalEvent.persisted&&(b=document.getElementById("cache_form_values"))&&b.value){var e=JSON.parse(b.value);c.each(onbeforerestorevalues_fns,function(p,t){t(e)});restore_form_values(a,e.form_values)}})}}})();
(function(){var a=jQuery,c={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},k={"en-CA":!0,"":!0},b={},e={"fr-CA":"fr","es-MX":"es"},p=function(){var r=a(this),n=r.data("culture"),f=c[n]||a.datepicker.regional[n].dateFormat,l={};r.hasClass("NoYear")&&(f=f.replace(/[\- .\/]*yy[\/]?/,""),l={beforeShow:function(g,
h){h.dpDiv.addClass("NoYearDatePicker")},onClose:function(g,h){h.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});l.dateFormat=f;r.datepicker(a.extend({},a.datepicker.regional[n],l)).prop("autocomplete","off")},t=function(r){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+r+".min.js",function(){k[r]=!0;a.each(b[r],function(){p.call(this)});delete b[r]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var r=
a(this);var n=r.parents("[lang]").first().prop("lang")||"en-CA";n=e[n]||n;r.data("culture",n);k[n]?p.call(this):(r=b[n],r||(r=b[n]=[],t(n)),r.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(){var a=function(b){b=b.toLowerCase();b=b.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");b=b.replace(RegExp("\u00e6","g"),"ae");b=b.replace(RegExp("\u00e7","g"),"c");b=b.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");b=b.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");b=b.replace(RegExp("\u00f1","g"),"n");b=b.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");b=b.replace(RegExp("\u009c","g"),"oe");b=b.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return b=b.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;window.slugify=function(b){b=a(b);b=b.replace(/-/g," ").replace(/[^a-z0-9\s]/g,"");b=b.trim();return b.replace(/\s+/g,"-")};var c=function(b,e,p,t,r){p=p||"value";t=t||"";r=r||"";return function(n,f){if(e.term&&(new RegExp(t+b.ui.autocomplete.escapeRegex(e.term)+r,"i")).test(n.term)&&e.content&&13>e.content.length){var l=new RegExp(t+b.ui.autocomplete.escapeRegex(n.term)+r,"i");f(b.grep(e.content,function(g){return l.test(a(g[p]))}));
return!0}return!1}};window.default_cache_search_fn=c;var k=function(b,e,p,t,r){p=p||{};r=r||c(b,p,t||"value");return function(n,f,l){n.term=a(n.term);p.term===n.term&&p.content?f(p.content):r(n,f)||b.ajax({url:l||e,dataType:"json",data:n,cache:!1,success:function(g){p.term=n.term;p.content=g;f(g)}})}};window.create_caching_source_fn=k;window.init_community_autocomplete=function(b,e,p,t,r){var n={};r&&=b(r);r&&!r.length&&(r=null);var f=b("#"+e).autocomplete({focus:function(l,g){return!1},select:function(l,
g){f.data({chkid:g.item.chkid,display:g.item.value})},source:k(b,p,n),minLength:t}).keypress(function(l){"13"==l.keyCode&&(l.preventDefault(),f.autocomplete("close"))});r&&(f.parents("form").on("submit",function(){var l=f.val();if(f.data("display")===l)r.val(f.data("chkid"));else{if(n.content){var g=a(l);l=b.grep(n.content,function(h){return a(h.value)===g});if(1===l.length){r.val(l[0].chkid);f.data({chkid:l[0].chkid,display:l[0].value}).val(l[0].value);return}}r.val("")}}),cache_register_onbeforerestorevalues(function(l){f.length&&
(l=l["autocomplete_data_"+f[0].id])&&f.data(l)}),cache_register_onbeforeunload(function(l){if(f.length){var g=f.data();g.display&&g.chkid&&(l["autocomplete_data_"+f[0].id]={display:g.display,chkid:g.chkid})}}))}})();
(function(a){window.init_general_heading_icons=function(c,k){k=k||a("#generalheading_IconNameFull");k.autocomplete({focus:function(b,e){return!1},source:create_caching_source_fn(a,c),minLength:3}).keypress(function(b){"13"==b.keyCode&&(b.preventDefault(),k.autocomplete("close"))});k.data("autocomplete")._renderItem=function(b,e){return a("<li></li>").data("item.autocomplete",e).append(a("<a></a>").text(e.label+" ").append(a(" <span></span>").addClass(e.label+" "+e.class_extra))).appendTo(b)}}})(jQuery);
(function(a){var c=function(b){var e=a("#generalheading_TaxonomyName");e.prop("checked")&&!e.prop("disabled")?a(".name-row").hide(b):a(".name-row").show(b)},k=function(b){b=a(b);b.find(".remove-link").before('<a class="SimulateLink edit-link"><img src="/images/edit.gif"></a> ');return b};window.init_gh_tax_edit=function(b,e){init_cached_state();cache_register_onbeforeunload(function(g){g.tax_selection=a("#tax-selection").html()});cache_register_onbeforerestorevalues(function(g){(g=g.tax_selection)&&
a("#tax-selection").html(g)});restore_cached_state();c();a("#generalheading_TaxonomyName").click(function(){c("slow")});a(document).on("click","a.remove-link",function(){var g=a(this).parents("li").first(),h=g.parent(),d=h.parent(),m=d.data("match");g.remove();0===h.children().length?(h.remove(),d.text(e)):h.children().each(function(q){var u=m+"-"+q+".Code-";a(this).find("input").prop("name",function(v){return u+v})});p()});var p=function(){if(!f){var g=a("#tax-selection"),h=g.find(".MustMatchTermList li").length;
g=g.find(".MatchAnyTermList li").length;h=1<g||h&&g;a("#generalheading_TaxonomyName").prop("disabled",h);c()}},t=a("#searchFrame"),r=a(window).resize(function(){n.dialog("option",{width:r.width()-30,height:r.height()-30});n.dialog("option","position","center");t.prop("height",n.height())}),n=a("#tax-selection-dialog").dialog({autoOpen:!1,resizable:!1,draggable:!1,modal:!0,open:function(){n.dialog("option",{width:r.width()-30,height:r.height()-30});n.dialog("option","position","center");t.prop("height",
n.height())},close:function(){a("html").css("overflow","");a("#dialog-selected-target").empty();f&&(a("#tax-selection").append(f),f=null);p()}}),f=null;a("#modify-term-selection").click(function(){f=a("#tax-selection").contents().remove();t.prop("src",b);a("#dialog-selected-target").empty().append(k(f.clone()));a("html").css("overflow","hidden");n.dialog("open")});var l=function(g,h){return g.code<h.code?-1:g.code>h.code?1:0};window.addBuildTerm=function(g,h){var d=a("#BuildTermList"),m=a("#BuildTermText"),
q=d.data("existingTerms")||[];if(!q.length)m=a('<span id="BuildTermText">'),d.empty().append(m).append(a('<a id="clear-build-term-list" class="SimulateLink"><img src="/images/x.gif"></a>')),a("#SelectDiv,#SuggestDiv").show();else if(0<=a.inArray(g,a.map(q,function(u){return u.code})))return;q.push({code:g,term:h});q.sort(l);d.data("existingTerms",q);m.text(a.map(q,function(u){return u.term}).join(" ~ ")+" ")};n.on("click","#clear-build-term-list",function(){a("#BuildTermList").data("existingTerms",
[]).empty().text(e);a("#SelectDiv,#SuggestDiv").hide()}).on("click",".edit-link",function(){var g=a(this).parent(),h=a.trim(g.text()),d=h.split(" ~ ");g=g.find("input").map(function(){return this.value});var m=[],q;for(q=0;q<g.length;q++)m.push({code:g[q],term:d[q]});a("#BuildTermList").data("existingTerms",m).empty().append(a('<span id="BuildTermText">').text(h+" ")).append(a('<a id="clear-build-term-list" class="SimulateLink"><img src="/images/x.gif"></a>'));a("#SelectDiv,#SuggestDiv").show()});
a("#add-match-all,#add-match-any").click(function(){var g=a("#BuildTermList"),h=a(this).data("target"),d=n.find("."+h+"TermList"),m=d.children("ul"),q=m.length?m.children().length:0,u=a('<li class="TermItem">').html(a("#BuildTermText").html()).append(a('<a class="SimulateLink remove-link"><img src="/images/x.gif"></a>')),v='<input type="hidden" name="'+h+"-"+q+".Code-";k(u);m.length||(m=a("<ul>"),d.empty().append(m));a.each(g.data("existingTerms"),function(w,x){u.append(a(v+w+'" value="'+x.code+'">"'))});
m.append(u);a("#clear-build-term-list").trigger("click")});a("#suggest-link,#suggest-term").click(function(){var g=a("#BuildTermList"),h=a(this).data("st"),d=g.data("existingTerms");g=a.map(d,function(m){return m.term}).join(" ~ ");d=a.map(d,function(m){return m.code}).join(",");h={ST:h,TC:d,TCD:g};a("#searchFrame").prop("src",b+"&"+a.param(h))});a("#save-tax-form").click(function(){a("#tax-selection").append(a("#dialog-selected-target").contents().find(".edit-link").remove().end());f=null;n.dialog("close")});
a("#reset-tax-form").click(function(){a("#dialog-selected-target").empty().append(k(f.clone()))});a("#cancel-tax-form").click(function(){n.dialog("close")});a("#clear-tax-form").click(function(){a("#dialog-selected-target").find(".MustMatchTermList,.MatchAnyTermList").empty().text(e);a("#generalheading_TaxonomyRestrict").prop("checked",!1)})}})(jQuery);
