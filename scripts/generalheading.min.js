window.CIOC={};
(function(a,b){b.do_drop_down_navigation=function(){for(var c=a.getElementById("ActionList").options,d=0;d<c.length;d++)if(c[d].selected){var e=c[d].getAttribute("href");e&&("undefined"!=typeof c[d].attributes.newwindow?b.open(e):b.location.href=e);break}};jQuery(function(a){a("[data-toggle=dialog]").each(function(){var d=a(this),b=a(d.data("target")),f={autoOpen:!1,title:b.data("title"),modal:b.data("modal")};b.dialog(f);d.click(function(){b.dialog("isOpen")?b.dialog("close"):b.dialog("open")})})})})(document,window);
function CheckAll(a,b){a||(a="IDList");var c=b;b||(c=document.RecordList);for(var d=c.elements.length,e=0;e<d;e++){var f=c.elements[e];f.name===a&&(f.checked=!0)}}function ClearAll(a,b){a||(a="IDList");var c=b;b||(c=document.RecordList);for(var d=c.elements.length,e=0;e<d;e++){var f=c.elements[e];f.name===a&&(f.checked=!1)}}function add_class(a,b){a&&!(new RegExp("\\b"+b+"\\b")).test(a.className)&&(a.className&&(b=" "+b),a.className+=b)}
function remove_class(a,b){if(a){for(var c=a.className.split(" "),d=[],e=0;e<c.length;e++){var f=c[e];f!==b&&d.push(f)}a.className=d.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,b){window.open(a,b,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,b){window.open(a,b,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,b){window.open(a,b,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var b={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var c=a(this).data("popargs");(b[c.size||"sm"]||openWin)(this.href,c.name||"popwin");return!1})});
(function(){var a=jQuery,b={},c=function(d){null!==d&&"undefined"!==typeof d?a("#myListCount").text(d):(d=a("#myListCount").text())&&(d=parseInt(d,10));d?b.myListLink.show():b.myListLink.hide()},d=function(d){a.each(d,function(d,b){a("#added_to_list_"+b).show();a("#add_to_list_"+b).hide()})},e=function(m){return function(e){e.fail?alert(e.errinfo):(e.ids?c(a.grep(e.ids,k[b.domain]).length):e.count?c(e.count):c(0),d([m]))}},f=function(d){d=a(d.currentTarget).data("id");a.ajax({success:e(d),dataType:"json",
error:function(){alert("Error")},data:{id:d},type:"POST",url:b.current_list_url})},l=function(d){return function(b){if(b.fail)alert(b.errinfo);else{b=!0;if(d){var c=a("#results_table #remove_from_list_"+d);c.length?c.parent().parent().remove():(b=!1,c=a("#results_container #remove_from_list_"+d),c.parents(".dlist-result").remove())}c=!1;if((c=b?1===a("#results_table tr").length:0===a("#results_container .dlist-result").length)||!d)a("#records_ui").hide(),a("#no_records_message").show()}}},g=function(d){d=
a(d.currentTarget).data("id");a.ajax({success:l(d),dataType:"json",error:function(){alert("Error")},data:{ID:d,RemoveItem:b.domain},type:"POST",url:b.current_list_url})},h=function(d){a.ajax({success:l(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:b.domain},type:"POST",url:b.current_list_url})},k={CIC:function(a){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(a)},VOL:function(a){return/^[1-9][0-9]*$/.test(a)}},q=function(e){if(e.fail)m();else if(e.inrequest){var f=a.grep(e.ids,
k[b.domain]);d(f);c(f.length);(e=e.previous_ids)&&a.each(e,function(d,b){a("#ct_added_to_previous_request_"+b).show()});a(".ListUI img").prop("src",function(a,d){return d.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();b.current_list_url=b.ct_update_url;t()}else m()},m=function(){var m=function(){b.list_view_mode||d(b.already_added||[]);b.current_list_url=b.list_view_mode&&"ct"===b.list_view_mode?b.ct_update_url:b.list_update_url;c((b.already_added||[]).length);
t()};b.list_view_mode||b.has_session?m():a.ajax({dataType:"json",error:null,url:b.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(a){a.has_session&&m()}})},t=function(){a(".HideListUI").delegate(".add_to_list","click",f).delegate(".remove_from_list","click",g).removeClass("HideListUI");a("#remove_all_from_list").click(h);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(d){b=d;b.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
d.in_request?a.ajax({success:q,dataType:"json",error:null,type:"POST",url:d.in_request}):m()}})();this.JSON||(this.JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var d=g[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var m,e,g,r,s=f,p,n=d[a];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(a));"function"===typeof h&&(n=h.call(d,a,n));switch(typeof n){case "string":return b(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";f+=l;p=[];if("[object Array]"===Object.prototype.toString.apply(n)){r=n.length;for(m=0;m<r;m+=1)p[m]=c(m,n)||"null";g=0===p.length?"[]":f?"[\n"+f+p.join(",\n"+f)+"\n"+s+"]":"["+p.join(",")+"]";f=s;return g}if(h&&"object"===typeof h)for(r=h.length,m=0;m<r;m+=1)e=h[m],"string"===typeof e&&(g=c(e,n))&&p.push(b(e)+(f?": ":":")+g);else for(e in n)Object.hasOwnProperty.call(n,e)&&(g=c(e,n))&&p.push(b(e)+(f?": ":":")+g);g=0===p.length?"{}":f?"{\n"+f+p.join(",\n"+f)+"\n"+
s+"}":"{"+p.join(",")+"}";f=s;return g}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(d){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,l,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,d,b){var e;l=f="";if("number"===typeof b)for(e=0;e<b;e+=1)l+=" ";else"string"===typeof b&&(l=b);if((h=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return c("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function e(a,d){var c,f,g=a[d];if(g&&"object"===typeof g)for(c in g)Object.hasOwnProperty.call(g,c)&&(f=e(g,c),void 0!==f?g[c]=f:delete g[c]);return b.call(a,d,g)}var c;a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),"function"===typeof b?e({"":c},""):c;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var b={};jQuery(a).find("input,select,textarea").each(function(a){if(this.name)if(b[this.name]||(b[this.name]=[]),"select"===this.nodeName.toLowerCase()){var d=b[this.name];$(this).find("option").each(function(a){this.selected&&d.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&b[this.name].push(this.value||"")});return b};window.restore_form_values=function(a,b){var c=jQuery;c(a).find("input,select,textarea").each(function(a){if(this.name){var e=
b[this.name];"undefined"!=typeof e&&null!==e&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?c(this).find("option").each(function(a){this.selected=1<e.length?0<=c.inArray(this.value,e):0===e.length?!1:this.value===e[0]}):this.value=e.length?e[0]:"":this.checked=1<e.length?0<=c.inArray(this.value,e):0===e.length?!1:this.value===e[0])}})};window.init_cached_state=function(a){var b=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];b(window).on("beforeunload",function(){var c={form_values:get_form_values(a)};b.each(onbeforeunload_fns,function(a,b){b(c)});document.getElementById("cache_form_values").value=JSON.stringify(c)});window.cache_register_onbeforeunload=function(a){onbeforeunload_fns.push(a)};window.cache_register_onbeforerestorevalues=function(a){onbeforerestorevalues_fns.push(a)};window.restore_cached_state=function(){var c=document.getElementById("cache_form_values");if(c&&c.value){var d=
JSON.parse(c.value);b.each(onbeforerestorevalues_fns,function(a,b){b(d)});restore_form_values(a,d.form_values)}}}})();
(function(){var a=jQuery,b={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},c={"en-CA":!0,"":!0},d={},e={"fr-CA":"fr","es-MX":"es"},f=function(){var d=a(this),c=d.data("culture"),e=b[c]||a.datepicker.regional[c].dateFormat,f={};d.hasClass("NoYear")&&(e=e.replace(/[\- .\/]*yy[\/]?/,""),f={beforeShow:function(a,
d){d.dpDiv.addClass("NoYearDatePicker")},onClose:function(a,d){d.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});f.dateFormat=e;d.datepicker(a.extend({},a.datepicker.regional[c],f)).prop("autocomplete","off")},l=function(b){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+b+".min.js",function(){c[b]=!0;a.each(d[b],function(){f.call(this)});delete d[b]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var b=
a(this),h;h=b.parents("[lang]").first().prop("lang")||"en-CA";h=e[h]||h;b.data("culture",h);c[h]?f.call(this):(b=d[h],b||(b=d[h]=[],l(h)),b.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(a){function b(a){return a&&a.constructor===Number?a+"px":a}a.fn.bgiframe=a.browser.msie&&/msie 6\.0/i.test(navigator.userAgent)?function(c){c=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;"},c);var d='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+c.src+'"style="display:block;position:absolute;z-index:-1;'+(!1!==c.opacity?"filter:Alpha(Opacity='0');":"")+"top:"+("auto"==c.top?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":
b(c.top))+";left:"+("auto"==c.left?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":b(c.left))+";width:"+("auto"==c.width?"expression(this.parentNode.offsetWidth+'px')":b(c.width))+";height:"+("auto"==c.height?"expression(this.parentNode.offsetHeight+'px')":b(c.height))+';"/>';return this.each(function(){0===a(this).children("iframe.bgiframe").length&&this.insertBefore(document.createElement(d),this.firstChild)})}:function(){return this};a.fn.bgIframe=a.fn.bgiframe})(jQuery);
(function(){var a=function(a){a=a.toLowerCase();a=a.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");a=a.replace(RegExp("\u00e6","g"),"ae");a=a.replace(RegExp("\u00e7","g"),"c");a=a.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");a=a.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");a=a.replace(RegExp("\u00f1","g"),"n");a=a.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");a=a.replace(RegExp("\u009c","g"),"oe");a=a.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return a=a.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;var b=function(b,e,c,l,g){c=c||"value";l=l||"";g=g||"";return function(h,k){if(e.term&&(new RegExp(l+b.ui.autocomplete.escapeRegex(e.term)+g,"i")).test(h.term)&&e.content&&13>e.content.length){var q=new RegExp(l+b.ui.autocomplete.escapeRegex(h.term)+g,"i");k(b.grep(e.content,function(b){return q.test(a(b[c]))}));return!0}return!1}};window.default_cache_search_fn=b;var c=function(d,c,f,l,g){f=f||{};g=g||b(d,f,l||"value");
return function(b,k,q){b.term=a(b.term);f.term===b.term&&f.content?k(f.content):g(b,k)||d.ajax({url:q||c,dataType:"json",data:b,cache:!1,success:function(a){f.term=b.term;f.content=a;k(a)}})}};window.create_caching_source_fn=c;window.init_community_autocomplete=function(b,e,f,l,g){var h={};g&&(g=b(g));g&&!g.length&&(g=null);var k=b("#"+e).autocomplete({focus:function(a,b){return!1},select:function(a,b){k.data({chkid:b.item.chkid,display:b.item.value})},source:c(b,f,h),minLength:l}).keypress(function(a){"13"==
a.keyCode&&(a.preventDefault(),k.autocomplete("close"))});g&&(k.parents("form").on("submit",function(){var c=k.val();if(k.data("display")===c)g.val(k.data("chkid"));else{if(h.content){var e=a(c),c=b.grep(h.content,function(b){return a(b.value)===e});if(1===c.length){g.val(c[0].chkid);k.data({chkid:c[0].chkid,display:c[0].value}).val(c[0].value);return}}g.val("")}}),cache_register_onbeforerestorevalues(function(a){k.length&&(a=a["autocomplete_data_"+k[0].id])&&k.data(a)}),cache_register_onbeforeunload(function(a){if(k.length){var b=
k.data();b.display&&b.chkid&&(a["autocomplete_data_"+k[0].id]={display:b.display,chkid:b.chkid})}}))}})();
(function(a){window.init_general_heading_icons=function(b,c){c=c||a("#generalheading_IconNameFull");console.log(c);c.autocomplete({focus:function(a,b){return!1},source:create_caching_source_fn(a,b),minLength:3}).keypress(function(a){"13"==a.keyCode&&(a.preventDefault(),c.autocomplete("close"))});c.data("autocomplete")._renderItem=function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label+" ").append(a(" <span></span>").addClass(c.label+" "+c.class_extra))).appendTo(b)}}})(jQuery);
(function(a){var b=function(b){var c=a("#generalheading_TaxonomyName");c.prop("checked")&&!c.prop("disabled")?a(".name-row").hide(b):a(".name-row").show(b)},c=function(b){b=a(b);b.find(".remove-link").before('<a class="SimulateLink edit-link"><img src="/images/edit.gif"></a> ');return b};window.init_gh_tax_edit=function(d,e){init_cached_state();cache_register_onbeforeunload(function(b){b.tax_selection=a("#tax-selection").html()});cache_register_onbeforerestorevalues(function(b){(b=b.tax_selection)&&
a("#tax-selection").html(b)});restore_cached_state();b();a("#generalheading_TaxonomyName").click(function(){b("slow")});a(document).on("click","a.remove-link",function(){var b=a(this).parents("li").first(),c=b.parent(),d=c.parent(),g=d.data("match");b.remove();0===c.children().length?(c.remove(),d.text(e)):c.children().each(function(b){var c=g+"-"+b+".Code-";a(this).find("input").prop("name",function(a){return c+a})});f()});var f=function(){if(!k){var c=a("#tax-selection"),d=c.find(".MustMatchTermList li").length,
c=c.find(".MatchAnyTermList li").length,d=1<c||d&&c;a("#generalheading_TaxonomyName").prop("disabled",d);b()}},l=a("#searchFrame"),g=a(window).resize(function(){h.dialog("option",{width:g.width()-30,height:g.height()-30});h.dialog("option","position","center");l.prop("height",h.height())}),h=a("#tax-selection-dialog").dialog({autoOpen:!1,resizable:!1,draggable:!1,modal:!0,open:function(){h.dialog("option",{width:g.width()-30,height:g.height()-30});h.dialog("option","position","center");l.prop("height",
h.height())},close:function(){a("html").css("overflow","");a("#dialog-selected-target").empty();k&&(a("#tax-selection").append(k),k=null);f()}}),k=null;a("#modify-term-selection").click(function(){k=a("#tax-selection").contents().remove();l.prop("src",d);a("#dialog-selected-target").empty().append(c(k.clone()));a("html").css("overflow","hidden");h.dialog("open")});var q=function(a,b){return a.code<b.code?-1:a.code>b.code?1:0};window.addBuildTerm=function(b,c){var d=a("#BuildTermList"),e=a("#BuildTermText"),
f=d.data("existingTerms")||[];if(!f.length)e=a('<span id="BuildTermText">'),d.empty().append(e).append(a('<a id="clear-build-term-list" class="SimulateLink"><img src="/images/x.gif"></a>')),a("#SelectDiv,#SuggestDiv").show();else if(0<=a.inArray(b,a.map(f,function(a){return a.code})))return;f.push({code:b,term:c});f.sort(q);d.data("existingTerms",f);e.text(a.map(f,function(a){return a.term}).join(" ~ ")+" ")};h.on("click","#clear-build-term-list",function(){a("#BuildTermList").data("existingTerms",
[]).empty().text(e);a("#SelectDiv,#SuggestDiv").hide()}).on("click",".edit-link",function(){var b=a(this).parent(),c=a.trim(b.text()),d=c.split(" ~ "),b=b.find("input").map(function(){return this.value}),e=[],f;for(f=0;f<b.length;f++)e.push({code:b[f],term:d[f]});a("#BuildTermList").data("existingTerms",e).empty().append(a('<span id="BuildTermText">').text(c+" ")).append(a('<a id="clear-build-term-list" class="SimulateLink"><img src="/images/x.gif"></a>'));a("#SelectDiv,#SuggestDiv").show()});a("#add-match-all,#add-match-any").click(function(){var b=
a("#BuildTermList"),d=a(this).data("target"),e=h.find("."+d+"TermList"),f=e.children("ul"),g=f.length?f.children().length:0,k=a('<li class="TermItem">').html(a("#BuildTermText").html()).append(a('<a class="SimulateLink remove-link"><img src="/images/x.gif"></a>')),l='<input type="hidden" name="'+d+"-"+g+".Code-";c(k);f.length||(f=a("<ul>"),e.empty().append(f));a.each(b.data("existingTerms"),function(b,c){k.append(a(l+b+'" value="'+c.code+'">"'))});f.append(k);a("#clear-build-term-list").trigger("click")});
a("#suggest-link,#suggest-term").click(function(){var b=a("#BuildTermList"),c=a(this).data("st"),e=b.data("existingTerms"),b=a.map(e,function(a){return a.term}).join(" ~ "),e=a.map(e,function(a){return a.code}).join(","),c={ST:c,TC:e,TCD:b};a("#searchFrame").prop("src",d+"&"+a.param(c))});a("#save-tax-form").click(function(){a("#tax-selection").append(a("#dialog-selected-target").contents().find(".edit-link").remove().end());k=null;h.dialog("close")});a("#reset-tax-form").click(function(){a("#dialog-selected-target").empty().append(c(k.clone()))});
a("#cancel-tax-form").click(function(){h.dialog("close")});a("#clear-tax-form").click(function(){a("#dialog-selected-target").find(".MustMatchTermList,.MatchAnyTermList").empty().text(e);a("#generalheading_TaxonomyRestrict").prop("checked",!1)})}})(jQuery);
