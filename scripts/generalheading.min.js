window.CIOC={};
(function(a,c){c.do_drop_down_navigation=function(){for(var h=a.getElementById("ActionList").options,b=0;b<h.length;b++)if(h[b].selected){var g=h[b].getAttribute("href");g&&("undefined"!=typeof h[b].attributes.newwindow?c.open(g):c.location.href=g);break}};jQuery(function(h){h("[data-toggle=dialog]").each(function(){var b=h(this),g=h(b.data("target")),p={autoOpen:!1,title:g.data("title"),modal:g.data("modal")};g.dialog(p);b.click(function(){g.dialog("isOpen")?g.dialog("close"):g.dialog("open")})})})})(document,window);
function CheckAll(a,c){a||="IDList";var h=c;c||(h=document.RecordList);c=h.elements.length;for(var b=0;b<c;b++){var g=h.elements[b];g.name===a&&(g.checked=!0)}}function ClearAll(a,c){a||="IDList";var h=c;c||(h=document.RecordList);c=h.elements.length;for(var b=0;b<c;b++){var g=h.elements[b];g.name===a&&(g.checked=!1)}}function add_class(a,c){a&&!(new RegExp("\\b"+c+"\\b")).test(a.className)&&(a.className&&(c=" "+c),a.className+=c)}
function remove_class(a,c){if(a){for(var h=a.className.split(" "),b=[],g=0;g<h.length;g++){var p=h[g];p!==c&&b.push(p)}a.className=b.join(" ")}}function hide(a){add_class(a,"NotVisible")}function show(a){remove_class(a,"NotVisible")}function openWin(a,c){window.open(a,c,"toolbar=no,width=490,height=485,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}
function openWinL(a,c){window.open(a,c,"toolbar=no,width=650,height=520,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}function openWinXL(a,c){window.open(a,c,"toolbar=no,width=755,height=550,location=no,scrollBars=yes,resizable=no,titlebar=yes").focus()}jQuery(function(a){var c={sm:openWin,lg:openWinL,xl:openWinXL};a(document).on("click","a.poplink",function(){var h=a(this).data("popargs");(c[h.size||"sm"]||openWin)(this.href,h.name||"popwin");return!1})});
(function(){var a=jQuery,c={},h=function(d){null!==d&&"undefined"!==typeof d?a("#myListCount").text(d):(d=a("#myListCount").text())&&(d=parseInt(d,10));d?c.myListLink.show():c.myListLink.hide()},b=function(d){a.each(d,function(m,q){a("#added_to_list_"+q).show();a("#add_to_list_"+q).hide()})},g=function(d){return function(m){m.fail?alert(m.errinfo):(m.ids?h(a.grep(m.ids,e[c.domain]).length):m.count?h(m.count):h(0),b([d]))}},p=function(d){d=a(d.currentTarget).data("id");a.ajax({success:g(d),dataType:"json",
error:function(){alert("Error")},data:{id:d},type:"POST",url:c.current_list_url})},t=function(d){return function(m){if(m.fail)alert(m.errinfo);else{m=!0;if(d){var q=a("#results_table #remove_from_list_"+d);q.length?q.parent().parent().remove():(m=!1,q=a("#results_container #remove_from_list_"+d),q.parents(".dlist-result").remove())}(m?1!==a("#results_table tr").length:0!==a("#results_container .dlist-result").length)&&d||(a("#records_ui").hide(),a("#no_records_message").show())}}},r=function(d){d=
a(d.currentTarget).data("id");a.ajax({success:t(d),dataType:"json",error:function(){alert("Error")},data:{ID:d,RemoveItem:c.domain},type:"POST",url:c.current_list_url})},n=function(d){a.ajax({success:t(),dataType:"json",error:function(){alert("Error")},data:{ID:"all",RemoveItem:c.domain},type:"POST",url:c.current_list_url})},e={CIC:function(d){return/^[A-Za-z]{3}[0-9]{4,5}$/.test(d)},VOL:function(d){return/^[1-9][0-9]*$/.test(d)}},l=function(d){if(d.fail)f();else if(d.inrequest){var m=a.grep(d.ids,
e[c.domain]);b(m);h(m.length);(d=d.previous_ids)&&a.each(d,function(q,u){a("#ct_added_to_previous_request_"+u).show()});a(".ListUI img").prop("src",function(q,u){return u.replace("list","referral")});a("#list_header_text").hide();a("#ct_header_text").show();c.current_list_url=c.ct_update_url;k()}else f()},f=function(){var d=function(){c.list_view_mode||b(c.already_added||[]);c.current_list_url=c.list_view_mode&&"ct"===c.list_view_mode?c.ct_update_url:c.list_update_url;h((c.already_added||[]).length);
k()};c.list_view_mode||c.has_session?d():a.ajax({dataType:"json",error:null,url:c.list_update_url,data:{SessionTest:"on"},type:"POST",success:function(m){m.has_session&&d()}})},k=function(){a(".HideListUI").delegate(".add_to_list","click",p).delegate(".remove_from_list","click",r).removeClass("HideListUI");a("#remove_all_from_list").click(n);a.browser.msie&&"8.0">a.browser.msie&&a(".ListUI").removeClass("FixIE")};window.init_list_adder=function(d){c=d;c.myListLink=a("#myListLink").parent(":hidden").add("#myListLink");
d.in_request?a.ajax({success:l,dataType:"json",error:null,type:"POST",url:d.in_request}):f()}})();this.JSON||(this.JSON={});
(function(){function a(e){return 10>e?"0"+e:e}function c(e){g.lastIndex=0;return g.test(e)?'"'+e.replace(g,function(l){var f=r[l];return"string"===typeof f?f:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function h(e,l){var f=p,k=l[e];k&&"object"===typeof k&&"function"===typeof k.toJSON&&(k=k.toJSON(e));"function"===typeof n&&(k=n.call(l,e,k));switch(typeof k){case "string":return c(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);
case "object":if(!k)return"null";p+=t;var d=[];if("[object Array]"===Object.prototype.toString.apply(k)){var m=k.length;for(e=0;e<m;e+=1)d[e]=h(e,k)||"null";l=0===d.length?"[]":p?"[\n"+p+d.join(",\n"+p)+"\n"+f+"]":"["+d.join(",")+"]";p=f;return l}if(n&&"object"===typeof n)for(m=n.length,e=0;e<m;e+=1){var q=n[e];"string"===typeof q&&(l=h(q,k))&&d.push(c(q)+(p?": ":":")+l)}else for(q in k)Object.hasOwnProperty.call(k,q)&&(l=h(q,k))&&d.push(c(q)+(p?": ":":")+l);l=0===d.length?"{}":p?"{\n"+p+d.join(",\n"+
p)+"\n"+f+"}":"{"+d.join(",")+"}";p=f;return l}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
g=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p,t,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;"function"!==typeof JSON.stringify&&(JSON.stringify=function(e,l,f){var k;t=p="";if("number"===typeof f)for(k=0;k<f;k+=1)t+=" ";else"string"===typeof f&&(t=f);if((n=l)&&"function"!==typeof l&&("object"!==typeof l||"number"!==typeof l.length))throw Error("JSON.stringify");return h("",{"":e})});
"function"!==typeof JSON.parse&&(JSON.parse=function(e,l){function f(k,d){var m,q=k[d];if(q&&"object"===typeof q)for(m in q)if(Object.hasOwnProperty.call(q,m)){var u=f(q,m);void 0!==u?q[m]=u:delete q[m]}return l.call(k,d,q)}e=String(e);b.lastIndex=0;b.test(e)&&(e=e.replace(b,function(k){return"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+e+")"),"function"===typeof l?f({"":e},""):e;throw new SyntaxError("JSON.parse");})})();
(function(){window.get_form_values=function(a){var c={};jQuery(a).find("input,select,textarea").each(function(h){if(this.name)if(c[this.name]||(c[this.name]=[]),"select"===this.nodeName.toLowerCase()){var b=c[this.name];$(this).find("option").each(function(g){this.selected&&b.push(this.value)})}else("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type||this.checked)&&c[this.name].push(this.value||"")});return c};window.restore_form_values=function(a,c){var h=jQuery;h(a).find("input,select,textarea").each(function(b){if(this.name){var g=
c[this.name];"undefined"!=typeof g&&null!==g&&("input"!==this.nodeName.toLowerCase()||"checkbox"!==this.type&&"radio"!==this.type?"select"===this.nodeName.toLowerCase()?h(this).find("option").each(function(p){this.selected=1<g.length?0<=h.inArray(this.value,g):0===g.length?!1:this.value===g[0]}):this.value=g.length?g[0]:"":this.checked=1<g.length?0<=h.inArray(this.value,g):0===g.length?!1:this.value===g[0])}})};window.init_cached_state=function(a){var c=jQuery;a=a||"#EntryForm";onbeforeunload_fns=
[];onbeforerestorevalues_fns=[];c(window).on("beforeunload",function(){var h={form_values:get_form_values(a)};c.each(onbeforeunload_fns,function(b,g){g(h)});document.getElementById("cache_form_values").value=JSON.stringify(h)});window.cache_register_onbeforeunload=function(h){onbeforeunload_fns.push(h)};window.cache_register_onbeforerestorevalues=function(h){onbeforerestorevalues_fns.push(h)};window.restore_cached_state=function(){var h=document.getElementById("cache_form_values");if(h&&h.value){var b=
JSON.parse(h.value);c.each(onbeforerestorevalues_fns,function(g,p){p(b)});restore_form_values(a,b.form_values)}}}})();
(function(){var a=jQuery,c={"en-CA":"d M yy",de:"dd.mm.yy",fr:"d M yy",it:"d M yy",nl:"d M yy",no:"d M yy",pt:"d-mm-yy",sv:"d M yy",hu:"M d. yy",ro:"d M yy",hr:"d M yy",sl:"d M yy",bg:"d MM yy",ru:"d M yy",tr:"d M yy",lv:"d M yy",lt:"d M yy",ko:"yy/mm/dd","zh-CN":"yy/mm/dd",th:"d M yy"},h={"en-CA":!0,"":!0},b={},g={"fr-CA":"fr","es-MX":"es"},p=function(){var r=a(this),n=r.data("culture"),e=c[n]||a.datepicker.regional[n].dateFormat,l={};r.hasClass("NoYear")&&(e=e.replace(/[\- .\/]*yy[\/]?/,""),l={beforeShow:function(f,
k){k.dpDiv.addClass("NoYearDatePicker")},onClose:function(f,k){k.dpDiv.removeClass("NoYearDatePicker")},changeYear:!1});l.dateFormat=e;r.datepicker(a.extend({},a.datepicker.regional[n],l)).prop("autocomplete","off")},t=function(r){a.getScript("//ajax.googleapis.com/ajax/libs/jqueryui/"+a.ui.version+"/i18n/jquery.ui.datepicker-"+r+".min.js",function(){h[r]=!0;a.each(b[r],function(){p.call(this)});delete b[r]})};a.datepicker.regional["en-CA"]=a.extend({},a.datepicker.regional[""]);a.fn.extend({autodatepicker:function(){return this.each(function(){var r=
a(this);var n=r.parents("[lang]").first().prop("lang")||"en-CA";n=g[n]||n;r.data("culture",n);h[n]?p.call(this):(r=b[n],r||(r=b[n]=[],t(n)),r.push(this))})}});jQuery(function(){a("input.DatePicker").autodatepicker()})})();
(function(){var a=function(b){b=b.toLowerCase();b=b.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");b=b.replace(RegExp("\u00e6","g"),"ae");b=b.replace(RegExp("\u00e7","g"),"c");b=b.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");b=b.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");b=b.replace(RegExp("\u00f1","g"),"n");b=b.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");b=b.replace(RegExp("\u009c","g"),"oe");b=b.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return b=b.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=a;window.slugify=function(b){b=a(b);b=b.replace(/-/g," ").replace(/[^a-z0-9\s]/g,"");b=b.trim();return b.replace(/\s+/g,"-")};var c=function(b,g,p,t,r){p=p||"value";t=t||"";r=r||"";return function(n,e){if(g.term&&(new RegExp(t+b.ui.autocomplete.escapeRegex(g.term)+r,"i")).test(n.term)&&g.content&&13>g.content.length){var l=new RegExp(t+b.ui.autocomplete.escapeRegex(n.term)+r,"i");e(b.grep(g.content,function(f){return l.test(a(f[p]))}));
return!0}return!1}};window.default_cache_search_fn=c;var h=function(b,g,p,t,r){p=p||{};r=r||c(b,p,t||"value");return function(n,e,l){n.term=a(n.term);p.term===n.term&&p.content?e(p.content):r(n,e)||b.ajax({url:l||g,dataType:"json",data:n,cache:!1,success:function(f){p.term=n.term;p.content=f;e(f)}})}};window.create_caching_source_fn=h;window.init_community_autocomplete=function(b,g,p,t,r){var n={};r&&=b(r);r&&!r.length&&(r=null);var e=b("#"+g).autocomplete({focus:function(l,f){return!1},select:function(l,
f){e.data({chkid:f.item.chkid,display:f.item.value})},source:h(b,p,n),minLength:t}).keypress(function(l){"13"==l.keyCode&&(l.preventDefault(),e.autocomplete("close"))});r&&(e.parents("form").on("submit",function(){var l=e.val();if(e.data("display")===l)r.val(e.data("chkid"));else{if(n.content){var f=a(l);l=b.grep(n.content,function(k){return a(k.value)===f});if(1===l.length){r.val(l[0].chkid);e.data({chkid:l[0].chkid,display:l[0].value}).val(l[0].value);return}}r.val("")}}),cache_register_onbeforerestorevalues(function(l){e.length&&
(l=l["autocomplete_data_"+e[0].id])&&e.data(l)}),cache_register_onbeforeunload(function(l){if(e.length){var f=e.data();f.display&&f.chkid&&(l["autocomplete_data_"+e[0].id]={display:f.display,chkid:f.chkid})}}))}})();
(function(a){window.init_general_heading_icons=function(c,h){h=h||a("#generalheading_IconNameFull");h.autocomplete({focus:function(b,g){return!1},source:create_caching_source_fn(a,c),minLength:3}).keypress(function(b){"13"==b.keyCode&&(b.preventDefault(),h.autocomplete("close"))});h.data("autocomplete")._renderItem=function(b,g){return a("<li></li>").data("item.autocomplete",g).append(a("<a></a>").text(g.label+" ").append(a(" <span></span>").addClass(g.label+" "+g.class_extra))).appendTo(b)}}})(jQuery);
(function(a){var c=function(b){var g=a("#generalheading_TaxonomyName");g.prop("checked")&&!g.prop("disabled")?a(".name-row").hide(b):a(".name-row").show(b)},h=function(b){b=a(b);b.find(".remove-link").before('<a class="SimulateLink edit-link"><img src="/images/edit.gif"></a> ');return b};window.init_gh_tax_edit=function(b,g){init_cached_state();cache_register_onbeforeunload(function(f){f.tax_selection=a("#tax-selection").html()});cache_register_onbeforerestorevalues(function(f){(f=f.tax_selection)&&
a("#tax-selection").html(f)});restore_cached_state();c();a("#generalheading_TaxonomyName").click(function(){c("slow")});a(document).on("click","a.remove-link",function(){var f=a(this).parents("li").first(),k=f.parent(),d=k.parent(),m=d.data("match");f.remove();0===k.children().length?(k.remove(),d.text(g)):k.children().each(function(q){var u=m+"-"+q+".Code-";a(this).find("input").prop("name",function(v){return u+v})});p()});var p=function(){if(!e){var f=a("#tax-selection"),k=f.find(".MustMatchTermList li").length;
f=f.find(".MatchAnyTermList li").length;k=1<f||k&&f;a("#generalheading_TaxonomyName").prop("disabled",k);c()}},t=a("#searchFrame"),r=a(window).resize(function(){n.dialog("option",{width:r.width()-30,height:r.height()-30});n.dialog("option","position","center");t.prop("height",n.height())}),n=a("#tax-selection-dialog").dialog({autoOpen:!1,resizable:!1,draggable:!1,modal:!0,open:function(){n.dialog("option",{width:r.width()-30,height:r.height()-30});n.dialog("option","position","center");t.prop("height",
n.height())},close:function(){a("html").css("overflow","");a("#dialog-selected-target").empty();e&&(a("#tax-selection").append(e),e=null);p()}}),e=null;a("#modify-term-selection").click(function(){e=a("#tax-selection").contents().remove();t.prop("src",b);a("#dialog-selected-target").empty().append(h(e.clone()));a("html").css("overflow","hidden");n.dialog("open")});var l=function(f,k){return f.code<k.code?-1:f.code>k.code?1:0};window.addBuildTerm=function(f,k){var d=a("#BuildTermList"),m=a("#BuildTermText"),
q=d.data("existingTerms")||[];if(!q.length)m=a('<span id="BuildTermText">'),d.empty().append(m).append(a('<a id="clear-build-term-list" class="SimulateLink"><img src="/images/x.gif"></a>')),a("#SelectDiv,#SuggestDiv").show();else if(0<=a.inArray(f,a.map(q,function(u){return u.code})))return;q.push({code:f,term:k});q.sort(l);d.data("existingTerms",q);m.text(a.map(q,function(u){return u.term}).join(" ~ ")+" ")};n.on("click","#clear-build-term-list",function(){a("#BuildTermList").data("existingTerms",
[]).empty().text(g);a("#SelectDiv,#SuggestDiv").hide()}).on("click",".edit-link",function(){var f=a(this).parent(),k=a.trim(f.text()),d=k.split(" ~ ");f=f.find("input").map(function(){return this.value});var m=[],q;for(q=0;q<f.length;q++)m.push({code:f[q],term:d[q]});a("#BuildTermList").data("existingTerms",m).empty().append(a('<span id="BuildTermText">').text(k+" ")).append(a('<a id="clear-build-term-list" class="SimulateLink"><img src="/images/x.gif"></a>'));a("#SelectDiv,#SuggestDiv").show()});
a("#add-match-all,#add-match-any").click(function(){var f=a("#BuildTermList"),k=a(this).data("target"),d=n.find("."+k+"TermList"),m=d.children("ul"),q=m.length?m.children().length:0,u=a('<li class="TermItem">').html(a("#BuildTermText").html()).append(a('<a class="SimulateLink remove-link"><img src="/images/x.gif"></a>')),v='<input type="hidden" name="'+k+"-"+q+".Code-";h(u);m.length||(m=a("<ul>"),d.empty().append(m));a.each(f.data("existingTerms"),function(w,x){u.append(a(v+w+'" value="'+x.code+'">"'))});
m.append(u);a("#clear-build-term-list").trigger("click")});a("#suggest-link,#suggest-term").click(function(){var f=a("#BuildTermList"),k=a(this).data("st"),d=f.data("existingTerms");f=a.map(d,function(m){return m.term}).join(" ~ ");d=a.map(d,function(m){return m.code}).join(",");k={ST:k,TC:d,TCD:f};a("#searchFrame").prop("src",b+"&"+a.param(k))});a("#save-tax-form").click(function(){a("#tax-selection").append(a("#dialog-selected-target").contents().find(".edit-link").remove().end());e=null;n.dialog("close")});
a("#reset-tax-form").click(function(){a("#dialog-selected-target").empty().append(h(e.clone()))});a("#cancel-tax-form").click(function(){n.dialog("close")});a("#clear-tax-form").click(function(){a("#dialog-selected-target").find(".MustMatchTermList,.MatchAnyTermList").empty().text(g);a("#generalheading_TaxonomyRestrict").prop("checked",!1)})}})(jQuery);
